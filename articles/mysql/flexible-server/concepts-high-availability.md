---
title: Azure Database for MySQL 유연한 서버를 사용 하는 영역 중복 HA
description: Azure Database for MySQL 유연한 서버에서 영역 중복 고가용성에 대 한 개념적인 개요를 확인 하세요.
author: SudheeshGH
ms.author: sunaray
ms.service: mysql
ms.topic: conceptual
ms.date: 08/26/2021
ms.openlocfilehash: 1d1ec1b6196dd543b9310a945fc9b07e26673c84
ms.sourcegitcommit: 702df701fff4ec6cc39134aa607d023c766adec3
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/03/2021
ms.locfileid: "131472773"
---
# <a name="high-availability-concepts-in-azure-database-for-mysql-flexible-server"></a>유연한 서버 Azure Database for MySQL의 고가용성 개념

[!INCLUDE[applies-to-mysql-flexible-server](../includes/applies-to-mysql-flexible-server.md)]

유연한 서버 Azure Database for MySQL 자동 장애 조치를 사용 하 여 고가용성을 구성할 수 있습니다. 고가용성 솔루션은 커밋된 데이터가 오류로 인해 손실되지 않고 데이터베이스가 소프트웨어 아키텍처에서 단일 오류 지점이 되지 않도록 설계되었습니다. 고가용성이 구성되면 유연한 서버가 대기 복제본을 자동으로 프로비저닝하고 관리합니다. 다음 두 가지의 고가용성 아키텍처 모델이 있습니다.

* **영역 중복 HA**. 이 옵션은 여러 가용성 영역에서 인프라의 완전 한 격리 및 중복성을 위해 선호 됩니다. 가장 높은 수준의 가용성을 제공 하지만 영역 간에 응용 프로그램 중복성을 구성 해야 합니다. 가용성 영역에서 인프라 오류에 대 한 최고 수준의 가용성을 확보 하 고 가용성 영역 간 대기 시간이 허용 되는 경우 영역 중복 HA를 사용 하는 것이 좋습니다. 서버를 만들 때만 사용할 수 있습니다. 영역 중복 HA는 지역에서 다중 [가용성 영역](../../availability-zones/az-overview.md) 을 지원 하 고 [영역 중복 Premium 파일 공유](../..//storage/common/storage-redundancy.md#zone-redundant-storage) 를 사용할 수 있는 [Azure 지역의 하위 집합](./overview.md#azure-regions) 에서 사용할 수 있습니다.

* **동일한 영역 HA**. 주 및 대기 서버가 동일한 가용성 영역에 있기 때문에 네트워크 대기 시간이 더 낮은 인프라 중복성에이 옵션을 사용 하는 것이 좋습니다. 영역 간에 응용 프로그램 중복성을 구성할 필요 없이 고가용성을 제공 합니다. 네트워크 대기 시간이 가장 낮은 단일 가용성 영역 내에서 가장 높은 수준의 가용성을 확보 하려는 경우에도 동일한 영역 HA를 사용 하는 것이 좋습니다. Azure Database for MySQL 유연한 서버를 사용할 수 있는 모든 [Azure 지역](./overview.md#azure-regions) 에서 동일한 영역 HA를 사용할 수 있습니다.  

## <a name="zone-redundant-ha-architecture"></a>영역 중복 HA 아키텍처
 
영역 중복 HA를 사용 하 여 서버를 배포 하면 다음과 같은 두 개의 서버가 생성 됩니다. 
- 하나의 가용성 영역에 있는 주 서버
- 동일한 Azure 지역의 다른 가용성 영역에서 주 서버 (compute 계층, 계산 크기, 저장소 크기 및 네트워크 구성)와 동일한 구성이 있는 대기 복제본 서버
 
주 복제본과 대기 복제본에 대 한 가용성 영역을 선택할 수 있습니다. 대기 데이터베이스 서버와 대기 응용 프로그램을 동일한 영역에 배치 하면 대기 시간이 줄어듭니다. 또한 재해 복구 상황 및 "영역 중단" 시나리오에 대 한 준비를 더 잘 수행할 수 있습니다.

:::image type="content" source="./media/concepts-high-availability/1-flexible-server-overview-zone-redundant-ha.png" alt-text="영역 중복 고가용성의 아키텍처를 보여 주는 다이어그램입니다.":::

데이터 및 로그 파일은 [ZRS (영역 중복 저장소)](../../storage/common/storage-redundancy.md#redundancy-in-the-primary-region)에서 호스팅됩니다. 이러한 파일은 ZRS에서 사용할 수 있는 저장소 수준 복제를 통해 대기 서버에 복제 됩니다. 장애 조치 (failover)가 있는 경우: 
- 대기 복제본이 활성화 됩니다. 
- 주 서버의 이진 로그 파일은 대기 서버에 계속 적용 되어 주 서버에서 마지막으로 커밋된 트랜잭션으로 온라인 상태로 전환 합니다. 

주 서버를 사용할 수 없는 경우에도 ZRS의 로그에 액세스할 수 있습니다. 이 가용성은 데이터가 손실 되지 않도록 하는 데 도움이 됩니다. 대기 복제본이 활성화 되 고 이진 로그가 적용 된 후에는 현재 대기 복제본 서버에서 주 서버의 역할을 수행 합니다. 클라이언트를 다시 연결할 때 클라이언트 연결이 새 주 복제본으로 전달 되도록 DNS가 업데이트 됩니다. 장애 조치 (failover)는 클라이언트 응용 프로그램에서 완전히 투명 하며 사용자의 조치가 필요 하지 않습니다. 그런 다음 HA 솔루션은 가능 하면 이전 주 서버를 다시 가져와서 대기로 전환 합니다.
 
데이터베이스 서버 이름은 응용 프로그램을 주 서버에 연결 하는 데 사용 됩니다. 대기 복제본 정보는 직접 액세스를 위해 노출 되지 않습니다. 커밋 및 쓰기는 주 서버의 ZRS 로그 파일이 플러시된 후에 승인 됩니다. ZRS 저장소에서 사용 되는 동기화 복제 기술로 인해 응용 프로그램 쓰기 및 커밋에 대해 5-10%의 대기 시간이 증가할 수 있습니다.
 
스냅숏 및 로그 백업 모두 자동 백업은 주 데이터베이스 서버에서 영역 중복 저장소에 대해 수행 됩니다.

## <a name="same-zone-ha-architecture"></a>동일한 영역 HA 아키텍처
 
동일한 영역 HA를 사용 하는 서버를 배포 하는 경우 두 서버는 동일한 영역에 생성 됩니다. 
- 주 서버
- 주 서버와 동일한 구성 (계산 계층, 계산 크기, 저장소 크기 및 네트워크 구성)을 가진 대기 복제본 서버 

대기 서버는 별도의 가상 머신 (계산)를 사용 하 여 인프라 중복성을 제공 합니다. 이러한 중복성은 공동 배치로 인해 응용 프로그램과 데이터베이스 서버 간의 장애 조치 (failover) 시간 및 네트워크 대기 시간을 줄입니다.

:::image type="content" source="./media/concepts-high-availability/flexible-server-overview-same-zone-ha.png" alt-text="동일한 영역 고가용성의 아키텍처를 보여 주는 다이어그램입니다.":::

데이터 및 로그 파일은 [LRS (로컬 중복 저장소)](../../storage/common/storage-redundancy.md#locally-redundant-storage)에서 호스팅됩니다. 이러한 파일은 LRS에서 사용할 수 있는 저장소 수준 복제를 통해 대기 서버에 복제 됩니다.

장애 조치 (failover)가 있는 경우: 
- 대기 복제본이 활성화 됩니다. 
- 주 서버의 이진 로그 파일은 대기 서버에 계속 적용 되어 주 서버에서 마지막으로 커밋된 트랜잭션으로 온라인 상태로 전환 합니다. 

주 서버를 사용할 수 없는 경우에도 LRS의 로그에 액세스할 수 있습니다. 이 가용성은 데이터가 손실 되지 않도록 하는 데 도움이 됩니다. 대기 복제본이 활성화 되 고 이진 로그가 적용 된 후에는 현재 대기 복제본이 주 서버의 역할을 수행 합니다. 클라이언트가 다시 연결 될 때 새 주 복제본에 대 한 연결을 리디렉션하도록 DNS가 업데이트 됩니다. 장애 조치 (failover)는 클라이언트 응용 프로그램에서 완전히 투명 하며 사용자의 조치가 필요 하지 않습니다. 그런 다음 HA 솔루션은 가능 하면 이전 주 서버를 다시 가져와서 대기로 전환 합니다.
 
데이터베이스 서버 이름은 응용 프로그램을 주 서버에 연결 하는 데 사용 됩니다. 대기 복제본 정보는 직접 액세스를 위해 노출 되지 않습니다. 커밋 및 쓰기는 주 서버의 LRS 로그 파일이 플러시된 후에 승인 됩니다. 주 복제본과 대기 복제본이 동일한 영역에 있기 때문에 응용 프로그램 서버와 데이터베이스 서버 간의 복제 지연 및 대기 시간이 줄어듭니다. 특정 가용성 영역에서 종속 인프라가 다운 된 경우 동일한 영역 설치 프로그램에서 고가용성을 제공 하지 않습니다. 모든 종속 서비스가 해당 가용성 영역에 대해 다시 온라인 상태가 될 때까지 가동 중지 시간이 발생 합니다.
 
스냅숏 및 로그 백업 모두 자동 백업은 주 데이터베이스 서버에서 로컬 중복 저장소에 대해 수행 됩니다.

>[!Note]
>영역 중복 및 동일한 영역 HA의 경우:
>* 오류가 발생 하는 경우 대기 복제본이 주 역할을 수행 하는 데 필요한 시간은 대기 상태의 이진 로그 응용 프로그램에 따라 달라 집니다. 따라서 장애 조치 시간을 줄이기 위해 모든 테이블에 기본 키를 사용 하는 것이 좋습니다. 장애 조치 (Failover) 시간은 일반적으로 60 초에서 120 초 사이입니다. 
>* 대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없습니다. 빠른 장애 조치 (failover)를 사용 하도록 설정 하는 수동 대기 상태입니다.
>* 항상 FQDN (정규화 된 도메인 이름)을 사용 하 여 주 서버에 연결 합니다. 연결 하려면 IP 주소를 사용 하지 마십시오. 장애 조치 (failover)가 있는 경우 주 및 대기 서버 역할이 전환 된 후 DNS A 레코드가 변경 될 수 있습니다. 이렇게 변경 하면 연결 문자열에서 IP 주소를 사용 하는 경우 응용 프로그램에서 새 주 서버에 연결할 수 없습니다.

## <a name="failover-process"></a>장애 조치(failover) 프로세스 
 
### <a name="planned-forced-failover"></a>계획 됨: 강제 장애 조치 (failover)
 
Azure Database for MySQL-유연한 서버 강제 장애 조치 (failover)를 통해 수동으로 장애 조치 (failover)를 수행할 수 있습니다. 이 기능을 사용 하면 응용 프로그램 시나리오에서 기능을 테스트 하 고 중단을 방지할 수 있습니다. 

강제 장애 조치 (failover)는 DNS 레코드를 업데이트 하 여 동일한 데이터베이스 서버 이름을 가진 주 서버가 되도록 대기 복제본을 활성화 하는 장애 조치 (failover)를 트리거합니다. 원래 주 서버가 다시 시작 되 고 대기 복제본으로 전환 됩니다. 클라이언트 연결의 연결이 끊어지고 작업을 다시 시작 하려면 다시 연결 해야 합니다. 

전체 장애 조치 (failover) 시간은 현재 작업 및 마지막 검사점에 따라 다릅니다. 일반적으로 60 ~ 120 초 사이에 소요 될 것으로 예상 됩니다.
 
### <a name="unplanned-automatic-failover"></a>계획 되지 않음: 자동 장애 조치 
 
계획 되지 않은 서비스 가동 중지 시간은 소프트웨어 버그 또는 계산, 네트워크, 저장소 오류와 같은 인프라 오류 또는 데이터베이스의 가용성에 영향을 미치는 정전으로 인해 발생할 수 있습니다. 데이터베이스를 사용할 수 없게 되 면 대기 복제본으로의 복제가 중단 되 고 대기 복제본이 주 데이터베이스로 활성화 됩니다. DNS가 업데이트 되 고 클라이언트가 데이터베이스 서버에 다시 연결 하 여 작업을 다시 시작 합니다. 

전반적인 장애 조치 (failover) 시간은 60 초에서 120 초 사이 여야 합니다. 그러나 장애 조치 (failover) 시 주 데이터베이스 서버의 활동 (예: 큰 트랜잭션 및 복구 시간)에 따라 장애 조치 (failover)가 더 오래 걸릴 수 있습니다.

## <a name="monitoring-for-high-availability"></a>고가용성에 대 한 모니터링
HA의 상태는 개요 페이지에서 지속적으로 모니터링 되 고 보고 됩니다. 복제 상태는 다음과 같습니다.

| **Status** | **설명** |
| :----- | :------ |
| **NotEnabled** | 영역 중복 HA를 사용 하도록 설정 하지 않았습니다. |
| **ReplicatingData** | 대기는 생성된 후 주 서버를 따라가고 있습니다. |
| **FailingOver** | 데이터베이스 서버가 주 서버에서 대기 서버로 장애 조치(failover)를 진행하는 중입니다. |
| **건강** | 영역 중복 HA는 안정적인 상태이며 정상입니다. |
| **RemovingStandby** | 사용자가 대기 복제본을 삭제했으며 삭제가 진행 중입니다.| 

##  <a name="limitations"></a>제한 사항 
 
고가용성을 사용할 때 유의해야 할 몇 가지 고려 사항은 다음과 같습니다.
* 영역 중복 고가용성 은 유연한 서버를 만들 때만 설정할 수 있습니다.
* 버스트 가능한 컴퓨팅 계층에서는 고가용성이 지원되지 않습니다.
* 고정적인 매개 변수 변경 내용을 선택하기 위해 주 데이터베이스 서버를 다시 시작하면 대기 복제본도 다시 시작됩니다.
* 읽기 복제본은 HA 서버에 대해 지원되지 않습니다.
* 입력 데이터 복제 HA 서버에는 지원되지 않습니다.
* HA 솔루션에서 GTID를 사용하므로 GTID 모드가 설정됩니다. 워크로드에 [GTID를](https://dev.mysql.com/doc/refman/5.7/en/replication-gtids-restrictions.html)이용한 복제에 대한 제한 사항 또는 제한이 있는지 확인합니다.  
 
## <a name="frequently-asked-questions-faq"></a>질문과 대답(FAQ)
 
**읽기 또는 쓰기 작업에 대기 복제본을 사용할 수 있나요?** </br>
대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없습니다. 빠른 장애 조치(failover)를 사용하도록 설정하는 수동 대기입니다.</br>
**장애 조치(failover)가 발생하면 데이터가 손실됩니까?**</br>
주 서버를 사용할 수 없는 경우에도 ZRS의 로그에 액세스할 수 있습니다. 이 가용성은 데이터 손실이 없도록 하는 데 도움이 됩니다. 대기 복제본이 활성화되고 이진 로그가 적용된 후 주 서버의 역할을 맡습니다. </br>
**장애 조치(failover) 후 작업을 수행해야 합니까?**</br>
장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명합니다. 아무 작업도 수행할 필요가 없습니다. 애플리케이션은 연결에 재시도 논리만 사용해야 합니다. </br>
**대기 복제본에 대한 특정 영역을 선택하지 않으면 어떻게 되나요? 나중에 영역을 변경할 수 있나요?**</br>
영역을 선택하지 않으면 영역이 임의로 선택됩니다. 주 서버에는 사용되지 않습니다. 나중에 영역을 변경하려면 **고가용성** 창에서 **고가용성을** **사용** 안 함으로 설정한 다음 다시 **영역 중복으로** 설정하고 영역을 선택합니다.</br>
**주 복제본과 대기 복제본 간의 복제가 동기적인가요?**</br>
 주 모드와 대기 모드 간의 복제는 MySQL의 [반동기 모드와](https://dev.mysql.com/doc/refman/5.7/en/replication-semisync.html) 비슷합니다. 트랜잭션이 커밋되면 반드시 대기에 커밋되지는 않습니다. 그러나 주 를 사용할 수 없는 경우 대기는 주 에서 모든 데이터 변경 내용을 복제하여 데이터 손실이 없도록 합니다.</br> 
**계획되지 않은 모든 오류에 대해 대기 복제본에 대한 장애 조치(failover)가 있나요?**</br>
데이터베이스 크래시 또는 노드 오류가 있는 경우 유연한 서버 VM이 동일한 노드에서 다시 시작됩니다. 동시에 자동 장애 조치(failover)가 트리거됩니다. 장애 조치(failover)가 완료되기 전에 유연한 서버 VM 다시 시작이 성공하면 장애 조치(failover) 작업이 취소됩니다. 주 복제본으로 사용할 서버의 결정은 먼저 완료되는 프로세스에 따라 달라집니다.</br>
**HA를 사용할 때 성능에 영향을 주나요?**</br>
영역 중복 HA의 경우 애플리케이션이 네트워크 대기 시간이 비교적 높은 가용성 영역에서 데이터베이스 서버에 연결하는 경우 대기 시간이 5-10% 감소할 수 있습니다(2-4ms). 동일한 영역 HA의 경우 주 복제본과 대기 복제본이 동일한 영역에 있기 때문에 복제 지연 시간이 더 낮습니다. 동일한 Azure 가용성 영역에 있는 경우 애플리케이션 서버와 데이터베이스 서버 간의 대기 시간이 줄어듭니다.</br>
**HA 서버의 유지 관리는 어떻게 됩니까?**</br>
컴퓨팅 및 부 버전 업그레이드의 크기 조정과 같은 계획된 이벤트는 주 버전과 대기에서 동시에 발생합니다. 유연한 서버와 마찬가지로 HA 서버에 대해 [예약된 유지 관리 기간을](./concepts-maintenance.md) 설정할 수 있습니다. 가동 중지 시간은 HA를 사용하지 않도록 설정했을 때 Azure Database for MySQL 유연한 서버의 가동 중지 시간과 동일합니다. 장애 조치(failover) 메커니즘을 사용하여 HA 서버의 가동 중지 시간을 줄이는 것은 로드맵에 있으며 곧 제공될 예정입니다. </br>
**HA 서버의 PITR(Point-In-Time Restore)을 수행할 수 있나요?**</br>
HA를 사용하지 않도록 설정된 새로운 Azure Database for MySQL 유연한 서버에 HA 지원 Azure Database for MySQL 유연한 서버에 대한 [PITR을](./concepts-backup-restore.md#point-in-time-restore) 수행할 수 있습니다. 원본 서버가 영역 중복 HA를 사용하여 만들어진 경우 나중에 복원된 서버에서 영역 중복 HA 또는 동일한 영역 HA를 사용하도록 설정할 수 있습니다. 원본 서버가 동일한 영역 HA를 사용하여 만들어진 경우 복원된 서버에서 동일한 영역 HA만 사용하도록 설정할 수 있습니다.</br>
**서버를 만든 후 서버에서 HA를 사용하도록 설정할 수 있나요?**</br>
서버를 만들 때 영역 중복 HA를 사용하도록 설정해야 합니다. 서버를 만든 후 동일한 영역 HA를 사용하도록 설정할 수 있습니다. 동일한 영역 HA를 사용하도록 설정하기 전에 서버 매개 변수가 enforce_gtid_consistency" 및 ["gtid_mode"가](./concepts-read-replicas.md#global-transaction-identifier-gtid)  ON으로 설정되어 있는지 확인합니다.</br> 
**서버를 만든 후 서버에 대해 HA를 사용하지 않도록 설정할 수 있나요?** </br>
서버를 만든 후 서버에서 HA를 사용하지 않도록 설정할 수 있습니다. 청구가 즉시 중지됩니다.  </br>
**가동 중지 시간을 완화할 수 있는 방법은 무엇인가요?**</br>
HA를 사용하지 않는 경우에도 애플리케이션의 가동 중지 시간을 완화할 수 있어야 합니다. 예약된 패치, 부 버전 업그레이드 또는 고객이 시작한 작업(예: 컴퓨팅 크기 조정)은 예약된 유지 관리 기간 동안 서비스 가동 중지 시간을 수행할 수 있습니다. Azure 시작 유지 관리 작업에 대한 애플리케이션 영향을 완화하기 위해 애플리케이션에 미치는 영향을 최소화하는 요일 및 시간에 예약할 수 있습니다.</br>
**HA 사용 서버에 읽기 복제본을 사용할 수 있나요?**</br>
읽기 복제본은 HA 서버에 대해 지원되지 않습니다. 이 기능은 로드맵에 있으며 곧 사용할 수 있도록 노력하고 있습니다.</br>
**HA 서버에 입력 데이터 복제 사용할 수 있나요?**</br>
입력 데이터 복제 HA 서버에는 지원되지 않습니다. 그러나 HA 서버에 대한 입력 데이터 복제 로드맵에 있으며 곧 제공될 예정입니다. 지금은 마이그레이션에 입력 데이터 복제 사용하려는 경우 다음 단계를 수행할 수 있습니다.
1. 영역 중복 HA를 사용하도록 설정된 서버를 만듭니다.
1. HA를 사용하지 않도록 설정합니다.
1. [입력 데이터 복제 설정하는](./concepts-data-in-replication.md)단계를 완료합니다.  `gtid_mode`(원본 및 대상 서버에서 동일한 설정이 있어야 합니다.)
1. 사후 전환은 입력 데이터 복제 구성을 제거합니다.
1. HA를 사용하도록 설정합니다.

**가동 중지 시간을 줄이기 위해 서버를 다시 시작하는 동안 또는 확장 또는 축소하는 동안 대기 서버로 장애 조치할 수 있나요?** </br>
현재 강화 또는 규모 축소 작업을 수행할 때 대기 및 기본은 동시에 크기가 조정됩니다. 따라서 장애조정은 도움이 되지 않습니다. 먼저 대기를 확장한 다음 장애 조치(failover)를 허용한 다음, 주 백업을 확장하는 것은 로드맵에 있지만 아직 지원되지 않습니다.</br>

**서버의 가용성 모드(영역 중복 HA/동일 영역)를 변경할 수 있나요?** </br>
영역 중복 HA 모드를 사용하도록 설정된 서버를 만드는 경우 영역 중복 HA에서 동일한 영역으로 또는 그 반대로 변경할 수 있습니다. 가용성 모드를 변경하려면 **고가용성** 창에서 **고가용성을** **사용** 안 함으로 설정한 다음, **다시 영역 중복 또는 동일한 영역으로** 설정하고 **고가용성 모드를** 선택합니다.</br>  

## <a name="next-steps"></a>다음 단계

- 비즈니스 [연속성에](./concepts-business-continuity.md)대해 알아봅니다.
- 영역 [중복 고가용성](./concepts-high-availability.md)에 대해 알아봅니다.
- 백업 [및 복구에](./concepts-backup-restore.md)대해 알아봅니다.
