---
title: Azure Sentinel에서 변칙 검색 분석 규칙 사용 | Microsoft Docs
description: 이 문서에서는 Azure Sentinel에서 변칙 검색 분석 규칙을 보고, 만들며, 관리 및 평가하고, 미세 조정하는 방법을 설명합니다.
services: sentinel
cloud: na
documentationcenter: na
author: yelevin
manager: rkarlin
ms.assetid: ''
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: how-to
ms.date: 04/28/2021
ms.author: yelevin
ms.openlocfilehash: 43af18f508a0e9b4239dedb793a3de9565ee5f03
ms.sourcegitcommit: 0046757af1da267fc2f0e88617c633524883795f
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/13/2021
ms.locfileid: "122529193"
---
# <a name="work-with-anomaly-detection-analytics-rules-in-azure-sentinel"></a>Azure Sentinel에서 변칙 검색 분석 규칙 사용

> [!IMPORTANT]
>
> - 변칙 규칙은 현재 **미리 보기** 로 제공됩니다. 베타 또는 미리 보기로 제공되거나 아직 일반 공급으로 릴리스되지 않은 Azure 기능에 적용되는 추가 약관은 [Microsoft Azure 미리 보기에 대한 추가 사용 약관](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)을 참조하세요.

## <a name="view-soc-ml-anomaly-rule-templates"></a>SOC-ML 변칙 규칙 템플릿 보기

Azure Sentinel의 [SOC-ML 변칙 기능](soc-ml-anomalies.md)에서는 즉시 사용 가능한 [기본 제공 변칙 템플릿](detect-threats-built-in.md#anomaly)을 제공합니다. 이러한 변칙 템플릿은 수천 개의 데이터 원본과 수백만 개의 이벤트를 사용해 강력하게 개발되었지만, 이 기능을 이용하면 사용자 인터페이스 내에서 변칙 임계값과 매개 변수를 쉽게 변경할 수 있습니다. 변칙 규칙은 변칙을 생성하기 전에 활성화해야 합니다. 이러한 규칙은 **로그** 섹션의 **변칙** 테이블에서 찾을 수 있습니다.

1. Azure Sentinel 탐색 메뉴에서 **Analytics** 를 선택합니다.

1. **분석** 블레이드에서 **규칙 템플릿** 탭을 선택합니다.

1. **변칙** 템플릿 목록을 필터링합니다.

    1. **규칙 유형** 필터를 클릭한 다음 아래에 표시되는 드롭다운 목록을 클릭합니다.

    1. **모두 선택** 을 표시 해제한 다음 **변칙** 을 표시합니다.

    1. 필요한 경우 드롭다운 목록의 맨 위를 클릭하여 취소한 다음 **확인** 을 클릭합니다.

## <a name="activate-anomaly-rules"></a>변칙 규칙 활성화

규칙 템플릿 중 하나를 클릭하면 세부 정보 창에 **규칙 만들기** 단추와 함께 다음 정보가 표시됩니다.

- **설명** 은 변칙의 작동 방식과 필요한 데이터를 설명합니다.

- **데이터 원본** 은 분석하려면 수집해야 하는 로그 유형을 나타냅니다.

- **전술** 은 변칙에서 다루는 MITRE ATT&CK 프레임워크 전략입니다.

- **매개 변수** 는 변칙에 구성 가능한 특성입니다.

- **임계값** 은 변칙을 만들기 전에 이벤트가 비정상이어야 하는 정도를 나타내는 구성 가능한 값입니다.

- **규칙 빈도** 는 변칙을 찾는 로그 처리 작업 간의 시간입니다.

- **변칙 버전** 은 규칙에서 사용하는 템플릿의 버전을 보여 줍니다. 이미 활성화된 규칙에서 사용하는 버전을 변경하려면 규칙을 다시 만들어야 합니다.

- **템플릿 마지막 업데이트 날짜** 는 변칙 버전이 변경된 날짜입니다.

규칙을 활성화하려면 다음 단계를 완료합니다.

1. 아직 **사용 중** 레이블이 지정되지 않은 규칙 템플릿을 선택합니다. **규칙 만들기** 단추를 클릭하여 규칙 만들기 마법사를 엽니다.

    각 규칙 템플릿 마법사는 약간 다르지만 **일반**, **구성**, **검토 및 만들기** 의 세 가지 단계 또는 탭이 있습니다.

    마법사 값은 변경할 수 없습니다. 먼저 규칙을 만들고 활성화해야 합니다.

1. 탭을 순환한 후 **검토 및 만들기** 탭에서 "유효성 검사 통과" 메시지를 기다렸다가 **만들기** 단추를 선택합니다.

    각 템플릿에서는 활성 규칙을 하나만 만들 수 있습니다. 마법사를 완료하면 **활성 규칙** 탭에 활성 변칙 규칙이 만들어지고, 템플릿(**규칙 템플릿** 탭)이 **사용 중** 인 상태로 표시됩니다.

    > [!NOTE]
    > 필요한 데이터를 사용할 수 있다고 가정하면, 새 규칙이 **활성 규칙** 탭에 표시되는 데 최대 24시간이 걸릴 수 있습니다. 새 규칙을 보려면 활성 규칙 탭을 선택하고 위의 규칙 템플릿 목록을 필터링한 것과 같은 방식으로 필터링합니다.

변칙 규칙이 활성화되면 검색된 변칙이 Azure Sentinel 작업 영역의 **로그** 섹션에 있는 **변칙** 테이블에 저장됩니다.

각 변칙 규칙에는 학습 기간이 있으며, 해당 학습 기간이 종료될 때까지 변칙은 테이블에 표시되지 않습니다. 각 변칙 규칙의 설명에서 학습 기간을 찾을 수 있습니다.

## <a name="assess-the-quality-of-anomalies"></a>변칙 품질 평가

최근 24시간 동안 규칙에 따라 만들어진 변칙 샘플을 검토하여 변칙 규칙이 얼마나 잘 수행되는지 확인할 수 있습니다. 

1. Azure Sentinel 탐색 메뉴에서 **Analytics** 를 선택합니다.

1. **분석** 블레이드에서 **활성 규칙** 탭이 선택되어 있는지 확인합니다.

1. **변칙** 규칙 목록을 필터링합니다(위와 같음).

1. 평가할 규칙을 선택하고 세부 정보 창 맨 위의 이름을 오른쪽으로 복사합니다.

1. Azure Sentinel 탐색 메뉴에서 **로그** 를 선택합니다.

1. 맨 위에 **쿼리** 갤러리가 표시되면 닫습니다.

1. **로그** 블레이드의 왼쪽 창에서 **테이블** 탭을 선택합니다.

1. **시간 범위** 필터를 **지난 24시간** 으로 설정합니다.

1. 아래의 Kusto 쿼리를 복사하여 쿼리 창("여기에 쿼리를 입력하거나..."라고 표시됨)에 붙여넣습니다.

    ```kusto
    Anomalies 
    | where AnomalyTemplateName contains "________________________________"
    ```
    따옴표 사이에 밑줄 대신 위에서 복사한 규칙 이름을 붙여넣습니다.

1. **실행** 을 클릭합니다. 

결과가 몇 가지 있으면 변칙의 품질 평가를 시작할 수 있습니다. 결과가 없으면 시간 범위를 늘려 보세요.

각 변칙 결과를 확장한 다음 **AnomalyReasons** 필드를 확장합니다. 이렇게 하면 변칙이 발생한 이유를 알 수 있습니다.

변칙의 "타당성" 또는 "유용성"은 사용자 환경의 조건에 따라 달라질 수 있지만, 변칙 규칙이 변칙을 너무 많이 생성하는 일반적인 이유는 임계값이 너무 낮을 수 있기 때문입니다.

## <a name="tune-anomaly-rules"></a>변칙 규칙 조정

변칙 규칙은 기본적으로 효율성을 극대화하도록 설계되었지만, 모든 상황은 고유하며 경우에 따라서는 변칙 규칙을 조정해야 합니다.

원래 활성 규칙을 편집할 수 없기 때문에 먼저 활성 변칙 규칙을 복제한 후 복사본을 사용자 지정해야 합니다.

원래 변칙 규칙은 사용하지 않도록 설정하거나 삭제할 때까지 계속 실행됩니다.

이는 원래 구성과 새 구성에서 생성된 결과를 비교할 수 있는 기회를 제공하기 위해 의도된 것입니다. 기본적으로 중복된 규칙은 사용하지 않도록 설정됩니다. 지정된 변칙 규칙의 사용자 지정 복사본은 하나만 만들 수 있습니다. 두 번째 복사본을 만들려는 시도는 실패합니다.

1. 변칙 규칙의 구성을 변경하려면 **활성 규칙** 탭에서 변칙 규칙을 선택합니다.

1. 규칙 행의 아무 곳이나 마우스 오른쪽 단추로 클릭하거나 행 끝에 있는 줄임표(...)를 마우스 왼쪽 단추로 클릭한 다음 **복제** 를 클릭합니다.

1. 규칙의 새 복사본은 규칙 이름에 "- Customized" 접미사가 붙습니다. 실제로 이 규칙을 사용자 지정하려면 이 규칙을 선택하고 **편집** 을 클릭합니다.

1. 규칙이 분석 규칙 마법사에서 열립니다. 여기에서 규칙의 매개 변수와 해당 임계값을 변경할 수 있습니다. 변경할 수 있는 매개 변수는 각 변칙 유형과 알고리즘에 따라 달라집니다.

    **결과 미리 보기 창** 에서 변경 내용의 결과를 미리 볼 수 있습니다. 결과 미리 보기에서 **변칙 ID** 를 클릭하여 ML 모델이 해당 변칙을 식별하는 이유를 확인합니다.

1. 사용자 지정된 규칙을 사용하여 결과를 생성합니다. 일부 내용을 변경하려면 규칙을 다시 실행해야 할 수 있으므로, 완료될 때까지 기다렸다가 다시 돌아와 로그 페이지에서 결과를 확인해야 합니다. 사용자 지정된 변칙 규칙은 기본적으로 **플라이팅**(테스트) 모드에서 실행됩니다. 원래 규칙은 기본적으로 **프로덕션** 모드에서 계속 실행됩니다.

1. 결과를 비교하려면 **로그** 의 변칙 테이블로 되돌아가 [이전과 같이 새 규칙을 평가](#assess-the-quality-of-anomalies)하고, 원래 규칙 이름이 있는 행과 **AnomalyTemplateName** 열에 "- Customized"가 추가된 중복 규칙 이름이 있는 행만 찾습니다.

    사용자 지정 규칙의 결과가 만족스러우면 **활성 규칙** 탭으로 되돌아가 사용자 지정 규칙을 클릭한 다음 **편집** 단추를 클릭하고, **일반** 탭에 있는 **플라이팅** 에서 **프로덕션** 으로 전환할 수 있습니다. 동일한 규칙의 두 가지 버전을 동시에 프로덕션에서 사용할 수 없으므로 원래 규칙이 **플라이팅** 으로 자동 변경됩니다. 

## <a name="next-steps"></a>다음 단계

이 문서에서는 Azure Sentinel에서 SOC-ML 변칙 검색 분석 규칙을 사용하는 방법을 알아보았습니다.

- [SOC-ML](soc-ml-anomalies.md)에 대한 몇 가지 배경 정보를 가져옵니다.
- 다른 [분석 규칙 유형](detect-threats-built-in.md)을 탐색합니다.
