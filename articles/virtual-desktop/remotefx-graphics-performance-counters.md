---
title: 그래픽 성능 문제 진단 원격 데스크톱 - Azure
description: 이 문서에서는 원격 데스크톱 프로토콜 세션에서 RemoteFX 그래픽 카운터를 사용하여 Azure Virtual Desktop의 그래픽에서 성능 문제를 진단하는 방법을 설명합니다.
author: Heidilohr
ms.topic: troubleshooting
ms.date: 05/23/2019
ms.author: helohr
manager: femila
ms.openlocfilehash: 86d5aa82aaf51d0d2407799050f92a04a12c4a58
ms.sourcegitcommit: 8bca2d622fdce67b07746a2fb5a40c0c644100c6
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/09/2021
ms.locfileid: "111752930"
---
# <a name="diagnose-graphics-performance-issues-in-remote-desktop"></a>원격 데스크톱에서 그래픽 성능 문제 진단

원격 세션의 경험 품질 문제를 진단하기 위해 성능 모니터의 RemoteFX 그래픽 섹션에서 카운터가 제공되었습니다. 이 문서는 이러한 카운터를 사용하여 RDP(원격 데스크톱 프로토콜) 세션 중에 그래픽 관련 성능 병목 현상을 파악하고 해결하는 데 도움이 됩니다.

## <a name="find-your-remote-session-name"></a>원격 세션 이름 찾기

그래픽 성능 카운터를 식별하려면 원격 세션 이름이 필요합니다. 이 섹션의 지침에 따라 각 카운터의 인스턴스를 식별합니다.

1. 원격 세션에서 Windows 명령 프롬프트를 엽니다.
2. **qwinsta** 명령을 실행하고 세션 이름을 찾습니다.
    - 세션이 다중 세션 VM(가상 머신)에서 호스팅되는 경우 각 카운터의 인스턴스는 세션 이름에 접미사를 붙이는 동일한 숫자(예: "rdp-tcp 37")로 접미사가 붙습니다.
    - 세션이 vGPU(가상 그래픽 처리 장치)를 지원하는 VM에서 호스팅되는 경우 각 카운터의 인스턴스는 VM이 아닌 서버에 저장됩니다. 카운터 인스턴스는 세션 이름에 숫자 대신 "Win8 Enterprise VM"과 같은 VM 이름을 포함합니다.

>[!NOTE]
> 카운터의 이름에는 RemoteFX가 있지만 vGPU 시나리오에는 원격 데스크톱 그래픽도 포함됩니다.

## <a name="access-performance-counters"></a>성능 카운터에 액세스

원격 세션 이름을 확인한 후 다음 지침에 따라 원격 세션에 대한 RemoteFX 그래픽 성능 카운터를 수집합니다.

1. **시작** > **관리 도구** > **성능 모니터** 를 선택합니다.
2. **성능 모니터** 대화 상자에서 **모니터링 도구** 를 확장하고, **성능 모니터** 를 선택한 다음, **추가** 를 선택합니다.
3. **카운터 추가** 대화 상자의 **사용 가능한 카운터** 목록에서 RemoteFX 그래픽에 대한 섹션을 확장합니다.
4. 모니터링할 카운터를 선택합니다.
5. **선택한 개체의 인스턴스** 목록에서 선택한 카운터에 대해 모니터링할 특정 인스턴스를 선택한 다음, **추가** 를 선택합니다. 사용 가능한 모든 카운터 인스턴스를 선택하려면 **모든 인스턴스** 를 선택합니다.
6. 카운터를 추가한 후 **확인** 을 선택합니다.

선택한 성능 카운터가 성능 모니터 화면에 나타납니다.

>[!NOTE]
>호스트의 각 활성 세션에는 각 성능 카운터의 고유한 인스턴스가 있습니다.

## <a name="diagnose-issues"></a>문제 진단

그래픽 관련 성능 문제는 일반적으로 다음 네 가지 범주로 나뉩니다.

- 낮은 프레임 속도
- 임의 대기
- 높은 입력 대기 시간
- 낮은 프레임 품질

### <a name="addressing-low-frame-rate-random-stalls-and-high-input-latency"></a>낮은 프레임 속도, 임의 대기 및 높은 입력 대기 시간 해결

먼저 출력 프레임/초 카운터를 확인합니다. 클라이언트에서 사용할 수 있는 프레임 수를 측정합니다. 이 값이 입력 프레임/초 카운터보다 작은 경우 프레임을 건너뜁니다. 병목 상태를 식별하려면 건너뛴 프레임/초 카운터를 사용합니다.

건너뛴 프레임/초 카운터에는 다음 세 가지 유형이 있습니다.

- 건너뛴 프레임/초(서버 리소스 부족)
- 건너뛴 프레임/초(네트워크 리소스 부족)
- 건너뛴 프레임/초(클라이언트 리소스 부족)

건너뛴 프레임/초 카운터의 값이 높으면 카운터가 추적하는 리소스와 관련이 있음을 의미합니다. 예를 들어 클라이언트가 서버에서 프레임을 제공하는 속도와 동일한 속도로 프레임을 디코딩하고 표시하지 않으면 건너뛴 프레임/초(클라이언트 리소스 부족) 카운터가 높습니다.

출력 프레임/초 카운터가 입력 프레임/초 카운터와 일치하는 경우에도 여전히 이상한 지연 또는 대기를 발견할 수 있습니다. 평균 인코딩 시간이 원인일 수 있습니다. 인코딩은 단일 세션(vGPU) 시나리오의 서버와 다중 세션 시나리오의 VM에서 발생하는 동기 프로세스입니다. 평균 인코딩 시간은 33ms 미만이어야 합니다. 평균 인코딩 시간이 33ms 미만이지만 여전히 성능 문제가 있는 경우 사용 중인 앱 또는 운영 체제에 문제가 있을 수 있습니다.

앱 관련 문제를 진단하는 방법에 대한 자세한 내용은 [사용자 입력 지연 성능 카운터](/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters/)를 참조하세요.

RDP는 33ms의 평균 인코딩 시간을 지원하므로 초당 최대 30프레임으로 입력 프레임 속도를 지원합니다. 33ms는 지원되는 최대 프레임 속도입니다. 대부분의 경우 사용자가 경험하는 프레임 속도는 원본에서 RDP에 프레임을 제공하는 빈도에 따라 낮아집니다. 예를 들어 비디오 감시와 같은 작업을 수행하려면 30프레임/초의 전체 입력 프레임 속도가 필요하지만 문서를 자주 편집하는 것과 같은 덜 계산 집약적인 작업을 수행하는 작업은 사용자의 품질 저하 경험 없이 입력 프레임/초에 대해 훨씬 더 낮은 값을 반환합니다.

### <a name="addressing-poor-frame-quality"></a>프레임 품질 저하 해결

프레임 품질 카운터를 사용하여 프레임 품질 문제를 진단합니다. 이 카운터는 출력 프레임의 품질을 원본 프레임의 품질에 대한 백분율로 나타냅니다. 품질 손실은 RemoteFX 때문이거나 그래픽 원본에 내재될 수도 있습니다. RemoteFX가 품질 손실을 야기하는 경우 이 문제는 더 높은 품질의 콘텐츠를 전송하기 위해 네트워크 또는 서버 리소스가 부족할 수 있습니다.

## <a name="mitigation"></a>완화 방법

서버 리소스에서 병목 현상이 발생하는 경우 다음 방법 중 하나를 수행하여 성능을 향상시킵니다.

- 호스트당 세션 수를 줄입니다.
- 서버에서 메모리 및 컴퓨팅 리소스를 늘립니다.
- 연결의 해상도를 삭제합니다.

네트워크 리소스에서 병목 현상이 발생하는 경우 다음 방법 중 하나를 사용하여 세션당 네트워크 가용성을 향상시킵니다.

- 호스트당 세션 수를 줄입니다.
- 높은 대역폭의 네트워크를 사용합니다.
- 연결의 해상도를 삭제합니다.

클라이언트 리소스에서 병목 현상이 발생하는 경우 다음 방법 중 하나를 수행하여 성능을 향상시킵니다.

- 최신 원격 데스크톱 클라이언트를 설치합니다.
- 클라이언트 머신에서 메모리 및 컴퓨팅 리소스를 늘립니다.

> [!NOTE]
> 현재 원본 프레임/초 카운터를 지원하지 않습니다. 현재 원본 프레임/초 카운터는 항상 0을 표시합니다.

## <a name="next-steps"></a>다음 단계

- GPU에 최적화된 Azure 가상 머신을 만들려면 [Azure Virtual Desktop 환경에 대한 GPU(그래픽 처리 디바이스) 가속 구성](configure-vm-gpu.md)을 참조하세요.
- 문제 해결 및 에스컬레이션 트랙에 대한 개요는 [문제 해결 개요, 피드백 및 지원](troubleshoot-set-up-overview.md)을 참조하세요.
- 서비스에 대한 자세한 내용은 [Windows 데스크톱 환경](environment-setup.md)을 참조하세요.
