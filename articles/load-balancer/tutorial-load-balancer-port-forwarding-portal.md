---
title: '자습서: 포트 전달 구성 - Azure Portal'
titleSuffix: Azure Load Balancer
description: 이 자습서에서는 Azure Load Balancer를 사용하여 Azure 가상 네트워크의 VM에 대한 연결을 설정하도록 포트 전달을 구성하는 방법을 보여 줍니다.
author: asudbring
ms.author: allensu
ms.service: load-balancer
ms.topic: tutorial
ms.date: 8/26/2021
ms.custom: template-tutorial
ms.openlocfilehash: 0d36be9f0ba0fc9e1b29e3fdaf0b3f9857db2204
ms.sourcegitcommit: dcf1defb393104f8afc6b707fc748e0ff4c81830
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/27/2021
ms.locfileid: "123112140"
---
# <a name="tutorial-configure-port-forwarding-in-azure-load-balancer-using-the-azure-portal"></a>자습서: Azure Portal을 사용하여 Azure Load Balancer에서 포트 전달 구성

포트 전달을 사용하면 Azure Load Balancer 공용 IP 주소 및 포트 번호를 통해 Azure 가상 네트워크의 VM(가상 머신)에 연결할 수 있습니다. 

이 자습서에서는 다음과 같은 작업을 수행하는 방법을 살펴봅니다.

> [!div class="checklist"]
> * 가상 네트워크 및 가상 머신을 만듭니다.
> * 백 엔드 풀에 대한 아웃바운드 인터넷 액세스를 위한 NAT 게이트웨이를 만듭니다.
> * 프런트 엔드 IP, 상태 프로브, 백 엔드 구성, 부하 분산 규칙 및 인바운드 NAT 규칙을 사용하여 표준 SKU 공용 부하 분산 장치를 만듭니다.
> * VM에 웹 서버를 설치하고 구성하여 포트 전달 및 부하 분산 규칙을 보여줍니다.

## <a name="prerequisites"></a>필수 구성 요소

- 활성 구독이 있는 Azure 계정. [체험 계정을 만듭니다](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).

## <a name="create-virtual-network-and-virtual-machines"></a>가상 네트워크 및 가상 머신 만들기

자습서의 리소스에는 가상 네트워크 및 서브넷이 필요합니다. 이 섹션에서는 이후 단계를 위해 가상 네트워크와 가상 머신을 만듭니다.

1. [Azure Portal](https://portal.azure.com)에 로그인합니다.

2. 포털 맨 위에 있는 검색 상자에 **가상 머신** 을 입력합니다. 검색 결과에서 **가상 머신** 을 선택합니다.

3. **가상 머신** 에서 **+ 만들기** > **가상 머신** 을 선택합니다.
   
4. **가상 머신 만들기** 의 **기본** 탭에서 값을 입력하거나 선택합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | **프로젝트 세부 정보** |   |
    | Subscription | 구독을 선택합니다. |
    | Resource group | **새로 만들기** 를 선택합니다. </br> **TutorialLBPF-rg** 를 입력합니다. </br> **확인** 을 선택합니다. |
    | **인스턴스 세부 정보** |    |
    | 가상 머신 이름 | **myVM1** 을 입력합니다. |
    | 지역 | **(미국) 미국 서부 2** 를 입력합니다. |
    | 가용성 옵션 | **가용성 영역** 을 선택합니다. |
    | 가용성 영역 | **1** 을 입력합니다. |
    | 이미지 | **Ubuntu Server 20.04 LTS - Gen2** 를 선택합니다. |
    | Azure Spot 인스턴스 | 선택 안 함(기본값)을 그대로 둡니다. |
    | 크기 | VM 크기를 선택합니다. |
    | **관리자 계정** |    |
    | 인증 유형 | **SSH 공개 키** 를 선택합니다. |
    | 사용자 이름 | **azureuser** 를 입력합니다. |
    | SSH 공개 키 원본 | **새 키 쌍 생성** 을 선택합니다. |
    | 키 쌍 이름 | **myKey** 를 입력합니다. |
    | **인바운드 포트 규칙** |    |
    | 공용 인바운드 포트 | **없음** 을 선택합니다. |

    :::image type="content" source="./media/tutorial-load-balancer-port-forwarding-portal/create-vm-portal.png" alt-text="가상 머신 만들기 스크린샷":::

5. **네트워킹** 탭을 선택하거나 **다음: 디스크**, **다음: 네트워킹** 을 차례로 선택합니다.

6. **네트워킹** 탭에서 다음 정보를 입력하거나 선택합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | **네트워크 인터페이스** |   |
    | 가상 네트워크 | **새로 만들기** 를 선택합니다. </br> **이름** 에 **myVNet** 을 입력합니다. </br> **주소 공간** 의 **주소 범위** 아래에 **10.1.0.0/16** 을 입력합니다. </br> **서브넷** 의 **서브넷 이름** 아래에 **myBackendSubnet** 을 입력합니다. </br> **주소 범위** 에 **10.1.0.0/24** 를 입력합니다. </br> **확인** 을 선택합니다. |
    | 서브넷 | **myBackendSubnet** 을 선택합니다. |
    | 공용 IP | **없음** 을 선택합니다. |
    | NIC 네트워크 보안 그룹 추가 | **고급** 을 선택합니다. |
    | 네트워크 보안 그룹 구성 | **새로 만들기** 를 선택합니다. </br> **이름** 에 **myNSG** 를 입력합니다. </br> **인바운드 규칙** 아래에서 **+ 인바운드 규칙 추가** 를 선택합니다. </br> **서비스** 에서 **HTTP** 를 선택합니다. </br> **우선 순위** 에 **100** 을 입력합니다. </br> **이름** 에 **myNSGRule** 을 입력합니다. </br> **추가** 를 선택합니다. </br> **확인** 을 선택합니다. |

7. **검토 + 만들기** 탭을 선택하거나, 페이지 하단에 있는 **검토 + 만들기** 단추를 선택합니다.

8. **만들기** 를 선택합니다.

9. **새 키 쌍 생성** 프롬프트에서 **프라이빗 키 다운로드 및 리소스 만들기** 를 선택합니다. 키 파일은 myKey.pem으로 다운로드됩니다. .pem 파일이 다운로드된 위치를 알아야 합니다. 이 키 파일의 경로가 이후 단계에서 필요합니다.

8. 1~8단계에 따라 다음 값 및 **myVM1** 과 동일한 다른 모든 설정을 사용하여 또 다른 VM을 만듭니다.

    | 설정 | VM 2 |
    | ------- | ----- |
    | **기본 사항** |    |
    | **인스턴스 세부 정보** |   |
    | 가상 머신 이름 | **myVM2** |
    | 가용성 영역 | **2** |
    | **관리자 계정** |   |
    | 인증 유형 | **SSH 퍼블릭 키** |
    | SSH 공개 키 원본 | **Azure에 저장된 기존 키 사용** 을 선택합니다. |
    | 저장된 키 | **myKey** 를 선택합니다. |
    | **네트워킹** |   |
    | **네트워크 인터페이스** |  |
    | 공용 IP | **없음** 을 선택합니다. |
    | NIC 네트워크 보안 그룹 추가 | **고급** 을 선택합니다. |
    | 네트워크 보안 그룹 구성 | 기존 **myNSG** 를 선택합니다. |

## <a name="create-nat-gateway"></a>NAT 게이트웨이 만들기

이 섹션에서는 가상 네트워크의 리소스에 대한 아웃바운드 인터넷 액세스를 위한 NAT 게이트웨이를 만듭니다. 

1. 포털 맨 위에 있는 검색 상자에 **NAT 게이트웨이** 를 입력합니다. 검색 결과에서 **NAT 게이트웨이** 를 선택합니다.

2. **NAT 게이트웨이** 에서 **+ 만들기** 를 선택합니다.

3. **NAT(Network Address Translation) 게이트웨이 만들기** 에서 다음 정보를 입력하거나 선택합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | **프로젝트 세부 정보** |   |
    | Subscription | 구독을 선택합니다. |
    | Resource group | **TutorialLBPF-rg** 를 선택합니다. |
    | **인스턴스 세부 정보** |    |
    | NAT 게이트웨이 이름 | **myNATgateway** 를 입력합니다. |
    | 가용성 영역 | **없음** 을 선택합니다. |
    | 유휴 제한 시간(분) | **15** 를 입력합니다. |

4. **아웃바운드 IP** 탭을 선택하거나 페이지 하단에 있는 **다음: 아웃바운드 IP** 단추를 선택합니다.

5. **아웃바운드 IP** 에서 **공용 IP 주소** 옆에 있는 **새 공용 IP 주소 만들기** 를 선택합니다.

6. **공용 IP 주소 추가** 에서 **이름** 에 **myNATGatewayIP** 를 입력합니다.

7. **확인** 을 선택합니다.

8. **서브넷** 탭을 선택하거나 페이지 하단에 있는 **다음: 서브넷** 단추를 선택합니다.

9. **가상 네트워크** 의 **서브넷** 탭에서 **myVNet** 을 선택합니다.

10. **서브넷 이름** 아래에서 **myBackendSubnet** 을 선택합니다.

11. 페이지 하단에서 파란색 **검토 + 만들기** 단추를 선택하거나 **검토 + 만들기** 탭을 선택합니다.

12. **만들기** 를 선택합니다.

## <a name="create-load-balancer"></a>부하 분산 장치 만들기

이 섹션에서는 부하 분산 장치를 만듭니다. 프런트 엔드 IP, 백 엔드 풀, 부하 분산 및 인바운드 NAT 규칙이 만들기의 일환으로 구성됩니다.

1. 포털 맨 위에 있는 검색 상자에 **부하 분산 장치** 를 입력합니다. 검색 결과에서 **부하 분산 장치** 를 선택합니다.

2. **부하 분산 장치** 페이지에서 **만들기** 를 선택합니다.

3. **부하 분산 장치 만들기** 페이지의 **기본 사항** 탭에서 다음 정보를 입력하거나 선택합니다. 

    | 설정                 | 값                                              |
    | ---                     | ---                                                |
    | **프로젝트 세부 정보** |   |
    | Subscription               | 구독을 선택합니다.    |    
    | Resource group         | **TutorialLBPF-rg** 를 선택합니다. |
    | **인스턴스 세부 정보** |   |
    | 이름                   | **myLoadBalancer** 를 입력합니다.                                   |
    | 지역         | **미국 서부 2** 를 선택합니다.                                        |
    | Type          | **공용** 을 선택합니다.                                        |
    | SKU           | 기본값인 **표준** 을 그대로 둡니다. |
    | 계층          | 기본 **지역** 을 그대로 둡니다. |


4. 페이지 하단에서 **다음: 프런트 엔드 IP 구성** 을 선택합니다.

5. **프런트 엔드 IP 구성** 에서 **+ 프런트 엔드 IP 추가** 를 선택합니다.

6. **이름** 에 **LoadBalancerFrontend** 를 입력합니다.

7. **IP 버전** 에 대해 **IPv4** 또는 **IPv6** 를 선택합니다.

    > [!NOTE]
    > IPv6는 현재 라우팅 기본 설정 또는 지역 간 부하 분산(글로벌 계층)에서 지원되지 않습니다.

8. **IP 형식** 으로 **IP 주소** 를 선택합니다.

    > [!NOTE]
    > IP 접두사에 대한 자세한 내용은 [Azure 공용 IP 주소 접두사](../virtual-network/public-ip-address-prefix.md)를 참조하세요.

9. **공용 IP 주소** 에 **새로 만들기** 를 선택합니다.

10. **공용 IP 주소 추가** 에서 **이름** 에 **myPublicIP** 를 입력합니다.

11. **가용성 영역** 에 **영역 중복** 을 선택합니다.

    > [!NOTE]
    > [가용성 영역](../availability-zones/az-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json#availability-zones)이 있는 지역에서는 영역 없음(기본 옵션), 특정 영역 또는 영역 중복을 선택하는 옵션이 있습니다. 선택은 특정 도메인 오류 요구 사항에 따라 달라집니다. 가용성 영역이 없는 지역에서는 이 필드가 표시되지 않습니다. </br> 가용성 영역에 대한 자세한 내용은 [가용성 영역 개요](../availability-zones/az-overview.md)를 참조하세요.

12. **라우팅 기본 설정** 에는 **Microsoft 네트워크** 의 기본값을 그대로 둡니다.

13. **확인** 을 선택합니다.

14. **추가** 를 선택합니다.

15. 페이지 하단에서 **다음: 백 엔드 풀** 을 선택합니다.

16. **백 엔드 풀** 탭에서 **+ 백 엔드 풀 추가** 를 선택합니다.

17. **백 엔드 풀 추가** 에서 다음 정보를 입력하거나 선택합니다.

    | Setting | 값 |
    | ------- | ----- |
    | 이름 | **myBackendPool** 을 입력합니다. |
    | 가상 네트워크 | **myVNet(TutorialLBPF-rg)** 을 선택합니다. |
    | 백 엔드 풀 구성 | **NIC** 를 선택합니다. |
    | IP 버전 | **IPv4** 를 선택합니다. |

18. **가상 머신** 에서 **+ 추가** 를 선택합니다.

19. **백 엔드 풀에 가상 머신 추가** 에서 **myVM1** 및 **myVM2** 옆에 있는 확인란을 선택합니다.

20. **추가** 를 선택합니다.

21. **추가** 를 선택합니다.

22. 페이지 하단에 있는 **다음: 인바운드 규칙** 단추를 선택합니다.

23. **인바운드 규칙** 탭의 **부하 분산 규칙** 에서 **+ 부하 분산 규칙 추가** 를 선택합니다.

24. **부하 분산 규칙 추가** 에서 다음 정보를 입력하거나 선택합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | Name | **myHTTPRule** 입력 |
    | IP 버전 | 요구 사항에 따라 **IPv4** 또는 **IPv6** 를 선택합니다. |
    | 프런트 엔드 IP 주소 | **LoadBalancerFrontend** 를 선택합니다. |
    | 프로토콜 | **TCP** 를 선택합니다. |
    | 포트 | **80** 을 입력합니다. |
    | 백 엔드 포트 | **80** 을 입력합니다. |
    | 백 엔드 풀 | **myBackendPool** 을 선택합니다. |
    | 상태 프로브 | **새로 만들기** 를 선택합니다. </br> **이름** 에 **myHealthProbe** 를 입력합니다. </br> **프로토콜** 에서 **HTTP** 를 선택합니다. </br> 나머지는 기본값으로 두고 **확인** 을 선택합니다. |
    | 세션 지속성 | **없음** 을 선택합니다. |
    | 유휴 제한 시간(분) | **15** 를 입력하거나 선택합니다. |
    | TCP 재설정 | **사용** 을 선택합니다. |
    | 부동 IP | **사용 안 함** 을 선택합니다. |
    | 아웃바운드 SNAT(Source Network Address Translation) | **(권장) 아웃바운드 규칙을 사용하여 백 엔드 풀 멤버에 인터넷 액세스 권한을 제공합니다.** (기본값)를 그대로 둡니다. |

25. **추가** 를 선택합니다.

26. **인바운드 규칙** 탭의 **인바운드 NAT 규칙** 에서 **+ 인바운드 NAT 규칙 추가** 를 선택합니다.

27. **인바운드 NAT 규칙 추가** 에서 다음 정보를 입력하거나 선택합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | Name | **myNATRuleVM1-221** 을 입력합니다. |
    | 프런트 엔드 IP 주소 | **LoadBalancerFrontend** 를 선택합니다. |
    | 서비스 | **사용자 지정** 을 선택합니다. |
    | 프로토콜 | **TCP** 의 기본값을 그대로 둡니다. |
    | 유휴 제한 시간(분) | **15** 를 입력하거나 선택합니다. |
    | TCP 재설정 | **사용** 을 선택합니다. |
    | 포트 | **221** 을 입력합니다. |
    | 대상 가상 머신 | **myVM1** 을 선택합니다. |
    | Network IP 구성 | **ipconfig1(10.1.0.4)** 을 선택합니다. |
    | 포트 매핑 | **사용자 지정** 을 선택합니다. |
    | 부동 IP | **사용 안 함**(기본값)을 그대로 둡니다. |
    | 대상 포트 | **22** 를 입력합니다. |

28. **추가** 를 선택합니다.

29. **+ 인바운드 NAT 규칙 추가** 를 선택합니다.

30. **인바운드 NAT 규칙 추가** 에서 다음 정보를 입력하거나 선택합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | Name | **myNATRuleVM2-222** 를 입력합니다. |
    | 프런트 엔드 IP 주소 | **LoadBalancerFrontend** 를 선택합니다. |
    | 서비스 | **사용자 지정** 을 선택합니다. |
    | 프로토콜 | **TCP** 의 기본값을 그대로 둡니다. |
    | 유휴 제한 시간(분) | **15** 를 입력하거나 선택합니다. |
    | TCP 재설정 | **사용** 을 선택합니다. |
    | 포트 | **222** 를 입력합니다. |
    | 대상 가상 머신 | **myVM2** 를 선택합니다. |
    | Network IP 구성 | **ipconfig1(10.1.0.5)** 을 선택합니다. |
    | 포트 매핑 | **사용자 지정** 을 선택합니다. |
    | 부동 IP | **사용 안 함**(기본값)을 그대로 둡니다. |
    | 대상 포트 | **22** 를 입력합니다. |

31. **추가** 를 선택합니다.

32. 페이지 하단에 있는 파란색 **검토 + 만들기** 단추를 선택합니다.

33. **만들기** 를 선택합니다.

## <a name="install-web-server"></a>웹 서버 설치

이 섹션에서는 인바운드 NAT 규칙을 통해 가상 머신에 SSH로 연결하고 웹 서버를 설치합니다.

1. 포털 맨 위에 있는 검색 상자에 **부하 분산 장치** 를 입력합니다. 검색 결과에서 **부하 분산 장치** 를 선택합니다.

2. **myLoadBalancer** 를 선택합니다.

3. **myLoadBalancer** 의 **개요** 페이지에 있는 **공용 IP 주소** 를 기록해 둡니다.  이 예시에서는 **20.190.2.163** 입니다.

    :::image type="content" source="./media/tutorial-load-balancer-port-forwarding-portal/get-public-ip.png" alt-text="Azure Portal의 공용 IP 스크린샷":::

4. Mac 또는 Linux 컴퓨터를 사용하는 경우 Bash 프롬프트를 엽니다. Windows 컴퓨터를 사용하는 경우 PowerShell 프롬프트를 엽니다.

5. 프롬프트에서 **myVM1** 에 대한 SSH 연결을 엽니다. IP 주소를 이전 단계에서 검색한 주소 및 myVM1 인바운드 NAT 규칙에 사용한 포트 **221** 로 대체합니다. .pem의 경로를 키 파일이 다운로드된 경로로 대체합니다.

    ```console
    ssh -i .\Downloads\myKey.pem azureuser@20.190.2.163 -p 221
    ```

    > [!TIP]
    > 만든 SSH 키는 다음에 Azure에서 VM을 만들 때 사용할 수 있습니다. 다음에 VM을 만들 때 **SSH 공개 키 원본** 에 대해 **Azure에 저장된 키 사용** 을 선택하면 됩니다. 컴퓨터에 프라이빗 키가 이미 있으므로 아무것도 다운로드하지 않아도 됩니다.

6. SSH 세션에서 패키지 소스를 업데이트한 다음, 최신 NGINX 패키지를 설치합니다.

    ```bash
    sudo apt-get -y update
    sudo apt-get -y install nginx
    ``` 

7. `Exit`를 입력하여 SSH 세션을 나갑니다.

8. 프롬프트에서 **myVM2** 에 대한 SSH 연결을 엽니다. IP 주소를 이전 단계에서 검색한 주소 및 myVM2 인바운드 NAT 규칙에 사용한 포트 **222** 로 대체합니다. .pem의 경로를 키 파일이 다운로드된 경로로 대체합니다.

    ```console
    ssh -i .\Downloads\myKey.pem azureuser@20.190.2.163 -p 222
    ```

9. SSH 세션에서 패키지 소스를 업데이트한 다음, 최신 NGINX 패키지를 설치합니다.

    ```bash
    sudo apt-get -y update
    sudo apt-get -y install nginx
    ``` 

10. `Exit`를 입력하여 SSH 세션을 나갑니다.

## <a name="test-the-web-server"></a>웹 서버 테스트

이 섹션에서 웹 브라우저를 열고 이전 단계에서 검색한 부하 분산 장치의 IP 주소를 입력합니다.

1. 웹 브라우저를 엽니다.

2. 주소 표시줄에 부하 분산 장치의 IP 주소를 입력합니다. 이 예시에서는 **20.190.2.163** 입니다.

3. 기본 NGINX 웹 사이트가 표시됩니다.

    :::image type="content" source="./media/tutorial-load-balancer-port-forwarding-portal/web-server-test.png" alt-text="NGINX 웹 서버 테스트 스크린샷":::

## <a name="clean-up-resources"></a>리소스 정리

이 애플리케이션을 더 이상 사용하지 않으려면 다음 단계에 따라 가상 머신 및 부하 분산 장치를 삭제합니다.

1. 포털 맨 위에 있는 검색 상자에 **리소스 그룹** 을 입력합니다.  검색 결과에서 **리소스 그룹** 을 선택합니다.

2. **리소스 그룹** 에서 **TutorialLBPF-rg** 를 선택합니다.

3. **리소스 그룹 삭제** 를 선택합니다.

4. **리소스 그룹 이름 입력:** 에 **TutorialLBPF-rg** 를 입력합니다. **삭제** 를 선택합니다.

## <a name="next-steps"></a>다음 단계

지역 간 부하 분산 장치를 만드는 방법을 알아보려면 다음 문서로 계속 진행하세요.

> [!div class="nextstepaction"]
> [Azure Portal을 사용하여 지역 간 부하 분산 장치 만들기](tutorial-cross-region-portal.md)
