---
title: Azure Database for MySQL 유연한 서버를 사용하는 영역 중복 고가용성 개요
description: Azure Database for MySQL 유연한 서버를 사용하는 영역 중복 고가용성의 개념에 대해 알아봅니다.
author: SudheeshGH
ms.author: sunaray
ms.service: mysql
ms.topic: conceptual
ms.date: 08/26/2021
ms.openlocfilehash: 4a8f7d5bd10c21b14c8935bf0a44040501ebeb90
ms.sourcegitcommit: dcf1defb393104f8afc6b707fc748e0ff4c81830
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/27/2021
ms.locfileid: "123109191"
---
# <a name="high-availability-concepts-in-azure-database-for-mysql-flexible-server-preview"></a>Azure Database for MySQL 유연한 서버의 고가용성 개념(미리 보기)

[!INCLUDE[applies-to-mysql-flexible-server](../includes/applies-to-mysql-flexible-server.md)]

> [!IMPORTANT] 
> Azure Database for MySQL - 유연한 서버는 현재 공개 미리 보기로 제공됩니다.

Azure Database for MySQL 유연한 서버(미리 보기)를 사용하면 자동 장애 조치(failover)로 고가용성을 구성할 수 있습니다. 고가용성 솔루션은 커밋된 데이터가 오류로 인해 손실되지 않고 데이터베이스가 소프트웨어 아키텍처에서 단일 오류 지점이 되지 않도록 설계되었습니다. 고가용성이 구성되면 유연한 서버가 대기 복제본을 자동으로 프로비저닝하고 관리합니다. 다음 두 가지의 고가용성 아키텍처 모델이 있습니다.

* **영역 중복 HA(고가용성):** 이 옵션은 여러 가용성 영역에서 인프라의 완전한 격리 및 중복성을 위해 선호됩니다. 최고 수준의 가용성을 제공하지만 영역 간에 애플리케이션 중복성을 구성해야 합니다. 영역 중복 HA는 가용성 영역의 모든 인프라 장애에 대해 최고 수준의 가용성을 확보하고 가용성 영역 전체의 대기 시간이 허용되는 경우 선호됩니다. 영역 중복 HA는 서버 생성 시에만 사용하도록 설정할 수 있습니다. 영역 중복 HA는 지역이 여러 [가용성 영역](../../availability-zones/az-overview.md)을 지원하고 [영역 중복 프리미엄 파일 공유](../..//storage/common/storage-redundancy.md#zone-redundant-storage)를 사용할 수 있는 [Azure 지역의 하위 집합](./overview.md#azure-regions)에서 사용할 수 있습니다.

* **동일 영역 HA(고가용성):** 이 옵션은 기본 서버와 대기 서버가 동일한 가용성 영역에 있으므로 네트워크 대기 시간이 짧은 인프라 중복에 선호됩니다. 영역 간에 애플리케이션 중복성을 구성하지 않고도 고가용성을 제공합니다. 동일한 영역 HA는 네트워크 대기 시간이 가장 짧은 단일 가용성 영역 내에서 최고 수준의 가용성을 확보하려는 경우 선호됩니다. 동일 영역 HA는 Azure Database for MySQL 유연한 서버를 만들 수 있는 모든 [Azure 지역](./overview.md#azure-regions)에서 사용할 수 있습니다.  

## <a name="zone-redundancy-high-availability-architecture"></a>영역 중복 고가용성 아키텍처
 
영역 중복 HA 옵션이 있는 서버를 배포하면 하나의 가용성 영역에 기본 서버가 만들어지고 기본 서버와 동일한 구성(컴퓨팅 계층, 컴퓨팅 크기, 스토리지 크기 및 네트워크 구성)이 있는 대기 복제본 서버가 동일한 Azure 지역의 다른 가용성 영역에 만들어집니다. 기본 및 대기 복제본에 대해 원하는 가용성 영역을 지정할 수 있습니다. 대기 데이터베이스 서버와 대기 애플리케이션을 같은 영역에 배치하면 대기 시간이 줄어들고 사용자가 재해 복구 상황과 “영역 다운” 시나리오에 더 잘 대비할 수 있습니다.

:::image type="content" source="./media/concepts-high-availability/1-flexible-server-overview-zone-redundant-ha.png" alt-text="영역 중복 HA":::

데이터 및 로그 파일은 [ZRS(영역 중복 스토리지)](../../storage/common/storage-redundancy.md#redundancy-in-the-primary-region)에서 호스트됩니다. ZRS와 함께 제공되는 스토리지 수준의 복제를 사용하여 데이터 및 로그 파일을 대기 서버에 복제합니다. 장애 조치(failover)가 있는 경우 대기 복제본이 활성화되고 기본 서버의 이진 로그 파일이 대기 서버에 계속 적용되어 기본 서버에서 마지막으로 커밋된 트랜잭션으로 온라인 상태가 됩니다. ZRS의 로그를 사용하면 기본 서버를 사용할 수 없는 경우에도 로그에 액세스할 수 있어 데이터 손실이 전혀 발생하지 않습니다. 대기 복제본이 활성화되고 이진 로그가 적용되면 현재 대기 복제본 서버가 주 서버의 역할을 수행합니다. 클라이언트가 다시 연결될 때 클라이언트 연결이 새 기본으로 전달되도록 DNS가 업데이트됩니다. 장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 사용자 작업이 필요하지 않습니다. 그런 다음 고가용성 솔루션은 가능한 경우 이전 기본 서버를 다시 가져와 대기 서버로 배치합니다.
 
애플리케이션은 데이터베이스 서버 이름을 사용하여 주 서버에 연결됩니다. 대기 복제본 정보는 직접 액세스에 노출되지 않습니다. 커밋 및 쓰기는 주 서버의 ZRS(영역 중복 스토리지) 스토리지에서 로그 파일을 플러시한 후 승인됩니다. ZRS 스토리지에 사용되는 동기화 복제 기술로 인해 애플리케이션은 쓰기 및 커밋에 대해 5-10% 늘어난 대기 시간을 예측할 수 있습니다.
 
스냅샷과 로그 백업 모두 자동 백업은 주 데이터베이스 서버의 영역 중복 스토리지에서 수행됩니다.

## <a name="same-zone-high-availability-architecture"></a>동일한 영역의 고가용성 아키텍처
 
동일 영역 HA 옵션이 있는 서버를 배포하면 기본 서버와 동일한 구성(컴퓨팅 계층, 컴퓨팅 크기, 스토리지 크기 및 네트워크 구성)으로 동일한 영역에 기본 서버와 대기 복제본 서버가 만들어집니다. 대기 서버는 공동 배치로 인해 사용자 애플리케이션과 데이터베이스 서버 사이의 장애 조치(failover) 시간과 네트워크 대기 시간을 줄이는 별도의 가상 머신(컴퓨팅)으로 인프라 중복성을 제공합니다.

:::image type="content" source="./media/concepts-high-availability/flexible-server-overview-same-zone-ha.png" alt-text="동일한 중복 고가용성":::

데이터 및 로그 파일은 [LRS(로컬 중복 스토리지)](../../storage/common/storage-redundancy.md#locally-redundant-storage)에서 호스트됩니다. LRS와 함께 사용 가능한 스토리지 수준 복제를 사용하여 데이터 및 로그 파일을 대기 서버에 복제합니다.

장애 조치(failover)가 있는 경우 대기 복제본이 활성화되고 기본 서버의 이진 로그 파일이 대기 서버에 계속 적용되어 기본 서버에서 마지막으로 커밋된 트랜잭션으로 온라인 상태가 됩니다. LRS의 로그를 사용하면 기본 서버를 사용할 수 없는 경우에도 로그에 액세스할 수 있으므로 데이터 손실이 없는지 확인하는 데 도움이 됩니다. 대기 복제본이 활성화되고 이진 로그가 적용되면 현재 대기 복제본이 기본 서버의 역할을 합니다. DNS는 클라이언트가 다시 연결될 때 연결을 새 기본으로 리디렉션하도록 업데이트됩니다. 장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 사용자 작업이 필요하지 않습니다. 그런 다음 고가용성 솔루션은 가능한 경우 이전 기본 서버를 다시 가져와 대기 서버로 배치합니다.
 
애플리케이션은 데이터베이스 서버 이름을 사용하여 주 서버에 연결됩니다. 대기 복제본 정보는 직접 액세스에 노출되지 않습니다. 커밋 및 쓰기는 주 서버의 LRS(로컬 중복 스토리지) 스토리지에서 로그 파일을 플러시한 후 승인됩니다. 동일한 영역에 기본 및 대기 복제본이 있으므로 복제 지연이 적고 동일한 Azure 가용성 영역 내에 배치되는 경우 애플리케이션 서버와 데이터베이스 서버 간의 대기 시간이 더 짧습니다. 동일한 영역 설정은 특정 가용성 영역에 대해 종속 인프라가 다운되는 시나리오의 경우 고가용성을 제공하지 않습니다.   해당 가용성 영역에 대해 모든 종속 서비스가 다시 온라인 상태가 될 때까지 가동 중지 시간이 있습니다.
 
스냅샷과 로그 백업 모두 자동 백업은 주 데이터베이스 서버의 로컬 중복 스토리지에서 수행됩니다.

>[!Note]
>영역 중복 및 동일 영역 HA 모두에 대해
>* 장애가 발생한 경우 대기 복제본이 기본 역할을 인수하는 시간은 대기 복제본의 이진 로그 애플리케이션에 따라 다릅니다. 따라서 모든 테이블에서 기본 키를 사용하여 장애 조치(failover) 시간을 줄이는 것이 좋습니다. 일반적인 장애 조치(failover) 시간 범위는 60~120초입니다. 
>* 대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없지만 빠른 장애 조치(failover)를 사용할 수 있는 수동 대기 상태입니다.
>* 항상 FQDN(정규화된 도메인 이름)을 사용하여 주 서버에 연결하고 IP 주소를 사용하여 연결하지 않도록 합니다. 장애 조치(failover)의 경우 주 서버와 대기 서버 역할이 전환되면 DNS A 레코드도 변경되어 연결 문자열에 IP 주소가 사용되는 경우 애플리케이션이 새 주 서버에 연결하지 못할 수 있습니다.

## <a name="failover-process"></a>장애 조치(failover) 프로세스 
 
### <a name="planned---forced-failover"></a>계획됨 - 강제 장애 조치(failover)
 
Azure Database for MySQL 유연한 서버 강제 장애 조치(failover)를 사용하면 수동으로 장애 조치(failover)를 수행하여 애플리케이션 시나리오에서 기능을 테스트할 수 있으며 가동 중단 시 대비할 수 있습니다. 강제 장애 조치(failover)는 DNS 레코드를 업데이트하여 대기 복제본을 동일한 데이터베이스 서버 이름으로 주 서버가 되도록 활성화하는 장애 조치(failover)를 트리거하여 대기 서버를 주 서버로 전환합니다. 기존의 주 서버가 다시 시작되고 대기 복제본으로 전환됩니다. 클라이언트 연결의 연결이 끊어지고 작업을 다시 시작하려면 다시 연결해야 합니다. 현재 워크로드 및 마지막 검사점에 따라 전체 장애 조치(failover) 시간이 측정됩니다. 일반적으로 60-120초 사이입니다.
 
### <a name="unplanned--automatic-failover"></a>계획되지 않음 - 자동 장애 조치(failover) 
 
계획되지 않은 서비스 가동 중지 시간에는 소프트웨어 버그 또는 데이터베이스의 가용성에 영향을 미치는 컴퓨팅, 네트워크, 스토리지 오류 또는 전원 중단과 같은 인프라 오류가 포함됩니다. 데이터베이스를 사용할 수 없는 경우 대기 복제본에 대한 복제가 중단되고 대기 복제본이 주 데이터베이스 역할로 활성화됩니다. DNS가 업데이트되고 클라이언트가 데이터베이스 서버에 다시 연결되어 작업을 다시 시작합니다. 전반적인 장애 조치(failover) 시간에는 60~120초가 소요됩니다. 그러나 장애 조치(failover) 시의 주 데이터베이스 서버 활동(예: 대규모 트랜잭션 및 복구 시간)에 따라 장애 조치(failover)에 더 오랜 시간이 소요될 수 있습니다.

## <a name="high-availability-monitoring"></a>고가용성 모니터링
HA의 상태는 개요 페이지에서 지속적으로 모니터링되고 보고됩니다. 다음과 같은 다양한 복제 상태가 나열됩니다.

| **Status** | **설명** |
| :----- | :------ |
| <b>NotEnabled | 영역 중복 HA를 사용하도록 설정하지 않았습니다. |
| <b>ReplicatingData | 대기 서버를 만든 후에 주 서버의 데이터를 받는 중입니다. |
| <b>FailingOver | 데이터베이스 서버가 주 서버에서 대기 서버로 장애 조치(failover)를 진행하는 중입니다. |
| <b>정상 | 영역 중복 HA가 안정되었으며 정상 상태입니다. |
| <b>RemovingStandby | 사용자의 작업에 따라 대기 복제본 서버를 삭제하는 중입니다.| 

##  <a name="limitations"></a>제한 사항 
 
고가용성을 사용할 때 유의해야 할 몇 가지 고려 사항은 다음과 같습니다.
* 영역 중복 고가용성은 유연한 서버를 만들 때만 설정할 수 있습니다.
* 버스트 가능한 컴퓨팅 계층에서는 고가용성이 지원되지 않습니다.
* 정적 매개 변수 변경 내용을 선택하기 위해 주 데이터베이스 서버를 다시 시작하면 대기 복제본도 다시 시작됩니다.
* 영역 중복 고가용성 서버에 대한 읽기 복제본 구성은 지원되지 않습니다.
* HA 서버에서는 입력 데이터 복제가 지원되지 않습니다. 
* HA 솔루션이 GTID를 사용하므로 GTID 모드가 ON으로 설정됩니다. 워크로드에 [GTID를 사용한 복제에 대한 제한 사항](https://dev.mysql.com/doc/refman/5.7/en/replication-gtids-restrictions.html)이 있는지 확인합니다.  
 
## <a name="frequently-asked-questions-faqs"></a>FAQ(질문과 대답)
 
**읽기 또는 쓰기 작업에 대기 복제본을 사용할 수 있나요?** </br>
대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없지만 빠른 장애 조치(failover)를 사용할 수 있는 수동 대기 상태입니다.</br>
**장애 조치(failover)가 발생하면 데이터가 손실되나요?**</br>
ZRS의 로그를 사용하면 기본 서버를 사용할 수 없는 경우에도 로그에 액세스할 수 있으므로 데이터 손실이 없는지 확인하는 데 도움이 됩니다. 대기 복제본이 활성화되고 이진 로그가 적용되면 기본 서버의 역할을 수행합니다. </br>
**사용자가 장애 조치(failover) 후 조치를 취해야 하나요?**</br>
장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 사용자 작업이 필요하지 않습니다. 애플리케이션은 연결에 대한 다시 시도 논리를 구현해야 합니다. </br>
**대기 복제본에 대해 특정 영역을 선택하지 않으면 어떻게 되나요? 나중에 변경할 수 있나요?**</br>
영역을 선택하지 않으면 기본 서버에 사용된 영역이 아닌 다른 영역이 임의로 선택됩니다. 나중에 영역을 변경하려면 고가용성 모드를 사용하지 않도록 설정한 다음 고가용성 블레이드에서 선택한 영역이 있는 영역 중복으로 다시 설정할 수 있습니다.</br>
**기본 복제본과 대기 복제본 간의 복제가 동기식인가요?**</br>
 기본 및 대기 간의 복제 솔루션은 MySQL의 [반 동기 모드](https://dev.mysql.com/doc/refman/5.7/en/replication-semisync.html)와 유사하다고 생각할 수 있습니다. 하나의 트랜잭션이 커밋되면 대기에 커밋할 필요가 없습니다.  그러나 기본을 사용할 수 없는 경우 대기가 기본이 가진 모든 데이터 변경 사항을 복제할 수 있고 데이터 손실이 없도록 할 수 있습니다.</br> 
**계획되지 않은 모든 장애가 발생할 경우 대기 복제본으로 장애 조치(failover)를 취하나요?**</br>
데이터베이스 크래시 또는 노드 장애가 발생하면 유연한 서버 VM이 동일한 노드에서 다시 시작됩니다. 동시에 자동 장애 조치(failover)가 트리거됩니다. 장애 조치(failover)가 완료되기 전에 유연한 서버 VM 재시작에 성공하면 장애 조치(failover) 작업이 취소됩니다. 기본 복제본과 대기 복제본으로 작동할지 결정하는 데 어느 쪽이 시간이 덜 걸리는지에 따라 고려됩니다.</br>
**HA 솔루션을 사용할 때 성능에 영향을 미치나요?**</br>
영역 중복 HA는 네트워크 대기 시간이 긴 가용성 영역에서 애플리케이션이 데이터베이스 서버에 연결하는 경우 대기 시간을 5-10% 떨어뜨릴 수 있습니다.</br> 네트워크 대기 시간이 2~4ms 정도로 상대적으로 높은 경우입니다. 동일 영역 HA의 경우 동일한 영역에 기본 및 대기 복제본이 있으므로 복제 지연이 더 적고 동일한 Azure 가용성 영역 내에 배치되는 경우 애플리케이션 서버와 데이터베이스 서버 사이의 더 짧은 대기 시간을 제공합니다.</br>
**HA 서버의 유지 관리는 어떻게 이루어지나요?**</br>
컴퓨팅 스케일링 및 부 버전 업그레이드와 같은 계획된 이벤트는 주 서버 및 대기 서버 모두에서 동시에 발생합니다. 유연한 서버와 마찬가지로 HA 서버에 대해 [예약된 유지 관리 기간](./concepts-maintenance.md)을 설정할 수 있습니다. HA가 사용하지 않도록 설정된 Azure Database for MySQL 유연한 서버의 가동 중지 시간과 동일한 양의 가동 중지 시간이 발생합니다. 장애 조치(failover) 메커니즘을 사용하여 HA 서버의 가동 중지 시간을 줄이는 것은 로드맵에 있으며 곧 이 기능을 사용할 수 있게 될 것입니다. </br>
**HA 서버의 PITR(특정 시점 복원)을 수행할 수 있나요?**</br>
HA가 사용하도록 설정된 Azure Database for MySQL 유연한 서버에 대한 [PITR](./concepts-backup-restore.md#point-in-time-restore)을 HA가 사용하지 않도록 설정된 Azure Database for MySQL 유연한 서버로 수행할 수 있습니다. 원본 서버가 영역 중복 HA로 만들어진 경우 나중에 복원된 서버에서 영역 중복 HA 또는 동일 영역 HA를 사용하도록 설정할 수 있습니다. 원본 서버가 동일한 영역 HA로 만들어진 경우 복원된 서버에서만 동일한 영역을 사용하도록 설정할 수 있습니다.</br>
**서버가 만들어진 이후 서버에 대해 HA를 사용하도록 설정할 수 있나요?**</br>
서버 생성 후 동일 영역 HA를 사용하도록 설정할 수 있지만 영역 중복 서버 HA 옵션은 생성 시에만 선택할 수 있습니다.</br> 
**서버 생성 이후 HA를 사용하지 않도록 설정할 수 있나요?** </br>
서버를 만든 후 HA를 사용하지 않도록 설정할 수 있으며 청구는 즉시 중지됩니다.  </br>
**가동 중지 시간을 완화하려면 어떻게 해야 하나요?**</br>
HA 기능을 사용하지 않는 경우에도 애플리케이션의 가동 중지 시간을 완화할 수 있어야 합니다. 예약된 패치, 부 버전 업그레이드 또는 사용자가 시작한 작업(예: 크기 조정 컴퓨팅) 등의 서비스 가동 중지 시간을 계획하는 작업은 가동 중지 시간이 발생하므로 예약된 유지 관리 기간의 일부로 수행할 수 있습니다. Azure에서 시작된 유지 관리 작업의 애플리케이션에 대한 영향을 완화하기 위해 애플리케이션에 미치는 영향을 최소화하는 요일 및 시간에 작업을 수행하도록 예약할 수 있습니다.</br>
**HA 지원 서버에 대해 읽기 전용 복제본을 가질 수 있나요?**</br>
현재 HA 지원 서버는 읽기 전용 복제본을 지원하지 않습니다. 그러나 HA 서버용 읽기 전용 복제본은 로드맵에 있으며 이 기능을 곧 사용할 수 있도록 하기 위해 노력하고 있습니다.</br>
**HA 서버에 입력 데이터 복제를 사용할 수 있나요?**</br>
현재 데이터 내부 복제는 HA 서버에 대해 지원되지 않습니다. 그러나 HA 서버에 대한 데이터 내부 복제는 로드맵에 있으며 이 기능을 곧 사용할 수 있도록 노력하고 있습니다. 지금은 마이그레이션을 위해 입력 데이터 복제 기능을 사용하려면 다음 단계를 따르세요.
* 영역 중복 HA가 사용하도록 설정된 서버 만들기
* HA 사용 안 함
* 문서에 따라 [입력 데이터 복제 설정](./concepts-data-in-replication.md)을 수행합니다. GTID_Mode가 원본 서버와 대상 서버에서 동일한 설정인지 확인합니다.
* 중단 후 입력 데이터 복제 제거
* HA 사용

**서버를 다시 시작하거나 가동 중지 시간을 줄이기 위해 스케일 업/스케일 다운하는 동안 대기 서버로 장애 조치(failover)할 수 있나요?** </br>
현재 스케일 업 또는 스케일 다운 작업을 수행할 때 대기와 기본이 동시에 크기 조정되므로 장애 조치(failover)는 도움이 되지 않습니다. 대기를 먼저 스케일 업한 다음 장애 조치(failover) 및 기본을 스케일 업하는 것은 로드맵에 있으나 아직 지원되지 않습니다.</br>


## <a name="next-steps"></a>다음 단계

- [비즈니스 연속성](./concepts-business-continuity.md)에 대한 자세한 정보
- [영역 중복 고가용성](./concepts-high-availability.md)에 대한 자세한 정보
- [백업 및 복구](./concepts-backup-restore.md)에 대한 자세한 정보