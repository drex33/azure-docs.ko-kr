---
title: '빠른 시작: 공용 부하 분산 장치 만들기 - Azure Portal'
titleSuffix: Azure Load Balancer
description: 이 빠른 시작에서는 Azure Portal을 사용하여 부하 분산 장치를 만드는 방법을 보여 줍니다.
services: load-balancer
documentationcenter: na
author: asudbring
manager: KumudD
ms.service: load-balancer
ms.devlang: na
ms.topic: quickstart
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/22/2021
ms.author: allensu
ms.custom: mvc
ms.openlocfilehash: a0952301da222282ff5f1e283a9326328da2715e
ms.sourcegitcommit: afb79a35e687a91270973990ff111ef90634f142
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/14/2021
ms.locfileid: "114289595"
---
# <a name="quickstart-create-a-public-load-balancer-to-load-balance-vms-using-the-azure-portal"></a>빠른 시작: Azure Portal을 사용하여 VM 부하를 분산하는 공용 부하 분산 장치 만들기

Azure Portal에서 Azure Load Balancer를 시작하여 공용 부하 분산 장치와 세 개의 가상 머신을 만듭니다.

## <a name="prerequisites"></a>필수 구성 요소

- 활성 구독이 있는 Azure 계정. [체험 계정을 만듭니다](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).

## <a name="sign-in-to-azure"></a>Azure에 로그인

[https://portal.azure.com](https://portal.azure.com)에서 Azure Portal에 로그인합니다.

---

# <a name="standard-sku"></a>[**표준 SKU**](#tab/option-1-create-load-balancer-standard)

>[!NOTE]
>표준 SKU 부하 분산 장치는 프로덕션 워크로드에 추천됩니다.  SKU에 대한 자세한 내용은 **[Azure Load Balancer SKU](skus.md)** 를 참조하세요.

:::image type="content" source="./media/quickstart-load-balancer-standard-public-portal/resources-diagram.png" alt-text="빠른 시작을 위해 만든 표준 부하 분산 장치 리소스." border="false":::

*그림: 빠른 시작에서 만든 리소스.*

이 섹션에서는 가상 머신의 부하를 분산하는 부하 분산 장치를 만듭니다. 

공용 부하 분산 장치를 만드는 경우 부하 분산 장치의 프런트 엔드(기본적으로 이름이 **LoadBalancerFrontend** 임)로 구성된 새 공용 IP 주소를 만듭니다.

1. **리소스 만들기** 를 선택합니다. 
2. 검색 상자에 **부하 분산 장치** 를 입력합니다. 검색 결과에서 **부하 분산 장치** 를 선택합니다.
3. **부하 분산 장치** 페이지에서 **만들기** 를 선택합니다.
4. **부하 분산 장치 만들기** 페이지에서 다음 정보를 입력하거나 선택합니다. 

    | 설정                 | 값                                              |
    | ---                     | ---                                                |
    | Subscription               | 구독을 선택합니다.    |    
    | Resource group         | **새로 만들기** 를 선택하고 텍스트 상자에 **CreatePubLBQS-rg** 를 입력합니다.|
    | Name                   | **myLoadBalancer** 를 입력합니다.                                   |
    | 지역         | **(유럽) 서유럽** 을 선택합니다.                                        |
    | Type          | **공용** 을 선택합니다.                                        |
    | SKU           | 기본값인 **표준** 을 그대로 둡니다. |
    | 계층          | 기본 **지역** 을 그대로 둡니다. |
    | 공용 IP 주소 | **새로 만들기** 를 선택합니다. 사용하려는 기존 공용 IP가 있는 경우 **기존 항목 사용** 을 선택합니다. |
    | 공용 IP 주소 이름 | 텍스트 상자에 **myPublicIP** 를 입력합니다.|
    | 가용성 영역 | **영역 중복** 을 선택하여 복원력 있는 부하 분산 장치를 만듭니다. 영역 부하 분산 장치를 만들려면 1, 2 또는 3에서 특정 영역을 선택합니다. |
    | 공용 IPv6 주소 추가 | **아니오** 를 선택합니다. </br> IPv6 주소 및 부하 분산 장치에 대한 자세한 내용은 [Azure Virtual Network용 IPv6이란?](../virtual-network/ipv6-overview.md)을 참조하세요.  |
    | 라우팅 기본 설정 | **Microsoft 네트워크** 의 기본값을 그대로 둡니다. </br> 라우팅 기본 설정에 대한 자세한 내용은 [라우팅 기본 설정(미리 보기)이란?](../virtual-network/routing-preference-overview.md)을 참조하세요. |

5. 나머지 설정에는 기본값을 적용한 다음, **검토 + 만들기** 를 선택합니다.

6. **검토 + 만들기** 탭에서 **만들기** 를 선택합니다.   
    
    :::image type="content" source="./media/quickstart-load-balancer-standard-public-portal/create-standard-load-balancer.png" alt-text="표준 부하 분산 장치 만들기" border="true":::
 
## <a name="create-load-balancer-resources"></a>부하 분산 장치 리소스 만들기

이 섹션에서는 다음을 구성합니다.

* 백 엔드 주소 풀에 대한 부하 분산 장치 설정
* 상태 프로브
* 부하 분산 장치 규칙

### <a name="create-a-backend-pool"></a>백 엔드 풀 만들기

백 엔드 주소 풀에는 부하 분산 장치에 연결된 가상(NIC)의 IP 주소가 포함됩니다. 

인터넷 트래픽의 부하를 분산하기 위한 가상 머신을 포함할 백 엔드 주소 풀 **myBackendPool** 을 만듭니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 에서 **백 엔드 풀** 을 선택한 다음, **추가** 를 선택합니다.

3. **백 엔드 풀 추가** 페이지에서 이름에 백 엔드 풀의 이름인 **myBackEndPool** 을 입력한 후 **추가** 를 선택합니다.

### <a name="create-a-health-probe"></a>상태 프로브 만들기

부하 분산 장치는 상태 프로브를 사용하여 앱의 상태를 모니터링합니다. 

상태 프로브는 상태 검사의 응답에 따라 부하 분산 장치에서 VM을 추가하거나 제거합니다. 

VM 상태를 모니터링할 **myHealthProbe** 라는 상태 프로브를 만듭니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 에서 **상태 프로브** 를 선택한 다음, **추가** 를 선택합니다.
    
    | 설정 | 값 |
    | ------- | ----- |
    | 속성 | **myHealthProbe** 를 입력합니다. |
    | 프로토콜 | **HTTP** 를 선택합니다. |
    | 포트 | **80** 을 입력합니다.|
    | 간격 | 프로브 시도 **간격**(초)으로 **15** 를 입력합니다. |
    | 비정상 임계값 | **비정상 임계값** 또는 VM이 비정상 상태로 간주되는 데 필요한 연속 프로브 오류 횟수로 **2** 를 선택합니다.|
    | | |

3. 나머지는 기본값으로 두고 **확인** 을 선택합니다.

### <a name="create-a-load-balancer-rule"></a>부하 분산 장치 규칙 만들기

부하 분산 장치 규칙은 VM으로 트래픽이 분산되는 방법을 정의하는 데 사용됩니다. 들어오는 트래픽에 대한 프런트 엔드 IP 구성 및 트래픽을 받는 백 엔드 IP 풀을 정의합니다. 원본 및 대상 포트는 규칙에 정의됩니다. 

이 섹션에서 만드는 부하 분산 장치 규칙은 다음과 같습니다.

* 이름은 **myHTTPRule** 입니다.
* 프런트 엔드에서 이름은 **LoadBalancerFrontEnd** 입니다.
* **포트 80** 에서 수신 대기합니다.
* 부하 분산된 트래픽을 **포트 80** 에서 **myBackendPool** 이라는 백 엔드로 보냅니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 아래에서 **부하 분산 규칙** 을 선택한 다음, **추가** 를 선택합니다.

3. 다음 값을 사용하여 부하 분산 규칙을 구성합니다.
    
    | 설정 | 값 |
    | ------- | ----- |
    | 속성 | **myHTTPRule** 을 입력합니다. |
    | IP 버전 | **IPv4** 를 선택합니다. |
    | 프런트 엔드 IP 주소 | **LoadBalancerFrontEnd** 를 입력합니다. |
    | 프로토콜 | **TCP** 를 선택합니다. |
    | 포트 | **80** 을 입력합니다.|
    | 백 엔드 포트 | **80** 을 입력합니다. |
    | 백 엔드 풀 | **myBackendPool** 을 선택합니다.|
    | 상태 프로브 | **myHealthProbe** 를 선택합니다. |
    | 유휴 제한 시간(분) | 슬라이더를 **15분** 으로 이동합니다. |
    | TCP 재설정 | **사용** 을 선택합니다. |
    | 아웃바운드 SNAT(Source Network Address Translation) | **(권장) 아웃바운드 규칙을 사용하여 백 엔드 풀 멤버에 인터넷 액세스 권한 제공** 을 선택합니다. |

4. 나머지는 기본값으로 둔 다음, **확인** 을 선택합니다.

## <a name="create-backend-servers"></a>백 엔드 서버 만들기

이 섹션에서는 다음을 수행합니다.

* 가상 네트워크를 만듭니다.
* 부하 분산 장치의 백 엔드 풀에 대해 세 개의 가상 머신을 만듭니다.
* 가상 머신에 IIS를 설치하여 부하 분산 장치를 테스트합니다.

## <a name="create-the-virtual-network"></a>가상 네트워크 만들기

이 섹션에서는 가상 네트워크 및 서브넷을 만듭니다.

1. 화면의 왼쪽 위에서 **리소스 만들기 > 네트워킹 > 가상 네트워크** 를 차례로 선택하거나, 검색 상자에서 **가상 네트워크** 를 검색합니다.

2. **가상 네트워크 만들기** 의 **기본** 탭에서 다음 정보를 입력하거나 선택합니다.

    | **설정**          | **값**                                                           |
    |------------------|-----------------------------------------------------------------|
    | **프로젝트 세부 정보**  |                                                                 |
    | Subscription     | Azure 구독 선택                                  |
    | 리소스 그룹   | **CreatePubLBQS-rg** 선택 |
    | **인스턴스 세부 정보** |                                                                 |
    | 속성             | **myVNet** 입력                                    |
    | 지역           | **서유럽** 을 선택합니다. |

3. **IP 주소** 탭을 선택하거나 페이지 하단의 **다음: IP 주소** 단추를 선택합니다.

4. **IP 주소** 탭에서 다음 정보를 입력합니다.

    | 설정            | 값                      |
    |--------------------|----------------------------|
    | IPv4 주소 공간 | **10.1.0.0/16** 입력 |

5. **서브넷 이름** 아래에서 **기본값** 이라는 단어를 선택합니다.

6. **서브넷 편집** 에서 다음 정보를 입력합니다.

    | 설정            | 값                      |
    |--------------------|----------------------------|
    | 서브넷 이름 | **myBackendSubnet** 입력 |
    | 서브넷 주소 범위 | **10.1.0.0/24** 입력 |

7. **저장** 을 선택합니다.

8. **보안** 탭을 선택합니다.

9. **BastionHost** 에서 **사용** 을 선택합니다. 다음 정보를 입력합니다.

    | 설정            | 값                      |
    |--------------------|----------------------------|
    | Bastion 이름 | **myBastionHost** 입력 |
    | AzureBastionSubnet 주소 공간 | **10.1.1.0/24** 입력 |
    | 공용 IP 주소 | **새로 만들기** 를 선택합니다. </br> **이름** 에 대해 **myBastionIP** 를 입력합니다. </br> **확인** 을 선택합니다. |


8. **검토 + 만들기** 탭을 선택하거나 **검토 + 만들기** 단추를 선택합니다.

9. **만들기** 를 선택합니다.

### <a name="create-virtual-machines"></a>가상 머신 만들기

이 섹션에서는 세 개의 다른 영역(**영역 1**, **영역 2** 및 **영역 3**)에서 세 개의 VM(**myVM1**, **myVM2** 및 **myVM3**)을 만듭니다. 

이러한 VM은 이전에 만든 부하 분산 장치의 백 엔드 풀에 추가됩니다.

1. 포털의 왼쪽 위에서 **리소스 만들기** > **컴퓨팅** > **가상 머신** 을 차례로 선택합니다. 
   
2. **가상 머신 만들기** 의 **기본** 탭에서 값을 입력하거나 선택합니다.

    | 설정 | 값                                          |
    |-----------------------|----------------------------------|
    | **프로젝트 세부 정보** |  |
    | Subscription | Azure 구독 선택 |
    | 리소스 그룹 | **CreatePubLBQS-rg** 선택 |
    | **인스턴스 세부 정보** |  |
    | 가상 머신 이름 | **myVM1** 을 입력합니다. |
    | 지역 | **서유럽** 을 선택합니다. |
    | 가용성 옵션 | **가용성 영역** 을 선택합니다. |
    | 가용성 영역 | **1** 을 선택합니다. |
    | 이미지 | **Windows Server 2019 Datacenter** 를 선택합니다. |
    | Azure Spot 인스턴스 | **아니요** 를 선택합니다. |
    | 크기 | VM 크기를 선택하거나 기본 설정을 사용합니다. |
    | **관리자 계정** |  |
    | 사용자 이름 | 사용자 이름을 입력합니다. |
    | 암호 | 암호를 입력합니다. |
    | 암호 확인 | 암호를 다시 입력합니다. |
    | **인바운드 포트 규칙** |  |
    | 공용 인바운드 포트 | **없음** 을 선택합니다. |

3. **네트워킹** 탭을 선택하거나 **다음: 디스크**, **다음: 네트워킹** 을 차례로 선택합니다.
  
4. [네트워킹] 탭에서 다음을 선택하거나 입력합니다.

    | 설정 | 값 |
    |-|-|
    | **네트워크 인터페이스** |  |
    | 가상 네트워크 | **myVNet** |
    | 서브넷 | **myBackendSubnet** |
    | 공용 IP | **없음** 을 선택합니다. |
    | NIC 네트워크 보안 그룹 추가 | **고급** 을 선택합니다.|
    | 네트워크 보안 그룹 구성 | **새로 만들기** 를 선택합니다. </br> **네트워크 보안 그룹 만들기** 의 **이름** 에서 **myNSG** 를 입력합니다. </br> **인바운드 규칙** 아래에서 **+ 인바운드 규칙 추가** 를 선택합니다. </br> **대상 포트 범위** 아래에서 **80** 을 입력합니다. </br> **우선 순위** 아래에서 **100** 을 입력합니다. </br> **이름** 에서 **myHTTPRule** 을 입력합니다. </br> **추가** 를 선택합니다. </br> **확인** 을 선택합니다. |
    | **부하 분산**.  |
    | 기존 부하 분산 솔루션 뒤에 이 가상 머신을 배치하시겠습니까? | **예** 를 선택합니다. |
    | **부하 분산 설정** |
    | 부하 분산 옵션 | **Azure 부하 분산** 을 선택합니다. |
    | 부하 분산 장치 선택 | **myLoadBalancer** 를 선택합니다.  |
    | 백 엔드 풀 선택 | **myBackendPool** 을 선택합니다. |

5. **관리** 탭을 선택하거나 **다음** > **관리** 를 선택합니다.

6. **관리** 탭에서 다음을 선택하거나 입력합니다.
    
    | 설정 | 값 |
    |-|-|
    | **Monitoring** |  |
    | 부트 진단 | **끄기** 를 선택합니다. |
   
7. **검토 + 만들기** 를 선택합니다. 
  
8. 설정을 검토한 다음, **만들기** 를 선택합니다.

9. 1 ~ 8단계에 따라 다음 값 및 **myVM1** 과 동일한 다른 모든 설정을 사용하여 두 개의 추가 VM을 만듭니다.

    | 설정 | VM 2| VM 3|
    | ------- | ----- |---|
    | Name |  **myVM2** |**myVM3**|
    | 가용성 영역 | **2** |**3**|
    | 네트워크 보안 그룹 | 기존 **myNSG** 를 선택합니다.| 기존 **myNSG** 를 선택합니다.|

[!INCLUDE [ephemeral-ip-note.md](../../includes/ephemeral-ip-note.md)]

## <a name="create-outbound-rule-configuration"></a>아웃바운드 규칙 구성 만들기
부하 분산 디바이스 아웃바운드 규칙은 백 엔드 풀의 VM에 대한 아웃바운드 SNAT를 구성합니다. 

아웃바운드 연결에 대한 자세한 내용은 [Azure의 아웃바운드 연결](load-balancer-outbound-connections.md)을 참조하세요.

### <a name="create-outbound-rule"></a>아웃바운드 규칙 만들기

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 아래에서 **아웃바운드 규칙** 을 선택한 다음 **추가** 를 선택합니다.

3. 다음 값을 사용하여 아웃바운드 규칙을 구성합니다.

    | 설정 | 값 |
    | ------- | ----- |
    | 이름 | **myOutboundRule** 을 입력합니다. |
    | 프런트 엔드 IP 주소 | **새로 만들기** 를 선택합니다. </br> **이름** 에 **LoadBalancerFrontEndOutbound** 를 입력합니다. </br> **IP 주소** 또는 **IP 접두사** 를 선택합니다. </br> **공용 IP 주소** 또는 **공용 IP 접두사** 에서 **새로 만들기** 를 선택합니다. </br> 이름에 **myPublicIPOutbound** 또는 **myPublicIPPrefixOutbound** 를 입력합니다. </br> **추가** 를 선택합니다.|
    | 유휴 제한 시간(분) | 슬라이더를 **15분** 으로 이동합니다.|
    | TCP 재설정 | **사용** 을 선택합니다.|
    | 백 엔드 풀 | **새로 만들기** 를 선택합니다. </br> **이름** 에 **myBackendPoolOutbound** 를 입력합니다. </br> **추가** 를 선택합니다. |
    | 포트 할당 -> 포트 할당 | **아웃바운드 포트 수 수동 선택** 선택 |
    | 아웃바운드 포트 -> 선택 기준 | **인스턴스당 포트 수** 선택 |
    | 아웃바운드 포트 -> 인스턴스당 포트 수 | **10000** 을 입력합니다. |

4. **추가** 를 선택합니다.

### <a name="add-virtual-machines-to-outbound-pool"></a>아웃바운드 풀에 가상 머신 추가

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 에서 **백 엔드 풀** 을 선택합니다.

3. **myBackendPoolOutbound** 를 선택합니다.

4. **가상 네트워크** 에서 **myVNet** 을 선택합니다.

5. **가상 머신** 에서 **추가** 를 선택합니다.

6. **myVM1**, **myVM2** 및 **myVM3** 옆에 있는 확인란을 선택합니다. 

7. **추가** 를 선택합니다.

8. **저장** 을 선택합니다.

# <a name="basic-sku"></a>[**기본 SKU**](#tab/option-1-create-load-balancer-basic)

>[!NOTE]
>표준 SKU 부하 분산 장치는 프로덕션 워크로드에 추천됩니다.  SKU에 대한 자세한 내용은 **[Azure Load Balancer SKU](skus.md)** 를 참조하세요.

:::image type="content" source="./media/quickstart-load-balancer-standard-public-portal/resources-diagram-basic.png" alt-text="빠른 시작에서 만든 기본 부하 분산 장치 리소스." border="false":::

*그림: 빠른 시작에서 만든 리소스.*

이 섹션에서는 가상 머신의 부하를 분산하는 부하 분산 장치를 만듭니다. 

공용 부하 분산 장치를 만드는 경우 부하 분산 장치의 프런트 엔드(기본적으로 이름이 **LoadBalancerFrontend** 임)로 구성된 새 공용 IP 주소를 만듭니다.

1. **리소스 만들기** 를 선택합니다. 
2. 검색 상자에 **부하 분산 장치** 를 입력합니다. 검색 결과에서 **부하 분산 장치** 를 선택합니다.
3. **부하 분산 장치** 페이지에서 **만들기** 를 선택합니다.
4. **부하 분산 장치 만들기** 페이지에서 다음 정보를 입력하거나 선택합니다. 

    | 설정                 | 값                                              |
    | ---                     | ---                                                |
    | Subscription               | 구독을 선택합니다.    |    
    | Resource group         | **새로 만들기** 를 선택하고 텍스트 상자에 **CreatePubLBQS-rg** 를 입력합니다.|
    | Name                   | **myLoadBalancer** 를 입력합니다.                                   |
    | 지역         | **서유럽** 를 선택합니다.                                        |
    | Type          | **공용** 을 선택합니다.                                        |
    | SKU           | **기본** 을 선택합니다. |
    | 공용 IP 주소 | **새로 만들기** 를 선택합니다. 사용하려는 기존 공용 IP가 있는 경우 **기존 항목 사용** 을 선택합니다. |
    | 공용 IP 주소 이름 | 텍스트 상자에 **myPublicIP** 를 입력합니다.|
    | 할당 | **동적** 을 선택합니다. |
    | 공용 IPv6 주소 추가 | **아니오** 를 선택합니다. </br> IPv6 주소 및 부하 분산 장치에 대한 자세한 내용은 [Azure Virtual Network용 IPv6이란?](../virtual-network/ipv6-overview.md)을 참조하세요.  |

5. 나머지 설정에는 기본값을 적용한 다음, **검토 + 만들기** 를 선택합니다.

6. **검토 + 만들기** 탭에서 **만들기** 를 선택합니다.   

    :::image type="content" source="./media/quickstart-load-balancer-standard-public-portal/create-basic-load-balancer.png" alt-text="기본 부하 분산 장치 만들기" border="true":::

## <a name="create-load-balancer-resources"></a>부하 분산 장치 리소스 만들기

이 섹션에서는 다음을 구성합니다.

* 가상 네트워크를 만듭니다.
* 백 엔드 주소 풀에 대한 부하 분산 장치 설정
* 상태 프로브
* 부하 분산 장치 규칙

## <a name="create-the-virtual-network"></a>가상 네트워크 만들기

이 섹션에서는 가상 네트워크 및 서브넷을 만듭니다.

1. 화면의 왼쪽 위에서 **리소스 만들기 > 네트워킹 > 가상 네트워크** 를 차례로 선택하거나, 검색 상자에서 **가상 네트워크** 를 검색합니다.

2. **가상 네트워크 만들기** 의 **기본** 탭에서 다음 정보를 입력하거나 선택합니다.

    | **설정**          | **값**                                                           |
    |------------------|-----------------------------------------------------------------|
    | **프로젝트 세부 정보**  |                                                                 |
    | Subscription     | Azure 구독 선택                                  |
    | 리소스 그룹   | **CreatePubLBQS-rg** 선택 |
    | **인스턴스 세부 정보** |                                                                 |
    | 속성             | **myVNet** 입력                                    |
    | 지역           | **서유럽** 을 선택합니다. |

3. **IP 주소** 탭을 선택하거나 페이지 하단의 **다음: IP 주소** 단추를 선택합니다.

4. **IP 주소** 탭에서 다음 정보를 입력합니다.

    | 설정            | 값                      |
    |--------------------|----------------------------|
    | IPv4 주소 공간 | **10.1.0.0/16** 입력 |

5. **서브넷 이름** 아래에서 **기본값** 이라는 단어를 선택합니다.

6. **서브넷 편집** 에서 다음 정보를 입력합니다.

    | 설정            | 값                      |
    |--------------------|----------------------------|
    | 서브넷 이름 | **myBackendSubnet** 입력 |
    | 서브넷 주소 범위 | **10.1.0.0/24** 입력 |

7. **저장** 을 선택합니다.

8. **보안** 탭을 선택합니다.

9. **BastionHost** 에서 **사용** 을 선택합니다. 다음 정보를 입력합니다.

    | 설정            | 값                      |
    |--------------------|----------------------------|
    | Bastion 이름 | **myBastionHost** 입력 |
    | AzureBastionSubnet 주소 공간 | **10.1.1.0/24** 입력 |
    | 공용 IP 주소 | **새로 만들기** 를 선택합니다. </br> **이름** 에 대해 **myBastionIP** 를 입력합니다. </br> **확인** 을 선택합니다. |


8. **검토 + 만들기** 탭을 선택하거나 **검토 + 만들기** 단추를 선택합니다.

9. **만들기** 를 선택합니다.
### <a name="create-a-backend-pool"></a>백 엔드 풀 만들기

백 엔드 주소 풀에는 부하 분산 장치에 연결된 가상(NIC)의 IP 주소가 포함됩니다. 

인터넷 트래픽의 부하를 분산하기 위한 가상 머신을 포함할 백 엔드 주소 풀 **myBackendPool** 을 만듭니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 에서 **백 엔드 풀** 을 선택한 다음, **추가** 를 선택합니다.

3. **백 엔드 풀 추가** 페이지에서 다음을 입력하거나 선택합니다.
    
    | Setting | 값 |
    | ------- | ----- |
    | 이름 | **myBackendPool** 을 입력합니다. |
    | 가상 네트워크 | **myVNet** 을 선택합니다. |
    | 다음에 연결됨 | **가상 머신** 을 선택합니다. |

### <a name="create-a-health-probe"></a>상태 프로브 만들기

부하 분산 장치는 상태 프로브를 사용하여 앱의 상태를 모니터링합니다. 

상태 프로브는 상태 검사의 응답에 따라 부하 분산 장치에서 VM을 추가하거나 제거합니다. 

VM 상태를 모니터링할 **myHealthProbe** 라는 상태 프로브를 만듭니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 에서 **상태 프로브** 를 선택한 다음, **추가** 를 선택합니다.
    
    | 설정 | 값 |
    | ------- | ----- |
    | 속성 | **myHealthProbe** 를 입력합니다. |
    | 프로토콜 | **HTTP** 를 선택합니다. |
    | 포트 | **80** 을 입력합니다.|
    | 경로 | **/** 를 입력합니다. |
    | 간격 | 프로브 시도 **간격**(초)으로 **15** 를 입력합니다. |
    | 비정상 임계값 | **비정상 임계값** 또는 VM이 비정상 상태로 간주되는 데 필요한 연속 프로브 오류 횟수로 **2** 를 선택합니다.|

3. **확인** 을 선택합니다.

### <a name="create-a-load-balancer-rule"></a>부하 분산 장치 규칙 만들기

부하 분산 장치 규칙은 VM으로 트래픽이 분산되는 방법을 정의하는 데 사용됩니다. 들어오는 트래픽에 대한 프런트 엔드 IP 구성 및 트래픽을 받는 백 엔드 IP 풀을 정의합니다. 원본 및 대상 포트는 규칙에 정의됩니다. 

이 섹션에서 만드는 부하 분산 장치 규칙은 다음과 같습니다.

* 이름은 **myHTTPRule** 입니다.
* 프런트 엔드에서 이름은 **LoadBalancerFrontEnd** 입니다.
* **포트 80** 에서 수신 대기합니다.
* 부하 분산된 트래픽을 **포트 80** 에서 **myBackendPool** 이라는 백 엔드로 보냅니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 아래에서 **부하 분산 규칙** 을 선택한 다음, **추가** 를 선택합니다.

3. 다음 값을 사용하여 부하 분산 규칙을 구성합니다.
    
    | 설정 | 값 |
    | ------- | ----- |
    | 속성 | **myHTTPRule** 을 입력합니다. |
    | IP 버전 | **IPv4** 를 선택합니다. |
    | 프런트 엔드 IP 주소 | **LoadBalancerFrontEnd** 를 입력합니다. |
    | 프로토콜 | **TCP** 를 선택합니다. |
    | 포트 | **80** 을 입력합니다.|
    | 백 엔드 포트 | **80** 을 입력합니다. |
    | 백 엔드 풀 | **myBackendPool** 을 선택합니다.|
    | 상태 프로브 | **myHealthProbe** 를 선택합니다. |
    | 유휴 제한 시간(분) | 슬라이더를 **15분** 으로 이동합니다. |
 
4. 나머지는 기본값으로 둔 다음, **확인** 을 선택합니다.

## <a name="create-backend-servers"></a>백 엔드 서버 만들기

이 섹션에서는 다음을 수행합니다.

* 부하 분산 장치의 백 엔드 풀에 대해 세 개의 가상 머신을 만듭니다.
* 가상 머신에 대한 가용성 집합을 만듭니다.
* 가상 머신에 IIS를 설치하여 부하 분산 장치를 테스트합니다.

### <a name="create-virtual-machines"></a>가상 머신 만들기

이 섹션에서는 기본 공용 IP 주소를 사용하여 세 개의 VM(**myVM1**, **myVM2** 및 **myVM3**)을 만듭니다.  

세 개의 VM이 **myAvailabilitySet** 이라는 가용성 집합에 추가됩니다.

이러한 VM은 이전에 만든 부하 분산 장치의 백 엔드 풀에 추가됩니다.

1. 포털의 왼쪽 위에서 **리소스 만들기** > **컴퓨팅** > **가상 머신** 을 차례로 선택합니다. 
   
2. **가상 머신 만들기** 의 **기본** 탭에서 값을 입력하거나 선택합니다.

    | 설정 | 값                                          |
    |-----------------------|----------------------------------|
    | **프로젝트 세부 정보** |  |
    | Subscription | Azure 구독 선택 |
    | 리소스 그룹 | **CreatePubLBQS-rg** 선택 |
    | **인스턴스 세부 정보** |  |
    | 가상 머신 이름 | **myVM1** 을 입력합니다. |
    | 지역 | **서유럽** 을 선택합니다. |
    | 가용성 옵션 | **가용성 집합** 을 선택합니다. |
    | 가용성 집합 | **새로 만들기** 를 선택합니다. </br> **이름** 에서 **myAvailabilitySet** 을 입력합니다. </br> **확인** 을 선택합니다. |
    | 이미지 | **Windows Server 2019 Datacenter** |
    | Azure Spot 인스턴스 | **아니요** 를 선택합니다. |
    | 크기 | VM 크기를 선택하거나 기본 설정을 사용합니다. |
    | **관리자 계정** |  |
    | 사용자 이름 | 사용자 이름을 입력합니다. |
    | 암호 | 암호를 입력합니다. |
    | 암호 확인 | 암호를 다시 입력합니다. |

3. **네트워킹** 탭을 선택하거나 **다음: 디스크**, **다음: 네트워킹** 을 차례로 선택합니다.
  
4. [네트워킹] 탭에서 다음을 선택하거나 입력합니다.

    | 설정 | 값 |
    |-|-|
    | **네트워크 인터페이스** |  |
    | 가상 네트워크 | **myVNet** 을 선택합니다. |
    | 서브넷 | **myBackendSubnet** 선택 |
    | 공용 IP | **없음** 을 선택합니다. |
    | NIC 네트워크 보안 그룹 추가 | **고급** 을 선택합니다.|
    | 네트워크 보안 그룹 구성 | **새로 만들기** 를 선택합니다. </br> **네트워크 보안 그룹 만들기** 의 **이름** 에서 **myNSG** 를 입력합니다. </br> **인바운드 규칙** 아래에서 **+ 인바운드 규칙 추가** 를 선택합니다. </br> **대상 포트 범위** 아래에서 **80** 을 입력합니다. </br> **우선 순위** 아래에서 **100** 을 입력합니다. </br> **이름** 에서 **myHTTPRule** 을 입력합니다. </br> **추가** 를 선택합니다. </br> **확인** 을 선택합니다. |
    | **부하 분산**.  |
    | 기존 부하 분산 솔루션 뒤에 이 가상 머신을 배치하시겠습니까? | **아니요** 를 선택합니다. |
 
5. **관리** 탭을 선택하거나 **다음** > **관리** 를 선택합니다.

6. **관리** 탭에서 다음을 선택하거나 입력합니다.
    
    | 설정 | 값 |
    |---|---|
    | **Monitoring** | |
    | 부트 진단 | **끄기** 를 선택합니다. |

7. **검토 + 만들기** 를 선택합니다. 
  
8. 설정을 검토한 다음, **만들기** 를 선택합니다.

9. 1 ~ 8단계에 따라 다음 값 및 **myVM1** 과 동일한 다른 모든 설정을 사용하여 두 개의 추가 VM을 만듭니다.

    | 설정 | VM 2| VM 3|
    | ------- | ----- |---|
    | Name |  **myVM2** |**myVM3**|
    | 가용성 집합| **myAvailabilitySet** 을 선택합니다. | **myAvailabilitySet** 을 선택합니다.|
    | 네트워크 보안 그룹 | 기존 **myNSG** 를 선택합니다.| 기존 **myNSG** 를 선택합니다.|

[!INCLUDE [ephemeral-ip-note.md](../../includes/ephemeral-ip-note.md)]

### <a name="add-virtual-machines-to-the-backend-pool"></a>백 엔드 풀에 가상 머신 추가

이전 단계에서 만든 VM은 **myLoadBalancer** 의 백 엔드 풀에 추가해야 합니다.

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **myLoadBalancer** 를 선택합니다.

2. **설정** 에서 **백 엔드 풀** 을 선택한 다음, **myBackendPool** 을 선택합니다.

3. **다음에 연결됨** 에서 **가상 머신** 을 선택합니다.

4. **가상 머신** 섹션에서 **+ 추가** 를 선택합니다.

5. **myVM1**, **myVM2** 및 **myVM3** 옆에 있는 확인란을 선택합니다.

6. **추가** 를 선택합니다.

7. **저장** 을 선택합니다.

---

## <a name="install-iis"></a>IIS 설치

1. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, 리소스 목록에서 **CreatePubLBQS-rg** 리소스 그룹에 있는 **myVM1** 을 선택합니다.

2. **개요** 페이지에서 **연결** 을 선택한 다음, **Bastion** 을 선택합니다.

4. VM을 만드는 동안 입력한 사용자 이름과 암호를 입력합니다.

5. **연결** 을 선택합니다.

6. 서버 바탕 화면에서 **Windows 관리 도구** > **Windows PowerShell** 로 이동합니다.

7. PowerShell 창에서 아래 명령을 실행하여 다음을 수행합니다.

    * IIS 서버를 설치합니다.
    * 기본 iisstart.htm 파일을 제거합니다.
    * VM 이름을 표시하는 새 iisstart.htm 파일을 추가합니다.

   ```powershell
    
    # install IIS server role
    Install-WindowsFeature -name Web-Server -IncludeManagementTools
    
    # remove default htm file
     remove-item  C:\inetpub\wwwroot\iisstart.htm
    
    # Add a new htm file that displays server name
     Add-Content -Path "C:\inetpub\wwwroot\iisstart.htm" -Value $("Hello World from " + $env:computername)
   ```
8. **myVM1** 이 포함된 Bastion 세션을 닫습니다.

9. 1~6단계를 반복하여 **myVM2** 및 **myVM3** 에 IIS 및 업데이트된 iisstart.htm 파일을 설치합니다.

## <a name="test-the-load-balancer"></a>부하 분산 장치 테스트

1. **개요** 화면에서 부하 분산 장치의 공용 IP 주소를 찾습니다. 왼쪽 메뉴에서 **모든 서비스** 를 선택하고 **모든 리소스** 를 선택한 다음, **myPublicIP** 를 선택합니다.

2. 공용 IP 주소를 복사하여 브라우저의 주소 표시줄에 붙여넣습니다. IIS 웹 서버의 기본 페이지가 브라우저에 표시됩니다.

   ![IIS 웹 서버](./media/tutorial-load-balancer-standard-zonal-portal/load-balancer-test.png)

세 개의 VM 모두에서 부하 분산 장치 분산 트래픽을 확인하려면 각 VM의 IIS 웹 서버의 기본 페이지를 사용자 지정한 다음, 클라이언트 컴퓨터에서 웹 브라우저를 강제로 새로 고칠 수 있습니다.

## <a name="clean-up-resources"></a>리소스 정리

더 이상 필요하지 않은 경우 리소스 그룹, 부하 분산 장치 및 모든 관련 리소스를 삭제합니다. 이렇게 하려면 리소스가 포함된 **CreatePubLBQS-rg** 리소스 그룹을 선택한 다음, **삭제** 를 선택합니다.

## <a name="next-steps"></a>다음 단계

이 빠른 시작에서 관련 정보는 다음과 같습니다.

* Azure 표준 또는 기본 Load Balancer를 만들었습니다.
* 세 개의 VM을 부하 분산 장치에 연결했습니다.
* 부하 분산 장치 트래픽 규칙, 상태 프로브를 구성한 다음, 부하 분산 장치를 테스트했습니다. 

Azure Load Balancer에 대해 자세히 알아보려면 계속 진행하세요.
> [!div class="nextstepaction"]
> [Azure Load Balancer란?](load-balancer-overview.md)