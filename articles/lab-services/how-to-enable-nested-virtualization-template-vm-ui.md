---
title: Azure Lab Services의 템플릿 VM에서 중첩된 가상화 사용(UI) | Microsoft Docs
description: 여러 VM이 들어 있는 템플릿 VM을 만드는 방법  즉, Azure Lab Services의 템플릿 VM에서 중첩된 가상화를 사용하는 방법을 알아봅니다.
author: emaher
ms.topic: article
ms.date: 06/26/2020
ms.author: enewman
ms.openlocfilehash: f8135e11fb7b7ddb588ab3a8ed01227712072fd2
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/29/2021
ms.locfileid: "94647922"
---
# <a name="enable-nested-virtualization-on-a-template-virtual-machine-in-azure-lab-services-manually"></a>수동으로 Azure Lab Services의 템플릿 가상 머신에서 중첩된 가상화 사용

중첩된 가상화를 사용하면 랩의 템플릿 가상 머신 내에 다중 VM 환경을 만들 수 있습니다. 템플릿을 게시하면 랩의 각 사용자에게 여러 개의 VM이 설정된 가상 머신이 제공됩니다.  중첩된 가상화 및 Azure Lab Services에 대한 자세한 내용은 [Azure Lab Services의 템플릿 가상 머신에서 중첩된 가상화 사용](how-to-enable-nested-virtualization-template-vm.md)을 참조하세요.

이 문서에서는 Windows 역할 및 도구를 직접 사용하여 Azure Lab Services의 템플릿 머신에서 중첩된 가상화를 설정하는 방법을 다룹니다.  클래스에서 중첩된 가상화를 사용하는 데 필요한 몇 가지 작업이 있습니다.  아래 단계에서는 Hyper-V를 사용하여 Lab Services 머신 템플릿을 수동으로 설정하는 방법을 설명합니다.  이 단계는 Windows Server 2016 또는 Windows Server 2019를 위해 작성되었습니다.  

>[!IMPORTANT]
>새 랩을 만들 때 가상 머신 크기로 **대형(중첩된 가상화)** 또는 **중간(중첩된 가상화)** 을 선택합니다.  그렇지 않으면 중첩된 가상화가 작동하지 않습니다.  

## <a name="enable-hyper-v-role"></a>Hyper-V 역할 사용

다음 단계에서는 서버 관리자를 사용하여 Windows Server에서 Hyper-V를 사용하도록 설정하는 데 필요한 작업을 설명합니다.  설치가 완료되면 Hyper-V 관리자가 클라이언트 가상 머신을 추가, 수정 및 삭제할 수 있습니다.

1. **서버 관리자** 의 대시보드 페이지에서 **역할 및 기능 추가** 를 클릭합니다.
2. **시작하기 전** 페이지에서 **다음** 을 클릭합니다.
3. **설치 유형 선택** 페이지에서 역할 기반 또는 기능 기반 설치의 기본 선택을 유지한 후 **다음** 을 클릭합니다.
4. **대상 서버 선택** 페이지의 서버 풀에서 서버 선택을 선택합니다.   현재 서버가 이미 선택되어 있습니다.  다음을 클릭합니다.
5. **서버 역할 선택** 페이지에서 **Hyper-V** 를 선택합니다.  
6. **역할 및 기능 추가 마법사** 팝업이 나타납니다.  **관리 도구 포함(해당하는 경우)** 을 선택합니다.  **기능 추가** 단추를 클릭합니다.
7. **서버 역할 선택** 페이지에서 **다음** 을 클릭합니다.
8. **기능 선택 페이지** 에서 **다음** 을 클릭합니다.
9. **Hyper-V** 페이지에서 **다음** 을 클릭합니다.
10. **가상 스위치 만들기** 페이지에서 기본값을 그대로 적용하고 **다음** 을 클릭합니다.
11. **가상 머신 마이그레이션** 페이지에서 기본값을 그대로 적용하고 **다음** 을 클릭합니다.
12. **기본 저장소** 페이지에서 기본값을 그대로 적용하고 **다음** 을 클릭합니다.
13. **설치 선택 확인** 페이지에서 **필요한 경우 자동으로 대상 서버 다시 시작** 확인란을 선택합니다.
14. **역할 및 기능 추가 마법사** 팝업이 나타나면 **예** 를 클릭합니다.
15. **설치** 를 클릭합니다.
16. **설치 진행률** 페이지에 Hyper-V 역할이 완료되었다고 표시될 때까지 기다립니다.  설치 도중에 머신이 다시 시작될 수 있습니다.
17. **닫기** 를 클릭합니다.

## <a name="enable-dhcp-role"></a>DHCP 역할 사용

생성된 모든 Hyper-V 클라이언트 가상 머신에는 NAT 네트워크의 IP 주소가 필요합니다.  나중에 NAT 네트워크를 만듭니다.  IP 주소를 할당하는 한 가지 방법은 호스트(이 경우 랩 가상 머신 템플릿)를 DHCP 서버로 설정하는 것입니다.  DHCP 역할을 사용하는 데 필요한 단계는 다음과 같습니다.

1. **서버 관리자** 의 **대시보드** 페이지에서 **역할 및 기능 추가** 를 클릭합니다.
2. **시작하기 전** 페이지에서 **다음** 을 클릭합니다.
3. **설치 유형 선택** 페이지에서 **역할 기반 또는 기능 기반 설치** 를 선택하고 **다음** 을 클릭합니다.
4. **대상 서버 선택** 페이지에서 서버 풀의 현재 서버를 선택한 후 **다음** 을 클릭합니다.
5. **서버 역할 선택** 페이지에서 **DHCP 서버** 를 선택합니다.  
6. **역할 및 기능 추가 마법사** 팝업이 나타납니다.  **관리 도구 포함(해당하는 경우)** 을 선택합니다.  **기능 추가** 를 클릭합니다.

    >[!NOTE]
    >고정 IP 주소를 찾을 수 없다는 유효성 검사 오류가 표시될 수 있습니다.  이 시나리오에서는 이 경고를 무시할 수 있습니다.

7. **서버 역할 선택** 페이지에서 **다음** 을 클릭합니다.
8. **기능 선택** 페이지에서 **다음** 을 클릭합니다.
9. **DHCP 서버** 페이지에서 **다음** 을 클릭합니다.
10. **설치 선택 확인** 페이지에서 **설치** 를 클릭합니다.
11. **설치 진행률** 페이지에 DHCP 역할이 완료되었다고 표시될 때까지 기다립니다.
12. 닫기를 클릭합니다.

## <a name="enable-routing-and-remote-access-role"></a>라우팅 및 원격 액세스 역할 사용

1. **서버 관리자** 의 **대시보드** 페이지에서 **역할 및 기능 추가** 를 클릭합니다.
2. **시작하기 전** 페이지에서 **다음** 을 클릭합니다.
3. **설치 유형 선택** 페이지에서 **역할 기반 또는 기능 기반 설치** 를 선택하고 **다음** 을 클릭합니다.
4. **대상 서버 선택** 페이지에서 서버 풀의 현재 서버를 선택한 후 **다음** 을 클릭합니다.
5. **서버 역할 선택** 페이지에서 **원격 액세스** 를 선택합니다. **확인** 을 클릭합니다.
6. **기능 선택** 페이지에서 **다음** 을 클릭합니다.
7. **원격 액세스** 페이지에서 **다음** 을 클릭합니다.
8. **역할 서비스** 페이지에서 **라우팅** 을 선택합니다.
9. **역할 및 기능 추가 마법사** 팝업이 나타납니다.  **관리 도구 포함(해당하는 경우)** 을 선택합니다.  **기능 추가** 를 클릭합니다.
10. **다음** 을 클릭합니다.
11. **웹 서버 역할(IIS)** 페이지에서 **다음** 을 클릭합니다.
12. **역할 서비스 선택** 페이지에서 **다음** 을 클릭합니다.
13. **설치 선택 확인** 페이지에서 **설치** 를 클릭합니다.
14. **설치 진행률** 페이지에 원격 액세스 역할이 완료되었다고 표시될 때까지 기다립니다.  
15. **닫기** 를 클릭합니다.

## <a name="create-virtual-nat-network"></a>가상 NAT 네트워크 만들기

필요한 모든 역할이 설치되었으므로 이제 NAT 네트워크를 만들겠습니다.  만들기 프로세스에는 스위치와 NAT 네트워크 자체를 만드는 작업이 포함됩니다.  NAT(Network Address Translation) 네트워크는 프라이빗 네트워크의 VM 그룹에 공용 IP 주소를 할당하여 인터넷에 대한 연결을 허용합니다.  이 경우 프라이빗 VM 그룹은 중첩된 VM이 됩니다.  NAT 네트워크를 사용하면 중첩된 VM이 서로 통신할 수 있습니다. 스위치는 네트워크의 트래픽 수신 및 라우팅을 처리하는 네트워크 디바이스입니다.

### <a name="create-a-new-virtual-switch"></a>새 가상 스위치 만들기

1. Windows 관리 도구에서 **Hyper-V 관리자** 를 엽니다.
2. 왼쪽 탐색 메뉴에서 현재 서버를 선택합니다.
3. **가상 스위치 관리자...** 를 **Hyper-V 관리자** 의 오른쪽에 있는 **작업** 메뉴에서 클릭합니다.
4. **가상 스위치 관리자** 팝업에서 만들 스위치의 유형에 대해 **내부** 를 선택합니다.  **가상 스위치 만들기** 를 클릭합니다.
5. 새로 만든 가상 스위치의 경우 기억하기 쉬운 이름을 설정합니다.  이 예제에서는 ‘LabServicesSwitch’를 사용합니다.  **확인** 을 클릭합니다.
6. 새 네트워크 어댑터가 생성됩니다.  이름은 ‘vEthernet (LabServicesSwitch)’과 비슷합니다.  확인하려면 **제어판** 을 열고, **네트워크 및 인터넷** 을 클릭한 다음, **네트워크 상태 및 작업 보기** 를 클릭합니다.  왼쪽에서 **어댑터 설정 변경** 을 클릭합니다.

### <a name="create-a-nat-network"></a>NAT 네트워크 만들기

1. Windows 관리 도구에서 **라우팅 및 원격 액세스** 도구를 엽니다.
2. 왼쪽 탐색 페이지에서 로컬 서버를 선택합니다.
3. **작업** -> **라우팅 및 원격 액세스 구성 및 사용** 을 선택합니다.
4. **라우팅 및 원격 액세스 서버 설치 마법사** 가 표시되면 **다음** 을 클릭합니다.
5. **구성** 페이지에서 **NAT(Network Address Translation)** 구성을 선택합니다.  **다음** 을 클릭합니다.

    >[!WARNING]
    >‘VPN(가상 사설망) 액세스 및 NAT’ 옵션을 선택하지 마세요.

6. **NAT 인터넷 연결** 페이지에서 ‘이더넷’을 선택합니다.  Hyper-V 관리자에서 만든 ‘vEthernet (LabServicesSwitch)’ 연결을 선택하지 마세요. **다음** 을 클릭합니다.
7. 마법사의 마지막 페이지에서 **마침** 을 클릭합니다.
8. **서비스 시작** 대화 상자가 나타나면 **서비스 시작** 을 클릭합니다.
9. 서비스가 시작될 때까지 기다립니다.

## <a name="update-network-adapter-settings"></a>네트워크 어댑터 설정 업데이트

네트워크 어댑터는 이전에 만든 NAT 네트워크의 기본 게이트웨이 IP에 사용되는 IP와 연결됩니다.  이 예제에서는 서브넷 마스크가 255.255.255.0인 192.168.0.1의 IP 주소를 만듭니다.  이전에 만든 가상 스위치를 사용합니다.

1. **제어판** 을 열고, **네트워크 및 인터넷** 을 클릭한 다음, **네트워크 상태 및 작업 보기** 를 클릭합니다.
2. 왼쪽에서 **어댑터 설정 변경** 을 클릭합니다.  
3. **네트워크 연결** 창에서 ‘vEthernet (LabServicesSwitch)’를 두 번 클릭하여 **vEthernet (LabServicesSwitch) 상태** 세부 정보 대화 상자를 표시합니다.
4. **속성** 단추를 클릭합니다.
5. **인터넷 프로토콜 버전 4(TCP/IPv4)** 항목을 선택하고 **속성** 단추를 클릭합니다.
6. **인터넷 프로토콜 버전 4(TCP/IPv4) 속성** 대화 상자에서 **다음 IP 주소 사용** 을 선택합니다.  IP 주소에 192.168.0.1을 입력합니다. 서브넷 마스크에 255.255.255.0을 입력합니다.  기본 게이트웨이를 비워 둡니다.  DNS 서버도 비워 둡니다.

    >[!NOTE]
    > NAT 네트워크의 범위는 CIDR 표기법으로 192.168.0.0/24입니다.  이는 192.168.0.1에서 192.168.0.254까지 사용 가능한 IP 주소의 범위를 만듭니다.  규칙에 따라 게이트웨이는 서브넷 범위의 첫 번째 IP 주소를 가집니다.

7. 확인을 클릭합니다.

## <a name="create-dhcp-scope"></a>DHCP 범위 만들기

다음 단계는 DHCP 범위를 추가하는 지침입니다.  이 문서에서 NAT 네트워크는 CIDR 표기법으로 192.168.0.0/24입니다.  이는 192.168.0.1에서 192.168.0.254까지 사용 가능한 IP 주소의 범위를 만듭니다.  생성된 범위는 이미 이전에 만든 IP 주소를 제외하고 사용 가능한 주소 범위에 있어야 합니다.

1. **관리 도구** 를 열고 **DHCP** 관리 도구를 엽니다.
2. **DHCP** 도구에서 현재 서버의 노드를 확장하고 **IPv4** 를 선택합니다.
3. 작업 메뉴에서 **새 범위...** 를 선택합니다.
4. **새 범위 마법사** 가 표시되면 **시작** 페이지에서 **다음** 을 클릭합니다.
5. **범위 이름** 페이지에서 이름에 대해 ‘LabServicesDhcpScope’를 입력하거나 기억하기 쉬운 이름을 입력합니다.  **다음** 을 클릭합니다.
6. **IP 주소 범위** 페이지에서 다음 값을 입력합니다.

    - 시작 IP 주소 - 192.168.0.100
    - 끝 IP 주소 - 192.168.0.200
    - 길이 - 24
    - 서브넷 마스크 - 255.255.255.0

7. **다음** 을 클릭합니다.
8. **제외 주소 및 지연 추가** 페이지에서 **다음** 을 클릭합니다.
9. **임대 기간** 페이지에서 **다음** 을 클릭합니다.
10. **DHCP 옵션 구성** 페이지에서 **예. 지금 이 옵션을 구성합니다.** 를 선택합니다. **다음** 을 클릭합니다.
11. **라우터(기본 게이트웨이)** 에서
12. 192.168.0.1을 추가합니다(아직 추가하지 않은 경우). **다음** 을 클릭합니다.
13. **도메인 이름 및 DNS 서버** 페이지에서 DNS 서버 IP 주소로 168.63.129.16을 추가합니다(아직 추가하지 않은 경우).  168.63.129.16은 Azure 고정 DNS 서버의 IP 주소입니다. **다음** 을 클릭합니다.
14. **WINS 서버** 페이지에서 **다음** 을 클릭합니다.
15. **범위 활성화** 페이지에서 **예. 지금 이 범위를 활성화합니다.** 를 선택합니다.  **다음** 을 클릭합니다.
16. **새 범위 마법사 완료** 페이지에서 **마침** 을 클릭합니다.

## <a name="conclusion"></a>결론

이제 템플릿 머신에서 Hyper-V 가상 머신을 만들 준비가 되었습니다.   Hyper-V 가상 머신을 만드는 방법에 관한 지침은 [Hyper-V에서 가상 머신 만들기](/windows-server/virtualization/hyper-v/get-started/create-a-virtual-machine-in-hyper-v)를 참조하세요.  또한 사용 가능한 운영 체제와 소프트웨어를 확인하려면 [Microsoft Evaluation Center](https://www.microsoft.com/evalcenter/)를 참조하세요.

## <a name="next-steps"></a>다음 단계

다음 단계는 모든 랩 설정에 공통됩니다.

- [사용자 추가](tutorial-setup-classroom-lab.md#add-users-to-the-lab)
- [할당량 설정](how-to-configure-student-usage.md#set-quotas-for-users)
- [일정 설정](tutorial-setup-classroom-lab.md#set-a-schedule-for-the-lab)
- [메일로 학생에게 등록 링크 보내기](how-to-configure-student-usage.md#send-invitations-to-users)