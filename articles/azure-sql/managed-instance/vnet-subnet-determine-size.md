---
title: 필요한 서브넷 크기 및 범위 확인
titleSuffix: Azure SQL Managed Instance
description: 이 토픽에서는 Azure SQL 관리형 인스턴스가 배포될 서브넷의 크기를 계산하는 방법을 설명합니다.
services: sql-database
ms.service: sql-managed-instance
ms.subservice: deployment-configuration
ms.custom: seo-lt-2019, sqldbrb=1
ms.devlang: ''
ms.topic: how-to
author: srdan-bozovic-msft
ms.author: srbozovi
ms.reviewer: mathoma, bonova, srbozovi, wiassaf
ms.date: 06/14/2021
ms.openlocfilehash: e3c789ec59e66189753c8515235b2375aa20e5f1
ms.sourcegitcommit: 6f4378f2afa31eddab91d84f7b33a58e3e7e78c1
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/13/2021
ms.locfileid: "113687405"
---
# <a name="determine-required-subnet-size-and-range-for-azure-sql-managed-instance"></a>Azure SQL Managed Instance에 대한 필수 서브넷 크기 및 범위 확인
[!INCLUDE[appliesto-sqlmi](../includes/appliesto-sqlmi.md)]

Azure SQL Managed Instance는 Azure [가상 네트워크](../../virtual-network/virtual-networks-overview.md) 내에 배포해야 합니다. 가상 네트워크 서브넷에 배포할 수 있는 관리되는 인스턴스 수는 서브넷 크기(서브넷 범위)에 따라 달라집니다.

관리되는 인스턴스를 만들 때 Azure에서는 프로비저닝하는 동안 선택한 계층에 따라 가상 머신 수를 할당합니다. 이러한 가상 머신이 서브넷에 연결되어 있기 때문에 IP 주소가 필요합니다. 일반 작업과 서비스 유지 관리 중에 고가용성이 보장되도록 Azure에서 가상 머신을 추가로 할당할 수 있습니다. 그러면 서브넷의 필수 IP 주소 수가 해당 서브넷의 관리되는 인스턴스 수보다 많아집니다.

기본적으로 Managed Instance의 서브넷에는 최소 32개의 IP 주소가 필요합니다. 따라서 서브넷 IP 범위를 정의할 때 최소 서브넷 마스크 /27을 사용할 수 있습니다. Managed Instance 배포에 대한 서브넷 크기를 신중하게 계획하는 것이 좋습니다. 계획 중에 다음 입력을 고려합니다.

- 다음 인스턴스 매개 변수를 포함하여 관리되는 인스턴스 수:
  - 서비스 계층
  - 하드웨어 세대
  - vCore 수
  - [유지 관리 기간](../database/maintenance-window.md)
- 스케일 업/다운 또는 서비스 계층 변경 계획

> [!IMPORTANT]
> IP 주소가 16개인 서브넷 크기(서브넷 마스크 /28)를 사용하면 내부에 관리되는 인스턴스 하나를 배포할 수 있습니다. 크기 조정 작업이 수행되지 않는 개발/테스트 시나리오나 평가에만 사용해야 합니다. 

## <a name="determine-subnet-size"></a>서브넷 크기 결정

향후 인스턴스 배포 및 크기 조정 요구 사항에 따라 서브넷 크기를 조정합니다. 다음 매개 변수는 계산식을 만드는 데 도움이 될 수 있습니다.

- Azure는 고유한 요구 사항으로 인해 서브넷에서 IP 주소 5개를 사용합니다.
- 각 가상 클러스터에서 주소 수를 추가로 할당합니다. 
- 각 관리되는 인스턴스는 가격 책정 계층과 하드웨어 생성에 따라 주소 수를 사용합니다.
- 각 크기 조정 요청은 일시적으로 주소 수를 추가로 할당합니다.

> [!IMPORTANT]
> 서브넷에 리소스가 있으면 서브넷 주소 범위를 변경할 수 없습니다. 또한 관리되는 인스턴스를 한 서브넷에서 다른 서브넷으로 이동할 수 없습니다. 나중에 문제가 발생하지 않도록 작은 서브넷보다 더 큰 서브넷을 사용하는 것이 좋습니다.

GP = 범용; BC = 중요 비즈니스용; VC = 가상 클러스터

| **하드웨어 세대** | **가격 책정 계층** | **Azure 사용량** | **VC 사용량** | **인스턴스 사용량** | **합계** |
| --- | --- | --- | --- | --- | --- |
| Gen4 | GP | 5 | 1 | 5 | 11 |
| Gen4 | BC | 5 | 1 | 5 | 11 |
| 5세대 | GP | 5 | 6 | 3 | 14 |
| 5세대 | BC | 5 | 6 | 5 | 16 |

앞의 표에서 각 항목은 다음을 나타냅니다.

- **합계** 열에는 서브넷에 배포된 단일 인스턴스에서 사용하는 총 주소 수가 표시됩니다. 
- 인스턴스를 서브넷에 더 추가하면 인스턴스에서 사용하는 주소 수가 증가합니다. 그러면 총 주소 수도 증가합니다. 예를 들어 다른 Gen4 GP 관리형 인스턴스를 추가하면 **인스턴스 사용량** 값이 10으로 증가하고 사용한 주소의 **합계** 값도 16으로 증가합니다. 
- **Azure 사용량** 열에 표시된 주소는 여러 가상 클러스터에서 공유됩니다.  
- **VC 사용량** 열에 표시된 주소는 해당 가상 클러스터에 있는 인스턴스에서 공유됩니다.

또한 서브넷 크기를 결정할 때, 특히 여러 인스턴스가 동일한 서브넷 내에 배포될 때 [유지 관리 기간 기능](../database/maintenance-window.md)을 사용하는 것이 좋습니다. 관리되는 인스턴스를 만드는 동안 또는 그 이후에 관리되는 인스턴스에 유지 관리 기간을 지정하는 것은 해당 유지 관리 기간 동안 관리되는 인스턴스가 가상 클러스터에 배치되어야 함을 의미합니다. 서브넷에 이러한 가상 클러스터가 없는 경우 인스턴스를 수용하기 위해 먼저 새 가상 클러스터를 만들어야 합니다.

일반적으로 업데이트 작업을 사용하려면 [가상 클러스터 크기를 조정](management-operations-overview.md)해야 합니다. 새로 만들기 요청이나 업데이트 요청이 발생하면 SQL Managed Instance 서비스는 추가해야 하는 새 노드에 대한 요청을 사용하여 컴퓨팅 플랫폼과 통신합니다. 컴퓨팅 응답에 따라 배포 시스템은 기존 가상 클러스터를 확장하거나 새 가상 클러스터를 만듭니다. 대부분의 경우 작업이 동일한 가상 클러스터 내에서 완료되더라도 컴퓨팅 측에 새 작업이 생성될 수 있습니다. 


## <a name="update-scenarios"></a>업데이트 시나리오

크기 조정 작업 중에 가격 책정 계층과 하드웨어 생성에 따라 인스턴스에 일시적으로 추가 IP 용량이 필요합니다.

| **하드웨어 세대** | **가격 책정 계층** | **시나리오** | **추가 주소**  |
| --- | --- | --- | --- |
| Gen4<sup>1</sup> | GP 또는 BC | vCore 스케일링 | 5 |
| Gen4<sup>1</sup> | GP 또는 BC | 스토리지 스케일링: | 5 |
| Gen4 | GP 또는 BC | GP에서 BC로 또는 BC에서 GP로 전환 | 5 |
| Gen4 | GP | Gen5로 전환 | 9 |
| Gen4 | BC | Gen5로 전환 | 11 |
| 5세대 | GP | vCore 스케일링 | 3 |
| 5세대 | GP | 스토리지 스케일링: | 0 |
| 5세대 | GP | BC로 전환 | 5 |
| 5세대 | BC | vCore 스케일링 | 5 |
| 5세대 | BC | 스토리지 스케일링: | 5 |
| 5세대 | BC | GP로 전환 | 3 |

<sup>1</sup> Gen4 하드웨어는 단계적으로 중단되며 더 이상 새로운 배포에 사용될 수 없습니다. Gen4에서 Gen5로 하드웨어 생성을 업데이트하면 Gen5와 관련된 기능이 활용됩니다.
  
## <a name="calculate-the-number-of-ip-addresses"></a>IP 주소 수 계산

총 IP 주소 수를 계산하는 데 다음 수식을 사용하는 것이 좋습니다. 이 수식에서는 나중에 요청을 만들거나 인스턴스를 업데이트하는 중에 새 가상 클러스터를 만들 수 있는 가능성을 고려합니다. 또한 가상 클러스터의 유지 관리 기간 요구 사항을 고려합니다.

**수식: 5 + (a * 12) + (b * 16) + (c * 16)**

- a = GP 인스턴스 수
- b = BC 인스턴스 수
- c = 다른 유지 관리 기간 구성 수

설명:
- 5 = Azure에서 예약한 IP 주소 수
- GP 인스턴스당 주소 12개 = 가상 클러스터에 6개, 관리되는 인스턴스에 3개, 크기 조정 작업을 위한 추가 3개
- BC 인스턴스당 주소 16개 = 가상 클러스터에 6개, 관리되는 인스턴스에 5개, 크기 조정 작업을 위한 추가 5개
- 백업으로 주소 16개 = 새 가상 클러스터가 생성된 시나리오

예: 
- 같은 서브넷에 범용 3개 및 비즈니스에 중요한 관리되는 인스턴스 2개를 배포하려고 합니다. 모든 인스턴스에 유지 관리 기간이 동일하게 구성됩니다. 즉, 5 + (3 * 12) + (2 * 16) + (1 * 16) = 89개 IP 주소가 필요합니다. 

  IP 범위가 2의 제곱으로 정의되므로 이 배포를 수행하려면 서브넷에 최소 128(2^7)의 IP 범위가 필요합니다. 따라서 /25 서브넷 마스크가 포함된 서브넷을 예약해야 합니다.

> [!NOTE]
> 서브넷 수식 출력보다 작은 수의 IP 주소를 사용하여 서브넷에 관리되는 인스턴스를 배포할 수 있지만 항상 더 큰 서브넷을 사용하는 것이 좋습니다. 더 큰 서브넷을 사용하면 서브넷 내에서 인스턴스를 추가로 만들 수 없거나 기존 인스턴스 크기를 조정할 수 없는 경우와 같이 IP 주소 부족으로 인한 향후 문제를 방지할 수 있습니다. 

## <a name="next-steps"></a>다음 단계

- 개요는 [Azure SQL Managed Instance란?](sql-managed-instance-paas-overview.md)을 참조하세요.
- [SQL 관리형 인스턴스의 연결 아키텍처](connectivity-architecture-overview.md)에 대해 자세히 알아보세요.
- [SQL Managed Instance를 배포할 가상 네트워크를 만드는](virtual-network-subnet-create-arm-template.md) 방법을 알아보세요.
- DNS 문제는 [사용자 지정 DNS 구성](custom-dns-configure.md)을 참조하세요.
