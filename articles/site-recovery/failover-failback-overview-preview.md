---
title: Azure Site Recovery의 장애 조치(failover) 및 장애 복구(failback) - 미리 보기 정보
description: Azure Site Recovery의 장애 조치 및 장애 복구 - 미리 보기에 대해 알아보기
ms.topic: conceptual
ms.date: 08/19/2021
ms.openlocfilehash: d7e08623a1e297d618365a126f835f88e9dfb716
ms.sourcegitcommit: 8000045c09d3b091314b4a73db20e99ddc825d91
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/19/2021
ms.locfileid: "122539536"
---
# <a name="about-on-premises-disaster-recovery-failoverfailback---preview"></a>온-프레미스 재해 복구 장애 조치/장애 복구 - 미리 보기 정보

이 문서에서는 [Azure Site Recovery](site-recovery-overview.md) - 미리 보기를 사용하여 온-프레미스 머신을 Azure에 재해 복구하는 동안 장애 조치 및 장애 복구를 간략하게 설명합니다.

Azure Site Recovery Classic 릴리스의 장애 조치 및 장애 복구에 대한 자세한 내용은 [이 문서를 참조](failover-failback-overview.md)하세요.

## <a name="recovery-stages"></a>복구 단계

Site Recovery의 장애 조치와 장애 복구에는 4개 단계가 있습니다.

- **1단계: 온-프레미스에서 장애 조치**: 온-프레미스 머신에 대해 Azure로 복제를 설정한 후 온-프레미스 사이트가 다운되면 해당 머신을 Azure로 장애 조치합니다. 장애 조치(Failover) 후 복제된 데이터에서 Azure VM이 만들어집니다.
- **2단계: Azure VM 다시 보호**: Azure에서 Azure VM을 다시 보호하여 온-프레미스 사이트로 다시 복제를 시작합니다. 데이터 일관성을 보장할 수 있도록 온-프레미스 VM(사용 가능한 경우)은 다시 보호 중에 꺼져 있습니다.
- **3단계: Azure에서 장애 조치**: 온-프레미스 사이트가 다시 정상적으로 실행되는 경우 다른 장애 조치를 실행하여 이번에는 Azure VM을 온-프레미스 사이트로 장애 복구합니다. 장애 조치한 원래 위치나 대체 위치로 장애 복구할 수 있습니다. 이 작업을 ‘계획된 장애 조치’라고 합니다.
- **4단계: 온-프레미스 머신 다시 보호**: 장애 복구한 후 온-프레미스 머신을 Azure로 다시 복제할 수 있습니다.

## <a name="failover"></a>장애 조치 

BCDR(비즈니스 연속성 및 재해 복구) 전략의 일부로 장애 조치를 수행합니다.

- BCDR 전략의 첫 번째 단계로, 지속적으로 온-프레미스 머신을 Azure에 복제합니다. 사용자는 온-프레미스 원본 머신에서 실행되는 워크로드와 앱에 액세스합니다.
- 온-프레미스에서 중단이 발생하는 경우와 같이 필요한 경우 머신을 Azure로 장애 조치합니다. Azure VM은 복제된 데이터를 사용하여 만들어집니다.
- 비즈니스 연속성을 위해 사용자는 Azure VM에서 앱에 계속 액세스할 수 있습니다.

장애 조치는 2단계 작업입니다.

- **장애 조치**: 선택된 복구 지점을 사용하여 Azure VM을 만들고 표시하는 장애 조치입니다.
- **커밋**: 장애 조치 후에 Azure에서 VM을 확인합니다.
    - 그런 다음, 선택된 복구 지점으로 장애 조치를 커밋하거나 커밋을 위해 다른 지점을 선택할 수 있습니다.
    - 장애 조치를 커밋한 후에는 복구 지점을 변경할 수 없습니다.


## <a name="connect-to-azure-after-failover"></a>장애 조치 후 Azure에 연결

RDP/SSH를 사용하여 장애 조치 후 생성된 Azure VM에 연결하려면 여러 요구 사항이 있습니다.

**장애 조치(Failover)** | **위치** | **actions**
--- | --- | ---
**Windows를 실행하는 Azure VM** | 장애 조치 전에 온-프레미스 머신에서: | **인터넷을 통해 액세스**: RDP를 사용하도록 설정합니다. **퍼블릭** 에 대해 TCP 및 UDP 규칙이 추가되고 해당 RDP가 **Windows 방화벽** > **허용되는 앱** 에서 모든 프로필에 대해 허용되는지 확인합니다.<br/><br/> **사이트 간 VPN을 통해 액세스**: 머신에서 RDP를 사용하도록 설정합니다. RDP가 **Windows 방화벽** -> **허용되는 앱 및 기능** 에서 **도메인 또는 프라이빗** 네트워크에 대해 허용되는지 확인합니다.<br/><br/>  운영 체제의 SAN 정책이 **OnlineAll** 로 설정되어 있는지 확인합니다. [자세한 정보를 알아보세요](https://support.microsoft.com/kb/3031135).<br/><br/> 장애 조치를 트리거할 때 VM에 보류 중인 Windows 업데이트가 없는지 확인합니다. 장애 조치 시 Windows 업데이트가 시작될 수 있으며, 업데이트가 완료될 때까지 VM에 로그인할 수 없습니다.
**Windows를 실행하는 Azure VM** | 장애 조치 후 Azure VM에서 |  VM에 대한 [공용 IP 주소를 추가](/archive/blogs/srinathv/how-to-add-a-public-ip-address-to-azure-vm-for-vm-failed-over-using-asr)합니다.<br/><br/> 장애 조치된 VM(및 해당 VM이 연결된 Azure 서브넷)에 대한 네트워크 보안 그룹 규칙은 RDP 포트에 대한 들어오는 연결을 허용해야 합니다.<br/><br/> **부트 진단** 을 확인하여 VM에 대한 스크린샷을 검토합니다. 연결할 수 없는 경우 VM이 실행 중인지 확인하고 [문제 해결 팁](https://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx)을 검토합니다.
**Linux를 실행하는 Azure VM** | 장애 조치 전에 온-프레미스 머신에서: | VM의 보안 셸 서비스가 시스템 부팅 시 자동으로 시작되도록 설정되어 있는지 확인합니다.<br/><br/> 방화벽 규칙이 SSH 연결을 허용하는지 확인합니다.
**Linux를 실행하는 Azure VM** | 장애 조치 후 Azure VM에서 | 장애 조치(Failover)된 VM 그리고 해당 VM이 연결된 Azure 서브넷의 네트워크 보안 그룹 규칙이 SSH 포트로 들어오는 연결을 허용해야 합니다.<br/><br/> VM에 대한 [공용 IP 주소를 추가](/archive/blogs/srinathv/how-to-add-a-public-ip-address-to-azure-vm-for-vm-failed-over-using-asr)합니다.<br/><br/> **부트 진단** 에서 VM에 대한 스크린샷을 검토합니다.<br/><br/>

## <a name="types-of-failover"></a>장애 조치(Failover) 유형

Site Recovery는 다른 장애 조치 옵션을 제공합니다.

**장애 조치(Failover)** | **세부 정보** | **복구** | **Workflow**
--- | --- | --- | ---
**테스트 장애 조치** | 데이터 손실이나 가동 중지 시간 없이 BCDR 전략 유효성을 검사하는 연습을 실행하는 데 사용됩니다.| 진행 중인 복제 또는 프로덕션 환경에 영향을 주지 않고 Azure에서 VM 복사본을 만듭니다. | 1. 복구 계획의 단일 VM 또는 여러 VM에서 테스트 장애 조치를 실행합니다.<br/><br/> 2. 테스트 장애 조치에 사용할 복구 지점을 선택합니다.<br/><br/> 3. 장애 조치 이후 Azure VM이 생성될 때 배치될 Azure 네트워크를 선택합니다. 네트워크는 장애 조치(failover) 테스트에서만 사용됩니다.<br/><br/> 4. 연습이 예상대로 작동했는지 확인합니다. Site Recovery는 연습 중에 Azure에서 생성된 VM을 자동으로 정리합니다.
**계획된 장애 조치-Hyper-V**  | 일반적으로 계획된 가동 중지 시간에 사용됩니다.<br/><br/> 원본 VM이 종료됩니다. 장애 조치를 시작하기 전에 최신 데이터가 동기화됩니다. | 계획된 워크플로에 대한 데이터 손실이 없습니다. | 1. 가동 중지 시간 유지 관리 기간을 계획하고 사용자에게 알립니다.<br/><br/> 2. 사용자 연결 앱을 오프라인으로 전환합니다.<br/><br/> 3. 최신 복구 지점을 사용하여 계획된 장애 조치를 시작합니다. 머신이 종료되지 않았거나 오류가 발생한 경우 장애 조치가 실행되지 않습니다.<br/><br/> 4. 장애 조치 이후 Azure에서 복제본 Azure VM이 활성 상태인지 확인합니다.<br/><br/> 5. 장애 조치를 커밋하여 완료합니다. 커밋 작업으로 모든 복구 지점이 삭제됩니다.
**장애 조치-Hyper-V** | 일반적으로 계획되지 않은 중단이 발생하거나 기본 사이트를 사용할 수 없는 경우 실행합니다.<br/><br/> 필요에 따라 VM을 종료하고 최종 변경 내용을 동기화한 후 장애 조치를 시작합니다.  | 앱의 데이터 손실을 최소화합니다. | 1. BCDR 계획을 시작합니다. <br/><br/> 2. 장애 조치를 시작합니다. Site Recovery가 VM을 종료하고 최신 변경 내용을 동기화/복제한 후 장애 조치를 트리거할지 여부를 지정합니다.<br/><br/> 3. 아래 표에 요약된 여러 복구 지점 옵션으로 장애 조치할 수 있습니다.<br/><br/> VM 종료 옵션을 사용 설정하지 않거나 또는 Site Recovery 종료가 불가능할 경우 최신 복구 지점이 사용됩니다.<br/>장애 조치(failover)는 머신을 종료할 수 없을 때에도 실행됩니다.<br/><br/> 4. 장애 조치 이후 Azure에서 복제본 Azure VM이 활성 상태인지 확인합니다.<br/> 필요한 경우, 24시간 동안 보존 기간에서 다른 복구 지점을 선택할 수 있습니다.<br/><br/> 5. 장애 조치를 커밋하여 완료합니다. 커밋 작업으로 사용 가능한 모든 복구 지점이 삭제됩니다.
**Failover-VMware** | 일반적으로 계획되지 않은 중단이 발생하거나 기본 사이트를 사용할 수 없는 경우 실행합니다.<br/><br/> 필요에 따라 Site Recovery가 VM 종료를 트리거하고, 최종 변경 내용을 동기화하고 복제한 후 장애 조치를 시작하도록 지정합니다.  | 앱의 데이터 손실을 최소화합니다. | 1. BCDR 계획을 시작합니다. <br/><br/> 2. Site Recovery에서 장애 조치를 시작합니다. 장애 조치(failover)를 실행하기 전에 Site Recovery의 VM 종료 및 동기화 시도 여부를 지정합니다.<br/> 장애 조치는 머신을 종료할 수 없는 경우에도 실행됩니다.<br/><br/> 3. 장애 조치 이후 Azure에서 복제본 Azure VM이 활성 상태인지 확인합니다. <br/>필요한 경우 72시간 보존 기간에서 다른 복구 지점을 선택할 수 있습니다.<br/><br/> 5. 장애 조치를 커밋하여 완료합니다. 커밋 작업으로 모든 복구 지점이 삭제됩니다.<br/> Windows VM의 경우 Site Recovery는 장애 조치(failover) 중에 VMware 도구를 사용하지 않도록 설정합니다.
**계획된 장애 조치-VMware** | Azure에서 온-프레미스로 계획된 장애 조치를 수행할 수 있습니다. | 계획된 장애 조치 작업이므로 복구 지점은 계획된 장애 조치 작업이 트리거된 후에 생성됩니다. | 계획된 장애 조치가 트리거되면 보류 중인 변경 내용이 온-프레미스로 복사되고, VM의 최근 복구 지점이 생성되고, Azure VM이 종료됩니다.<br/><br/> [여기](vmware-azure-tutorial-failover-failback-preview.md#planned-failover-from-azure-to-on-premises)에 설명된 대로 장애 조치 프로세스를 수행합니다. 그러면 온-프레미스 머신이 켜집니다. 계획된 장애 조치가 성공적으로 끝나면 머신이 온-프레미스 환경에서 활성화됩니다.

## <a name="failover-processing"></a>장애 조치 처리

일부 시나리오에서는 장애 조치(failover)를 위해서는 추가 처리가 필요하며 이러한 작업을 완료하는 데는 약 8~10분이 소요됩니다. 다음에 대한 테스트 장애 조치(failover) 시간이 길어질 수 있습니다.

* DHCP 서비스를 사용하도록 설정되지 않은 VMware VM
* 다음 부팅 드라이버가 없는 VMware VM: storvsc, vmbus, storflt, intelide, atapi.

## <a name="recovery-point-options"></a>복구 지점 옵션

장애 조치 중에 다양한 복구 지점 옵션을 선택할 수 있습니다.

**옵션** | **세부 정보**
--- | ---
**최신(가장 낮은 RPO)** | 이 옵션은 가장 낮은 RPO(복구 지점 목표)를 제공합니다. Site Recovery 서비스로 보낸 모든 데이터를 먼저 처리하여 각 VM에 대한 복구 지점을 만든 후에 해당 복구 지점으로 장애 조치(failover)합니다. 이 복구 지점에는 장애 조치(failover)가 트리거될 때 Site Recovery로 복제된 모든 데이터가 있습니다.
**가장 최근에 처리됨**  | 이 옵션은 Site Recovery에서 처리된 최신 복구 지점으로 VM을 장애 조치합니다. 특정 VM에 대한 최신 복구 지점을 보려면 VM 설정에서 **최신 복구 지점** 을 선택하세요. 이 옵션은 처리되지 않은 데이터를 처리하는 데 시간이 투입되지 않으므로 낮은 RTO(복구 시간 목표)를 제공합니다.
**최신 앱 일치** |  이 옵션은 앱 일치 복구 지점이 사용되는 경우 Site Recovery에서 처리된 최신 애플리케이션 일치 복구 지점으로 VM을 장애 조치합니다. VM 설정에서 최신 복구 지점을 확인합니다.
**최신 다중 VM이 처리됨** | 이 옵션은 다중 VM 일치가 사용하도록 설정된 하나 이상의 VM이 포함된 복구 계획에 사용할 수 있습니다. 이 설정이 사용하도록 설정된 VM은 최신 일반 다중 VM 일치 복구 지점으로 장애 조치(Failover)됩니다. 계획의 다른 모든 VM은 처리된 최신 복구 지점으로 장애 조치됩니다.
**최신 다중 VM 앱 일치** |  이 옵션은 다중 VM 일치가 사용하도록 설정된 하나 이상의 VM이 포함된 복구 계획에 사용할 수 있습니다. 복제 그룹에 속하는 VM은 공통된 최신 다중 VM 애플리케이션 일관성 복구 지점으로 장애 조치(failover)됩니다. 다른 VM은 최신 애플리케이션 일치 복구 지점으로 장애 조치(Failover)됩니다.
**사용자 지정** | 이 옵션을 사용하여 특정 VM을 특정 복구 시점으로 장애 조치합니다. 복구 계획에는 이 옵션을 사용할 수 없습니다.

> [!NOTE]
> 복구 지점은 다른 Recovery Services 자격 증명 모음으로 마이그레이션할 수 없습니다.

## <a name="reprotectionplanned-failover"></a>다시 보호/계획된 장애 조치

Azure로 장애 조치한 후 복제된 Azure VM은 보호되지 않는 상태입니다.

- 온-프레미스 사이트로 장애 복구하는 첫 번째 단계로, 온-프레미스로 복제하는 Azure VM을 시작해야 합니다. 다시 보호 프로세스는 장애 조치된 머신의 유형에 따라 달라집니다.
- 머신이 Azure에서 온-프레미스로 복제된 후 Azure에서 온-프레미스 사이트로 장애 조치를 실행할 수 있습니다.
- 머신이 다시 온-프레미스에서 실행된 후 재해 복구를 위해 머신이 Azure에 복제되도록 복제를 사용하도록 설정할 수 있습니다.

**계획된 장애 조치는 다음과 같이 진행됩니다**.

- 온-프레미스로 장애 복구하려면 VM에 하나 이상의 복구 지점이 필요합니다. 복구 계획에서 계획의 모든 VM에는 하나 이상의 복구 지점이 필요합니다.
- 계획된 장애 조치 작업이므로 장애 복구할 복구 지점 유형을 선택할 수 있습니다. 충돌 일치 지점을 사용하는 것이 좋습니다.
    - 앱 일치 복구 지점 옵션도 있습니다. 이 경우 단일 VM은 사용 가능한 최신 앱 일치 복구 지점으로 복구됩니다. 복제 그룹이 있는 복구 계획의 경우 각 복제 그룹은 사용 가능한 일반 복구 지점으로 복구됩니다.
    - 앱 일치 복구 지점의 경우 복구가 지연될 수 있고 데이터가 손실될 수 있습니다.
- Azure에서 온-프레미스 사이트로 장애 조치하는 동안 Site Recovery는 Azure VM을 종료합니다. 장애 조치를 커밋하면 Site Recovery는 Azure에서 장애 복구된 Azure VM을 제거합니다.


## <a name="vmwarephysical-reprotectionfailback"></a>VMware/물리적 다시 보호/장애 복구

VMware 머신과 물리적 서버를 다시 보호하고 Azure에서 온-프레미스로 장애 복구하려면 정상 어플라이언스가 있어야 합니다.

**어플라이언스 선택**

- 온-프레미스로 다시 보호하기 위해 자격 증명 모음에 등록된 Azure Site Recovery 복제 어플라이언스를 선택할 수 있습니다. 다시 보호 작업에는 Azure의 별도 프로세스 서버가 필요하지 않으며 Linux VM용 스케일 아웃 Master Target 서버가 필요하지 않습니다.
- 복제 어플라이언스에는 장애 복구 중에 추가 네트워크 연결/포트가 필요하지 않습니다(정방향 보호와 다름). 정상 상태이면 동일한 어플라이언스를 정방향 및 역방향 보호에 사용할 수 있습니다. 이것은 복제의 성능에 영향을 주지 않습니다.
- 선택한 데이터 저장소 또는 호스트에 어플라이언스가 있으며 선택한 어플라이언스에서 액세스할 수 있는지 확인합니다.
  > [!NOTE]
  > 복제 어플라이언스의 스토리지 vMotion은 다시 보호 작업 후에 지원되지 않습니다.


**다시 보호 작업**

- 새 다시 보호 작업인 경우 기본적으로 대상 지역에서 Azure Site Recovery로 인해 새 로그 스토리지 계정이 자동으로 생성됩니다. 보존 디스크가 필요하지 않습니다.
- 대체 위치 복구 및 원본 위치 복구의 경우 원본 머신의 원래 구성이 검색됩니다.
  > [!NOTE]
  > - ALR(대체 위치 다시 보호) 또는 OLR(원래 위치 다시 보호)의 경우 고정 IP 주소를 유지할 수 없습니다.
  > - fstab, LVMconf가 변경됩니다.


**실패**

- 실패한 다시 보호 작업을 다시 시도할 수 있습니다. 다시 시도하는 동안 정상 복제 어플라이언스를 선택할 수 있습니다.

Azure VM을 온-프레미스로 다시 보호하는 경우 원래 위치나 대체 위치로 장애 복구하도록 지정할 수 있습니다.

- **원래 위치 복구**: Azure에서 동일한 원본 온-프레미스 머신(있는 경우)으로 장애 복구됩니다. 이 시나리오에서는 변경 내용만 온-프레미스로 다시 복제됩니다.
  - **OLR 동안 데이터 저장소 선택**: 원본 머신에 연결된 데이터 저장소가 자동으로 선택됩니다.
- **대체 위치 복구**: 온-프레미스 머신이 존재하지 않는 경우 Azure에서 대체 위치로 장애 복구할 수 있습니다. Azure VM을 온-프레미스로 다시 보호하는 경우 온-프레미스 머신이 만들어집니다. 전체 데이터 복제는 Azure에서 온-프레미스로 수행됩니다. 위치 장애 복구의 요구 사항과 제한 사항을 [검토](concepts-types-of-failback.md)합니다.
  - **ALR 동안 데이터 저장소 선택**: 어플라이언스가 위치하며 어플라이언스에서 액세스할 수 있는(읽기 및 쓰기 권한) vCenter에서 관리하는 모든 데이터 저장소(원본/신규)를 선택할 수 있습니다. 다시 보호에 사용되는 캐시 스토리지 계정을 선택할 수 있습니다.

- 장애 조치가 완료되면 Azure VM의 모바일 에이전트가 Site Recovery 서비스에 자동으로 등록됩니다. 등록이 실패하면 장애 조치된 VM에서 심각한 상태 문제가 발생합니다. 문제가 해결된 후에는 등록이 자동으로 트리거됩니다. 오류를 해결한 후 수동으로 등록을 완료할 수 있습니다.


## <a name="cancel-failover"></a>장애 조치 취소

온-프레미스 환경이 준비되지 않았거나 문제가 발생하는 경우 장애 조치를 취소할 수 있습니다.

계획된 장애 조치를 시작했으며 성공적으로 완료되면 온-프레미스 환경을 사용할 수 있게 됩니다. 그러나 작업이 완료된 후 다른 복구 지점으로 장애 조치하려는 경우 장애 조치를 취소할 수 있습니다.


- 계획된 장애 조치만 취소할 수 있습니다.

- Recovery Services 자격 증명 모음의 **복제된 항목** 페이지에서 계획된 장애 조치를 취소할 수 있습니다.

- 장애 조치가 취소되면 Azure의 머신이 다시 켜지고, Azure에서 온-프레미스로의 복제가 다시 시작됩니다.


## <a name="next-steps"></a>다음 단계
- [VMware VM을 Azure로 장애 조치(미리 보기)](vmware-azure-tutorial-failover-failback-preview.md#run-a-failover-to-azure)
- [계획된 장애 조치(미리 보기)](vmware-azure-tutorial-failover-failback-preview.md#planned-failover-from-azure-to-on-premises)
- [다시 보호(미리 보기)](vmware-azure-tutorial-failover-failback-preview.md#re-protect-the-on-premises-machine-to-azure-after-successful-planned-failover)
- [장애 조치 취소(미리 보기)](vmware-azure-tutorial-failover-failback-preview.md#cancel-planned-failover)
