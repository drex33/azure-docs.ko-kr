---
title: Azure Database for MySQL 유연한 서버를 사용하는 영역 중복 고가용성 개요
description: Azure Database for MySQL 유연한 서버를 사용하는 영역 중복 고가용성의 개념에 대해 알아봅니다.
author: savjani
ms.author: pariks
ms.service: mysql
ms.topic: conceptual
ms.date: 08/10/2021
ms.openlocfilehash: d78bb5aeb111411641508b38bd49a6f5bcbf5374
ms.sourcegitcommit: 2d412ea97cad0a2f66c434794429ea80da9d65aa
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/14/2021
ms.locfileid: "122529679"
---
# <a name="high-availability-concepts-in-azure-database-for-mysql-flexible-server-preview"></a>Azure Database for MySQL 유연한 서버의 고가용성 개념(미리 보기)

[!INCLUDE[applies-to-mysql-flexible-server](../includes/applies-to-mysql-flexible-server.md)]

> [!IMPORTANT] 
> Azure Database for MySQL - 유연한 서버는 현재 공개 미리 보기로 제공됩니다.

Azure Database for MySQL 유연한 서버(미리 보기)를 사용하면 자동 장애 조치(failover)로 고가용성을 구성할 수 있습니다. 고가용성이 구성되면 유연한 서버가 두 가지 다른 옵션을 사용하여 대기 복제본을 자동으로 프로비저닝하고 관리합니다.

* **영역 중복 고가용성**: 이 옵션은 여러 가용성 영역에서 인프라의 완전한 격리 및 중복성을 위해 선호됩니다. 최고 수준의 가용성을 제공하지만 영역 간에 애플리케이션 중복성을 구성해야 합니다. 영역 중복 HA는 가용성 영역의 모든 인프라 장애에 대해 최고 수준의 가용성을 확보하고 가용성 영역 전체의 대기 시간이 허용되는 경우 선호됩니다. 영역 중복 HA는 지역이 여러 가용성 영역을 지원하고 영역 중복 HA를 사용할 수 있는 [Azure 지역의 하위 집합](https://docs.microsoft.com/azure/mysql/flexible-server/overview#azure-regions)에서 사용할 수 있습니다.

* **동일 영역 고가용성**: 이 옵션은 기본 서버와 대기 서버가 동일한 가용성 영역에 있으므로 네트워크 대기 시간이 짧은 인프라 중복에 선호됩니다. 영역 간에 애플리케이션 중복성을 구성하지 않고도 고가용성을 제공합니다. 동일한 영역 HA는 네트워크 대기 시간이 가장 짧은 단일 가용성 영역 내에서 최고 수준의 가용성을 확보하려는 경우 선호됩니다. 동일 영역 HA는 [유연한 서버를 사용할 수 있는 모든 Azure 지역](https://docs.microsoft.com/azure/mysql/flexible-server/overview#azure-regions)에서 사용할 수 있습니다.  

## <a name="zone-redundant-high-availability"></a>영역 중복 고가용성

영역 중복 고가용성이 사용 설정된 유연한 서버가 생성되면 데이터 및 로그 파일이 [ZRS(영역 중복 스토리지)](../../storage/common/storage-redundancy.md#redundancy-in-the-primary-region)에서 호스팅됩니다. ZRS와 함께 사용 가능한 스토리지 수준 복제를 사용하면 데이터 및 로그 파일이 대기 서버에 동기식으로 복제되어 데이터 손실이 없습니다. 장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 사용자 작업이 필요하지 않습니다. 장애 조치(failover) 중 온라인 상태가 되는 대기 서버의 복구는 대기 서버의 이진 로그 애플리케이션에 따라 다릅니다. 따라서 모든 테이블에서 기본 키를 사용하여 장애 조치(failover) 시간을 줄이는 것이 좋습니다. 대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없지만 빠른 장애 조치(failover)를 사용할 수 있는 수동 대기 상태입니다. 일반적인 장애 조치(failover) 시간 범위는 60~120초입니다.

> [!Note]
> 영역 중복 HA는 네트워크 대기 시간이 2-4ms 정도로 상대적으로 더 높은 가용성 영역에서 애플리케이션이 데이터베이스 서버에 연결하는 경우 대기 시간을 5-10% 떨어뜨릴 수 있습니다. 

:::image type="content" source="./media/concepts-high-availability/1-flexible-server-overview-zone-redundant-ha.png" alt-text="영역 중복 HA":::

### <a name="zone-redundancy-architecture"></a>영역 중복 아키텍처

주 서버는 지역 및 특정 가용성 영역에 배포됩니다. 고가용성을 선택하면 컴퓨팅 계층, 컴퓨팅 크기, 스토리지 크기, 네트워크 구성을 포함하여 주 서버와 구성이 동일한 대기 복제본 서버가 "지정된 가용성 영역"에 자동으로 배포됩니다. 오류 상황에서 데이터 손실을 방지하기 위해 로그 데이터가 대기 복제본에 동기적으로 복제됩니다. 스냅샷과 로그 백업 모두 자동 백업은 주 데이터베이스 서버의 영역 중복 스토리지에서 수행됩니다.

### <a name="standby-zone-selection"></a>대기 영역 선택
영역 중복 고가용성 시나리오에서 원하는 대기 서버 영역 위치를 선택할 수 있습니다. 대기 데이터베이스 서버와 대기 애플리케이션을 같은 영역에 배치하면 대기 시간이 줄어들고 사용자가 재해 복구 상황과 “영역 다운” 시나리오에 더 잘 대비할 수 있습니다.

## <a name="same-zone-high-availability"></a>동일 영역 고가용성

동일 영역 고가용성을 사용하도록 설정한 유연한 서버를 만들면 데이터 및 로그 파일이 [LRS(로컬 중복 스토리지)](https://docs.microsoft.com/azure/storage/common/storage-redundancy#locally-redundant-storage)에서 호스팅됩니다. LRS와 함께 사용 가능한 스토리지 수준 복제를 사용하면 데이터 및 로그 파일이 대기 서버에 동기식으로 복제되어 데이터 손실이 없습니다. 대기 서버는 공동 배치로 인해 사용자 애플리케이션과 데이터베이스 서버 사이의 장애 조치(failover) 시간과 네트워크 대기 시간을 줄이는 별도의 가상 머신(컴퓨팅)으로 인프라 중복성을 제공합니다. 장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 사용자 작업이 필요하지 않습니다. 장애 조치(failover) 중 온라인 상태가 되는 대기 서버의 복구는 대기 서버의 이진 로그 애플리케이션에 따라 다릅니다. 따라서 모든 테이블에서 기본 키를 사용하여 장애 조치(failover) 시간을 줄이는 것이 좋습니다. 대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없지만 빠른 장애 조치(failover)를 사용할 수 있는 수동 대기 상태입니다. 일반적인 장애 조치(failover) 시간 범위는 60~120초입니다.

동일 영역 고가용성을 통해 사용자는 기본 서버와 동일한 영역에 대기 서버를 배치할 수 있으므로 기본 서버와 대기 서버 간의 복제 지연이 줄어듭니다. 또한 동일한 Azure 가용성 영역 내에 배치되는 경우 애플리케이션 서버와 데이터베이스 서버 간의 대기 시간을 줄일 수 있습니다.

:::image type="content" source="./media/concepts-high-availability/flexible-server-overview-same-zone-ha.png" alt-text="동일한 중복 고가용성":::

## <a name="high-availability-monitoring"></a>고가용성 모니터링
HA의 상태는 개요 페이지에서 지속적으로 모니터링되고 보고됩니다. 다음과 같은 다양한 복제 상태가 나열됩니다.

| **Status** | **설명** |
| :----- | :------ |
| <b>NotEnabled | 영역 중복 HA를 사용하도록 설정하지 않았습니다. |
| <b>ReplicatingData | 대기 서버를 만든 후에 주 서버의 데이터를 받는 중입니다. |
| <b>FailingOver | 데이터베이스 서버가 주 서버에서 대기 서버로 장애 조치(failover)를 진행하는 중입니다. |
| <b>정상 | 영역 중복 HA가 안정되었으며 정상 상태입니다. |
| <b>RemovingStandby | 사용자의 작업에 따라 대기 복제본 서버를 삭제하는 중입니다.| 

## <a name="advantages"></a>장점

영역 중복 HA 기능을 사용하는 경우의 몇 가지 이점은 다음과 같습니다. 

- 대기 복제본은 vCore, 스토리지, 네트워크 설정(VNET, 방화벽) 등 주 서버의 VM 구성을 정확히 그대로 배포합니다.
- 고가용성을 사용하지 않도록 설정하여 대기 복제본을 제거할 수 있습니다.
- 자동 백업은 스냅샷 기반이며 주 데이터베이스 서버에서 수행되며 고가용성 옵션에 따라 영역 중복 스토리지 또는 로컬 중복 스토리지에 저장됩니다.
- 고가용성을 사용하도록 설정한 경우 장애 조치(failover) 시에 Azure Database for MySQL 유연한 서버가 대기 복제본으로 자동으로 장애 조치(failover)를 합니다. 고가용성 설정이 주 서버를 모니터링하고 온라인 상태로 다시 전환합니다.
- 클라이언트는 항상 주 데이터베이스 서버에 연결합니다.
- 데이터베이스 크래시 또는 노드 장애가 발생하면 유연한 서버 VM이 동일한 노드에서 다시 시작됩니다. 동시에 자동 장애 조치(failover)가 트리거됩니다. 장애 조치(failover)가 완료되기 전에 유연한 서버 VM 재시작에 성공하면 장애 조치(failover) 작업이 취소됩니다.
- 서버를 다시 시작하여 정적 서버 매개 변수의 변경 내용을 선택할 수 있습니다.

## <a name="steady-state-operations"></a>정상 상태 작업

애플리케이션은 데이터베이스 서버 이름을 사용하여 주 서버에 연결됩니다. 대기 복제본 정보는 직접 액세스에 노출되지 않습니다. 커밋 및 쓰기는 주 서버의 ZRS(영역 중복 스토리지) 스토리지에서 로그 파일을 플러시한 후 승인됩니다. ZRS 스토리지에 사용되는 동기화 복제 기술로 인해 애플리케이션은 쓰기 및 커밋에 대해 약간의 대기 시간을 예측할 수 있습니다.

## <a name="failover-process"></a>장애 조치(Failover) 프로세스 
비즈니스 연속성을 유지하려면 계획된 이벤트 혹은 계획되지 않은 이벤트에 대한 장애 조치(failover) 프로세스가 필요합니다. 

>[!NOTE]
> 항상 FQDN(정규화된 도메인 이름)을 사용하여 주 서버에 연결하고 IP 주소를 사용하여 연결하지 않도록 합니다. 장애 조치(failover)의 경우 주 서버와 대기 서버 역할이 전환되면 DNS A 레코드도 변경되어 연결 문자열에 IP 주소가 사용되는 경우 애플리케이션이 새 주 서버에 연결하지 못할 수 있습니다. 

### <a name="planned-events---forced-failover"></a>계획된 이벤트 - 강제 장애 조치(failover)

Azure Database for MySQL 강제 장애 조치(failover)를 사용하면 수동으로 장애 조치(failover)를 수행하여 애플리케이션 시나리오에서 기능을 테스트할 수 있으며 가동 중단 시 대비할 수 있습니다. 강제 장애 조치(failover)는 DNS 레코드를 업데이트하여 대기 복제본을 동일한 데이터베이스 서버 이름으로 주 서버가 되도록 활성화하는 장애 조치(failover)를 트리거하여 대기 서버를 주 서버로 전환합니다. 기존의 주 서버가 다시 시작되고 대기 복제본으로 전환됩니다. 클라이언트 연결의 연결이 끊어지고 작업을 다시 시작하려면 다시 연결해야 합니다. 현재 워크로드 및 마지막 검사점에 따라 전체 장애 조치(failover) 시간이 측정됩니다. 일반적으로 60-120초 사이입니다. 

### <a name="failover-process---unplanned-events"></a>장애 조치(failover) 프로세스 - 계획되지 않은 이벤트
계획되지 않은 서비스 가동 중지 시간에는 소프트웨어 버그 또는 데이터베이스의 가용성에 영향을 미치는 컴퓨팅, 네트워크, 스토리지 오류 또는 전원 중단과 같은 인프라 오류가 포함됩니다. 데이터베이스를 사용할 수 없는 경우 대기 복제본에 대한 복제가 중단되고 대기 복제본이 주 데이터베이스 역할로 활성화됩니다. DNS가 업데이트되고 클라이언트가 데이터베이스 서버에 다시 연결되어 작업을 다시 시작합니다. 전반적인 장애 조치(failover) 시간에는 60~120초가 소요됩니다. 그러나 장애 조치(failover) 시의 주 데이터베이스 서버 활동(예: 대규모 트랜잭션 및 복구 시간)에 따라 장애 조치(failover)에 더 오랜 시간이 소요될 수 있습니다.

## <a name="schedule-maintenance-window"></a>유지 관리 기간 예약 

유연한 서버는 유지 관리 일정 기능을 제공하며, 이는 원하는 날에 30분의 시간을 선택하여 해당 시간 동안 패치 또는 부 버전 업그레이드와 같은 Azure 유지 관리 작업을 수행하도록 하는 작업입니다. 고가용성으로 구성된 유연한 서버에서는 먼저 대기 복제본에 대해 유지 관리 작업이 수행됩니다. 

## <a name="point-in-time-restore"></a>지정 시간 복원 
유연한 서버가 고가용성을 사용하여 데이터를 동기적으로 복제하도록 구성되었기 때문에 대기 서버는 주 서버를 통해 최신 상태로 유지됩니다. 주 서버에 사용자 오류(예: 실수로 인한 테이블 삭제 또는 잘못된 업데이트)가 발생하는 경우 대기 서버에 그대로 복제됩니다. 따라서 해당 논리 오류를 복구하는 데 대기 서버를 사용할 수 없습니다. 논리 오류를 복구하려면 오류가 발생하기 직전의 시점으로 특정 시점 복원을 수행해야 합니다. 유연한 서버의 특정 시점 복원 기능을 사용하여 고가용성으로 구성된 데이터베이스를 복원하면 사용자가 제공한 이름을 사용하는 새 데이터베이스 서버가 새 유연한 서버로 복원됩니다. 그런 다음 데이터베이스 서버에서 개체를 내보내 프로덕션 데이터베이스 서버로 가져올 수 있습니다. 마찬가지로, 테스트 및 개발 목적으로 데이터베이스 서버를 복제하거나 다른 용도로 복원하려는 경우 최신 복원 지점이나 사용자 지정 복원 지점을 선택할 수 있습니다. 복원 작업은 단일 영역의 유연한 서버를 만듭니다.

## <a name="mitigate-downtime"></a>가동 중지 시간 완화 
영역 중복 HA 기능을 사용하지 않는 경우에도 애플리케이션의 가동 중지 시간을 완화할 수 있어야 합니다. 예약된 패치, 부 버전 업그레이드 또는 사용자가 시작한 작업 등의 서비스 가동 중지 시간을 계획하는 작업은 예약된 유지 관리 기간의 일부로 수행할 수 있습니다. 예약된 패치, 부 버전 업그레이드 또는 사용자가 시작한 작업(예: 컴퓨팅 스케일링) 등의 계획된 서비스 가동 중지 시간은 가동 중지 시간을 야기합니다. Azure에서 시작된 유지 관리 작업의 애플리케이션에 대한 영향을 완화하기 위해 애플리케이션에 미치는 영향을 최소화하는 요일 및 시간에 작업을 수행하도록 예약할 수 있습니다. 

데이터베이스 크래시 또는 서버 오류와 같은 계획되지 않은 가동 중지 시간 이벤트 중에 영향을 받은 서버는 동일한 영역 내에서 다시 시작됩니다. 드문 경우지만 전체 지역이 영향을 받는 경우 지역 내의 다른 영역에 데이터베이스를 복원할 수 있습니다. 

## <a name="things-to-know-with-zone-redundancy"></a>영역 중복성에 대해 알아야 할 사항 

영역 중복 고가용성을 사용할 때 유의해야 할 몇 가지 고려 사항은 다음과 같습니다. 

- 고가용성은 유연한 서버를 만들 때 **만** 설정할 수 있습니다.
- 버스트 가능한 컴퓨팅 계층에서는 고가용성이 지원되지 않습니다.
- 다른 가용성 영역에 대한 동기 복제로 인해 주 데이터베이스 서버에서 쓰기 및 커밋 대기 시간이 증가할 수 있습니다.
- 읽기 전용 쿼리에는 대기 복제본을 사용할 수 없습니다.
- 장애 조치(failover) 시 주 서버의 활동에 따라 장애 조치(failover)를 완료하는 데 최대 60~120초 또는 그 이상이 소요될 수 있습니다.
- 정적 매개 변수 변경 내용을 선택하기 위해 주 데이터베이스 서버를 다시 시작하면 대기 복제본도 다시 시작됩니다.
- 영역 중복 고가용성 서버에 대한 읽기 복제본 구성은 지원되지 않습니다.
- 관리형 유지 관리 기간 동안에는 고객이 시작한 유지 관리 작업 구성을 자동화할 수 없습니다.
- 컴퓨팅 스케일링 및 부 버전 업그레이드와 같은 계획된 이벤트는 주 서버 및 대기 서버 모두에서 동시에 발생합니다. 


## <a name="next-steps"></a>다음 단계

- [비즈니스 연속성](./concepts-business-continuity.md)에 대한 자세한 정보
- [영역 중복 고가용성](./concepts-high-availability.md)에 대한 자세한 정보
- [백업 및 복구](./concepts-backup-restore.md)에 대한 자세한 정보