---
title: 마이크로 에이전트 이벤트 수집(미리 보기)
description: Defender for IoT 보안 에이전트는 로컬 디바이스에서 데이터 및 시스템 이벤트를 수집하고 처리 및 분석을 위해 데이터를 Azure 클라우드에 보냅니다.
ms.date: 07/15/2021
ms.topic: conceptual
ms.openlocfilehash: 6836c12f625645c5b9e0913f9d2f3f36fc06843e
ms.sourcegitcommit: ddac53ddc870643585f4a1f6dc24e13db25a6ed6
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/18/2021
ms.locfileid: "122538959"
---
# <a name="micro-agent-event-collection-preview"></a>마이크로 에이전트 이벤트 수집(미리 보기)

Defender for IoT 보안 에이전트는 로컬 디바이스에서 데이터 및 시스템 이벤트를 수집하고 처리 및 분석을 위해 데이터를 Azure 클라우드에 보냅니다. Defender for IoT 마이크로 에이전트는 새 프로세스 및 모든 새 연결 이벤트를 포함하여 다양한 유형의 디바이스 이벤트를 수집합니다. 새 프로세스와 새 연결 이벤트는 디바이스에서 1초 내에 여러 번 발생할 수도 있습니다. 이 기능은 포괄적인 보안을 위해 중요하지만, 보안 에이전트에서 전송하는 메시지 수가 빠르게 충족되거나 IoT Hub 할당량 및 비용 한도를 초과할 수 있습니다. 어떤 경우든 이러한 이벤트에는 디바이스를 보호하는 데 매우 중요한 보안 정보가 포함되어 있습니다. 

디바이스를 보호하면서 불필요한 할당량 및 비용을 줄이기 위해 Defender for IoT 에이전트는 해당 유형의 이벤트를 집계합니다. 

- ProcessCreate(Linux만 해당) 

- Network ConnectionCreate

- 시스템 정보

- 기초

이벤트 기반 수집기는 디바이스 내에서 해당 작업을 기반으로 트리거되는 수집기입니다. 예를 들어 디바이스에서 프로세스가 시작되었습니다.  

트리거 기반 수집기는 고객의 구성에 따라 예약된 방식으로 트리거되는 수집기입니다.

## <a name="how-does-event-aggregation-work"></a>이벤트 집계는 어떻게 작동하나요? 

Defender for IoT 에이전트는 간격 또는 기간에 대한 이벤트를 집계합니다. 간격 지나면 에이전트는 추가 분석을 위해 집계된 이벤트를 Azure 클라우드로 보냅니다. 집계된 이벤트는 Azure 클라우드로 전송될 때까지 메모리에 저장됩니다. 

에이전트는 이미 메모리에 저장된 이벤트와 동일한 이벤트를 수집합니다. 이 수집으로 인해 에이전트는 이 특정 이벤트의 적중 횟수를 늘려 에이전트의 메모리 공간을 줄입니다. 집계 기간이 지나면 에이전트는 발생한 이벤트 유형 각각에 대한 적중 횟수를 보냅니다. 이벤트 집계는 수집된 각 이벤트 유형의 적중 횟수에 대한 집계일 뿐입니다. 

## <a name="process-events-event-based"></a>프로세스 이벤트(이벤트 기반)

프로세스 이벤트는 Linux 운영 체제에서 지원됩니다. 

‘명령줄’과  *userid* 가 동일할 때 프로세스 이벤트는 동일하다고 간주됩니다. 

프로세스 이벤트의 기본 버퍼는 256개 프로세스입니다. 이 제한에 도달하면 버퍼가 순환되고 가장 최근에 처리된 이벤트를 위한 공간을 만들기 위해 가장 오래된 이벤트가 삭제됩니다. 캐시 크기를 늘리라는 경고가 기록됩니다.

### <a name="data-collection"></a>데이터 수집

각 이벤트에 대해 수집된 데이터:

- **타임스탬프** - 프로세스가 처음으로 관찰된 시간입니다.

- **Process_id** - Linux PID입니다.

- **Parent_process_id** - Linux 상위 PID(있는 경우)입니다.

- **명령줄** - 명령줄입니다. 

- **유형** - `fork` 또는 `exec`일 수 있습니다.

- **hit_count** - 집계 수입니다. 이벤트가 클라우드로 전송될 때까지 동일한 시간 프레임 동안 동일한 프로세스의 실행 수입니다. 

## <a name="network-connection-events-event-based-collector"></a>네트워크 연결 이벤트(이벤트 기반 수집기)

네트워크 연결 이벤트는 로컬 포트, 원격 포트, 전송 프로토콜, 로컬 주소, 원격 주소가 동일할 때 동일한 것으로 간주됩니다.

네트워크 연결 이벤트의 기본 버퍼는 256개입니다. 캐시가 가득 찬 경우: 

- **Azure RTOS 디바이스**: 새 네트워크 이벤트는 다음 수집 주기까지 캐시되지 않으며  

- **Linux 디바이스**: 가장 오래된 이벤트가 모든 새 이벤트로 대체됩니다. 캐시 크기를 늘리라는 경고가 기록됩니다.

Linux 디바이스의 경우 IPv4만 지원됩니다.

### <a name="data-collection"></a>데이터 수집

각 이벤트에 대해 수집된 데이터:

- **로컬 주소** – 연결의 원본 주소입니다.

- **원격 주소** – 연결의 대상 주소입니다.

- **로컬 포트** - 연결의 원본 포트입니다.

- **원격 포트** - 연결의 대상 포트입니다.

- **Bytes_in** – 연결의 집계된 총 RX 바이트입니다.

- **Bytes_out** – 연결의 집계된 총 TX 바이트입니다.

- **Transport_protocol** – TCP, UDP 또는 ICMP일 수 있습니다.

- **애플리케이션 프로토콜** – 연결과 관련된 애플리케이션 프로토콜입니다.

- **확장 속성** – 연결에 대한 추가 세부 정보입니다. `host name`)을 입력합니다. 

## <a name="baseline-trigger-based"></a>기준선(트리거 기반) 

기준 수집기는 주기적으로 CIS 검사를 수행합니다. 실패한 결과만 클라우드로 전송됩니다. 클라우드는 결과를 집계하고 권장 사항을 제공합니다. 

### <a name="data-collection"></a>데이터 수집

각 이벤트에 대해 수집된 데이터:

- **검사 ID** – CIS 형식으로, CIS-debian-9-Filesystem-1.1.2입니다.

- **검사 결과** - `Error` 또는 `Fail`일 수 있습니다. 예를 들어, 검사를 실행할 수 없는 상황에서는 `Error`입니다.

- **오류** - 오류 정보 및 설명입니다.

- **설명** - CIS의 검사에 대한 설명입니다.

- **수정** - CIS의 수정 권장 사항입니다.

## <a name="next-steps"></a>다음 단계

[Defender for IoT 보안 경고](concept-security-alerts.md)를 확인합니다.
