---
title: Azure Database for MySQL 영역 중복 HA - 유연한 서버
description: Azure Database for MySQL - 유연한 서버에서 영역 중복 고가용성의 개념적 개요를 확인합니다.
author: SudheeshGH
ms.author: sunaray
ms.service: mysql
ms.topic: conceptual
ms.date: 08/26/2021
ms.openlocfilehash: 276bcd288f519a5060f859bf6b5a74c0453e7c79
ms.sourcegitcommit: 611b35ce0f667913105ab82b23aab05a67e89fb7
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/14/2021
ms.locfileid: "129994065"
---
# <a name="high-availability-in-azure-database-for-mysql---flexible-server-preview"></a>Azure Database for MySQL 고가용성 - 유연한 서버 미리 보기

[!INCLUDE[applies-to-mysql-flexible-server](../includes/applies-to-mysql-flexible-server.md)]

> [!IMPORTANT] 
> Azure Database for MySQL - 유연한 서버는 현재 공개 미리 보기로 제공됩니다.

Azure Database for MySQL - 유연한 서버 미리 보기를 사용하면 자동 장애 조치(failover)를 사용하여 HA(고가용성)를 구성할 수 있습니다. 고가용성 솔루션은 커밋된 데이터가 오류로 인해 손실되지 않도록 하고 데이터베이스가 소프트웨어 아키텍처에서 단일 실패 지점이 되지 않도록 설계되었습니다. 고가용성이 구성되면 유연한 서버는 대기 복제본을 자동으로 프로비전하고 관리합니다. 고가용성을 위한 두 가지 아키텍처 모델이 있습니다.

* **영역 중복 HA**. 이 옵션은 여러 가용성 영역에서 인프라의 완전한 격리 및 중복성을 위해 선호됩니다. 최고 수준의 가용성을 제공하지만 영역 간에 애플리케이션 중복성을 구성해야 합니다. 가용성 영역의 인프라 오류에 대해 가장 높은 수준의 가용성을 달성하려는 경우와 가용성 영역 간의 대기 시간이 허용되는 경우 영역 중복 HA가 선호됩니다. 서버를 만들 때만 사용하도록 설정할 수 있습니다. 영역 중복 HA는 지역에서 여러 [가용성 영역을](../../availability-zones/az-overview.md) 지원하고 영역 중복 Premium [파일 공유를](../..//storage/common/storage-redundancy.md#zone-redundant-storage) 사용할 수 있는 [Azure 지역의 하위 집합에서](./overview.md#azure-regions) 사용할 수 있습니다.

* **동일한 영역 HA**. 이 옵션은 기본 및 대기 서버가 동일한 가용성 영역에 있기 때문에 네트워크 대기 시간이 짧은 인프라 중복에 선호됩니다. 영역 간에 애플리케이션 중복성을 구성할 필요 없이 고가용성을 제공합니다. 네트워크 대기 시간이 가장 낮은 단일 가용성 영역 내에서 가장 높은 수준의 가용성을 달성하려는 경우 동일한 영역 HA가 선호됩니다. 동일한 영역 HA는 Azure Database for MySQL - 유연한 서버를 사용할 수 있는 모든 [Azure 지역에서](./overview.md#azure-regions) 사용할 수 있습니다.  

## <a name="zone-redundant-ha-architecture"></a>영역 중복 HA 아키텍처
 
영역 중복 HA가 있는 서버를 배포하면 다음 두 개의 서버가 만들어집니다. 
- 하나의 가용성 영역에 있는 주 서버
- 동일한 Azure 지역의 다른 가용성 영역에서 주 서버(컴퓨팅 계층, 컴퓨팅 크기, 스토리지 크기 및 네트워크 구성)와 동일한 구성을 가진 대기 복제본 서버
 
주 복제본과 대기 복제본에 대한 가용성 영역을 선택할 수 있습니다. 대기 데이터베이스 서버와 대기 애플리케이션을 동일한 영역에 배치하면 대기 시간이 줄어듭니다. 또한 재해 복구 상황 및 "영역 축소" 시나리오에 더 잘 대비할 수 있습니다.

:::image type="content" source="./media/concepts-high-availability/1-flexible-server-overview-zone-redundant-ha.png" alt-text="영역 중복 고가용성을 위한 아키텍처를 보여 주는 다이어그램":::

데이터 및 로그 파일은 [ZRS(영역 중복 스토리지)](../../storage/common/storage-redundancy.md#redundancy-in-the-primary-region)에서 호스트됩니다. 이러한 파일은 ZRS에서 사용할 수 있는 스토리지 수준 복제를 통해 대기 서버에 복제됩니다. 장애 조치(failover)가 있는 경우: 
- 대기 복제본이 활성화됩니다. 
- 주 서버의 이진 로그 파일은 대기 서버에 계속 적용하여 주 서버에서 마지막으로 커밋된 트랜잭션에 온라인으로 가져옵니다. 

주 서버를 사용할 수 없는 경우에도 ZRS의 로그에 액세스할 수 있습니다. 이 가용성은 데이터 손실이 없도록 하는 데 도움이 됩니다. 대기 복제본이 활성화되고 이진 로그가 적용된 후 현재 대기 복제본 서버는 주 서버의 역할을 맡습니다. 클라이언트가 다시 연결될 때 클라이언트 연결이 새 주 서버로 연결되도록 DNS가 업데이트됩니다. 장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 아무 작업도 필요하지 않습니다. 그런 다음 HA 솔루션은 가능한 경우 이전 주 서버를 다시 가져와서 대기로 배치합니다.
 
데이터베이스 서버 이름은 주 서버에 애플리케이션을 연결하는 데 사용됩니다. 대기 복제본 정보는 직접 액세스를 위해 노출되지 않습니다. 커밋 및 쓰기는 주 서버의 ZRS에서 로그 파일이 플러시된 후 승인됩니다. ZRS 스토리지에 사용되는 동기화 복제 기술로 인해 애플리케이션 쓰기 및 커밋에 대한 대기 시간이 5-10% 증가할 것으로 예상할 수 있습니다.
 
스냅샷 및 로그 백업 모두 자동 백업은 주 데이터베이스 서버의 영역 중복 스토리지에서 수행됩니다.

## <a name="same-zone-ha-architecture"></a>동일한 영역 HA 아키텍처
 
동일한 영역 HA를 사용하여 서버를 배포하면 동일한 영역에 두 개의 서버가 만들어집니다. 
- 주 서버
- 주 서버와 구성이 동일한 대기 복제본 서버(컴퓨팅 계층, 컴퓨팅 크기, 스토리지 크기 및 네트워크 구성) 

대기 서버는 별도의 가상 머신(컴퓨팅)을 사용하여 인프라 중복성을 제공합니다. 이러한 중복성을 통해 애플리케이션과 데이터베이스 서버 간의 장애 조치(failover) 시간 및 네트워크 대기 시간이 줄어듭니다.

:::image type="content" source="./media/concepts-high-availability/flexible-server-overview-same-zone-ha.png" alt-text="동일한 영역 고가용성을 위한 아키텍처를 보여 주는 다이어그램.":::

데이터 및 로그 파일은 [LRS(로컬 중복 스토리지)](../../storage/common/storage-redundancy.md#locally-redundant-storage)에 호스트됩니다. 이러한 파일은 LRS에서 사용할 수 있는 스토리지 수준 복제를 통해 대기 서버에 복제됩니다.

장애 조치(failover)가 있는 경우: 
- 대기 복제본이 활성화됩니다. 
- 주 서버의 이진 로그 파일은 대기 서버에 계속 적용하여 주 서버에서 마지막으로 커밋된 트랜잭션에 온라인으로 가져옵니다. 

주 서버를 사용할 수 없는 경우에도 LRS의 로그에 액세스할 수 있습니다. 이 가용성은 데이터 손실이 없도록 하는 데 도움이 됩니다. 대기 복제본이 활성화되고 이진 로그가 적용된 후에는 현재 대기 복제본이 주 서버의 역할을 맡습니다. DNS는 클라이언트가 다시 연결될 때 새 주 서버로 연결을 리디렉션하도록 업데이트됩니다. 장애 조치(failover)는 클라이언트 애플리케이션에서 완전히 투명하며 아무 작업도 필요하지 않습니다. 그런 다음 HA 솔루션은 가능한 경우 이전 주 서버를 다시 가져와서 대기로 배치합니다.
 
데이터베이스 서버 이름은 주 서버에 애플리케이션을 연결하는 데 사용됩니다. 대기 복제본 정보는 직접 액세스를 위해 노출되지 않습니다. 커밋 및 쓰기는 주 서버의 LRS에서 로그 파일이 플러시된 후 승인됩니다. 주 복제본과 대기 복제본이 동일한 영역에 있기 때문에 애플리케이션 서버와 데이터베이스 서버 간의 복제 지연 시간이 줄어들고 대기 시간이 낮아집니다. 종속 인프라가 특정 가용성 영역에 대해 다운된 경우 동일한 영역 설정은 고가용성을 제공하지 않습니다. 모든 종속 서비스가 해당 가용성 영역에 대해 다시 온라인이 될 때까지 가동 중지 시간이 있습니다.
 
스냅샷 및 로그 백업 모두 자동 백업은 주 데이터베이스 서버의 로컬 중복 스토리지에서 수행됩니다.

>[!Note]
>영역 중복 및 동일한 영역 HA의 경우:
>* 오류가 발생하면 대기 복제본이 주 복제본의 역할을 인수하는 데 필요한 시간은 대기 중인 이진 로그 애플리케이션에 따라 달라집니다. 따라서 장애 조치(failover) 시간을 줄이기 위해 모든 테이블에서 기본 키를 사용하는 것이 좋습니다. 장애 조치(failover) 시간은 일반적으로 60초에서 120초 사이입니다. 
>* 대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없습니다. 빠른 장애 조치(failover)를 사용하도록 설정하는 수동 대기입니다.
>* 항상 FQDN(정규화된 도메인 이름)을 사용하여 주 서버에 연결합니다. IP 주소를 사용하여 연결하지 않습니다. 장애 조치(failover)가 있는 경우 주 및 대기 서버 역할이 전환된 후 DNS A 레코드가 변경될 수 있습니다. 이러한 변경으로 인해 연결 문자열에 IP 주소가 사용되는 경우 애플리케이션이 새 주 서버에 연결되지 않습니다.

## <a name="failover-process"></a>장애 조치(failover) 프로세스 
 
### <a name="planned-forced-failover"></a>계획: 강제 장애 조치(failover)
 
Azure Database for MySQL - 유연한 서버 강제 장애 조치(failover)를 사용하면 수동으로 장애 조치(failover)를 강제 적용할 수 있습니다. 이 기능을 사용하면 애플리케이션 시나리오에서 기능을 테스트하고 가동 중단을 대비할 수 있습니다. 

강제 장애 조치(failover)는 DNS 레코드를 업데이트하여 대기 복제본이 동일한 데이터베이스 서버 이름의 주 서버가 되도록 활성화하는 장애 조치(failover)를 트리거합니다. 원래 주 서버가 다시 시작되고 대기 복제본으로 전환됩니다. 클라이언트 연결이 끊어지고 작업을 다시 시작하려면 다시 연결해야 합니다. 

전체 장애 조치(failover) 시간은 현재 워크로드 및 마지막 검사점에 따라 달라집니다. 일반적으로 60초에서 120초 사이가 소요될 것으로 예상됩니다.
 
### <a name="unplanned-automatic-failover"></a>계획되지 않은 경우: 자동 장애 조치(failover) 
 
계획되지 않은 서비스 가동 중지 시간은 소프트웨어 버그 또는 컴퓨팅, 네트워크 또는 스토리지 오류와 같은 인프라 오류 또는 데이터베이스의 가용성에 영향을 주는 정전으로 인해 발생할 수 있습니다. 데이터베이스를 사용할 수 없게 되면 대기 복제본에 대한 복제가 끊어지고 대기 복제본이 주 데이터베이스로 활성화됩니다. DNS가 업데이트되고 클라이언트가 데이터베이스 서버에 다시 연결하여 작업을 다시 시작합니다. 

전체 장애 조치(failover) 시간은 60초에서 120초 사이여야 합니다. 그러나 장애 조치(failover) 시 주 데이터베이스 서버의 작업(예: 대용량 트랜잭션 및 복구 시간)에 따라 장애 조치(failover)가 더 오래 걸릴 수 있습니다.

## <a name="monitoring-for-high-availability"></a>고가용성 모니터링
HA의 상태가 지속적으로 모니터링되고 개요 페이지에 보고됩니다. 복제 상태는 다음과 같습니다.

| **Status** | **설명** |
| :----- | :------ |
| **NotEnabled** | 영역 중복 HA는 사용하도록 설정되지 않습니다. |
| **ReplicatingData** | 대기는 생성 된 후 주 서버를 사용 하 여 생성 됩니다. |
| **장애 조치 (failover)** | 데이터베이스 서버가 주 서버에서 대기 서버로 장애 조치(failover)를 진행하는 중입니다. |
| **정상** | 영역 중복 HA는 안정 된 상태 이며 정상 상태입니다. |
| **RemovingStandby** | 사용자가 대기 복제본을 삭제 하 고 삭제를 처리 하 고 있습니다.| 

##  <a name="limitations"></a>제한 사항 
 
고가용성을 사용할 때 유의 해야 할 몇 가지 고려 사항은 다음과 같습니다.
* 영역 중복 고가용성은 유연한 서버를 만들 때만 설정할 수 있습니다.
* 높은 가용성은 삼 간에 증가 하는 계산 계층에서 지원 되지 않습니다.
* 고정적인 매개 변수 변경 내용을 선택하기 위해 주 데이터베이스 서버를 다시 시작하면 대기 복제본도 다시 시작됩니다.
* HA 서버에 대 한 읽기 복제본은 지원 되지 않습니다.
* 입력 데이터 복제 HA 서버에 대해 지원 되지 않습니다.
* GTID 모드는 HA 솔루션에서 GTID를 사용 하므로 켜 집니다. 작업에 [GTIDs를 사용 하 여 복제에 대 한 제한 또는 제한이](https://dev.mysql.com/doc/refman/5.7/en/replication-gtids-restrictions.html)있는지 확인 합니다.  
 
## <a name="frequently-asked-questions-faq"></a>질문과 대답(FAQ)
 
**읽기 또는 쓰기 작업에 대기 복제본을 사용할 수 있나요?** </br>
대기 서버는 읽기 또는 쓰기 작업에 사용할 수 없습니다. 빠른 장애 조치 (failover)를 사용 하도록 설정 하는 수동 대기 상태입니다.</br>
**장애 조치 (failover)가 발생 하는 경우 데이터 손실이 있나요?**</br>
주 서버를 사용할 수 없는 경우에도 ZRS의 로그에 액세스할 수 있습니다. 이 가용성은 데이터가 손실 되지 않도록 하는 데 도움이 됩니다. 대기 복제본이 활성화 되 고 이진 로그가 적용 된 후에는 주 서버의 역할을 수행 합니다. </br>
**장애 조치 (failover) 후 작업을 수행 해야 하나요?**</br>
장애 조치 (failover)는 클라이언트 응용 프로그램에서 완전히 투명 합니다. 아무 작업도 수행할 필요가 없습니다. 응용 프로그램은 연결에 다시 시도 논리를 사용 해야 합니다. </br>
**대기 중인 복제본에 대해 특정 영역을 선택 하지 않으면 어떻게 되나요? 나중에 영역을 변경할 수 있나요?**</br>
영역을 선택 하지 않으면 임의로 선택 됩니다. 주 서버에 사용 되는 것은 아닙니다. 나중에 영역을 변경 하려면 **고가용성 창에서** 고가용성을 **사용 안 함으로** **설정 하 고** 다시 **영역 중복** 으로 설정 하 여 영역을 선택 합니다.</br>
**주 복제본과 대기 복제본 간 복제가 동기화 되나요?**</br>
 주와 대기 간의 복제는 MySQL의 [동기 모드](https://dev.mysql.com/doc/refman/5.7/en/replication-semisync.html) 와 비슷합니다. 트랜잭션이 커밋되면 대기 상태에 커밋할 필요가 없습니다. 그러나 주 복제본을 사용할 수 없는 경우 대기는 데이터 손실이 없는지 확인 하기 위해 주 복제본의 모든 데이터 변경 내용을 복제 합니다.</br> 
**계획 되지 않은 모든 실패에 대 한 대기 복제본에 대 한 장애 조치 (failover)가 있나요?**</br>
데이터베이스 충돌 또는 노드 오류가 발생 하는 경우에는 동일한 노드에서 유연한 서버 VM이 다시 시작 됩니다. 동시에 자동 장애 조치(failover)가 트리거됩니다. 장애 조치 (failover)가 완료 되기 전에 유연한 서버 VM 다시 시작이 성공적으로 수행 되 면 장애 조치 (failover) 작업이 취소 됩니다. 주 복제본으로 사용할 서버를 결정 하는 것은 먼저 완료 되는 프로세스에 따라 달라 집니다.</br>
**HA를 사용할 때 성능에 영향이 있나요?**</br>
영역 중복 HA의 경우 응용 프로그램이 네트워크 대기 시간이 상대적으로 높은 (2-4 밀리초) 가용성 영역에서 데이터베이스 서버에 연결 하는 경우 대기 시간이 5-10% 감소 될 수 있습니다. 동일한 영역 HA의 경우 주 복제본과 대기 복제본이 동일한 영역에 있기 때문에 복제 지연 시간이 줄어듭니다. 응용 프로그램 서버와 데이터베이스 서버는 동일한 Azure 가용성 영역에 있는 경우 대기 시간이 줄어듭니다.</br>
**HA 서버의 유지 관리는 어떻게 되나요?**</br>
계산 및 부 버전 업그레이드와 같은 계획 된 이벤트는 주 및 대기에서 동시에 발생 합니다. 유연한 서버와 마찬가지로 HA 서버에 대해 [예약 된 유지 관리 기간](./concepts-maintenance.md) 을 설정할 수 있습니다. HA를 사용 하지 않도록 설정 하면 가동 중지 시간이 Azure Database for MySQL 유연한 서버에 대 한 가동 중지 시간과 동일 하 게 됩니다. 장애 조치 (failover) 메커니즘을 사용 하 여 HA 서버의 가동 중지 시간을 줄이는 것은 곧 제공 될 예정 이며 곧 제공 될 예정입니다. </br>
**HA 서버의 특정 시점 복원 (PITR)을 수행할 수 있나요?**</br>
Ha를 사용 하는 Azure Database for MySQL 유연한 서버에 대해 ha를 사용 하지 않도록 설정 된 새 Azure Database for MySQL 유연한 서버에 대해 [PITR](./concepts-backup-restore.md#point-in-time-restore) 를 수행할 수 있습니다. 영역 중복 HA를 사용 하 여 원본 서버를 만든 경우 나중에 복원 된 서버에서 영역 중복 HA 또는 동일한 영역 HA를 사용 하도록 설정할 수 있습니다. 동일한 영역 HA를 사용 하 여 원본 서버를 만든 경우 복원 된 서버 에서만 동일한 영역 HA를 사용 하도록 설정할 수 있습니다.</br>
**서버를 만든 후 서버에서 HA를 사용 하도록 설정할 수 있나요?**</br>
서버를 만들 때 영역 중복 HA를 사용 하도록 설정 해야 합니다. 서버를 만든 후 동일한 영역 HA를 사용 하도록 설정할 수 있습니다. 동일한 영역 HA를 사용 하도록 설정 하기 전에 서버 매개 변수 enforce_gtid_consistency "및 [" gtid_mode "](./concepts-read-replicas.md#global-transaction-identifier-gtid)  가 ON으로 설정 되어 있는지 확인 합니다.</br> 
**서버를 만든 후 HA를 사용 하지 않도록 설정할 수 있나요?** </br>
서버를 만든 후에는 서버에서 HA를 사용 하지 않도록 설정할 수 있습니다. 청구는 즉시 중지 됩니다.  </br>
**가동 중지 시간을 완화 하려면 어떻게 해야 하나요?**</br>
HA를 사용 하 고 있지 않은 경우에도 응용 프로그램의 가동 중지 시간을 완화할 수 있어야 합니다. 예약 된 유지 관리 기간에는 예약 된 패치, 부 버전 업그레이드, 고객 시작 작업 등의 서비스 가동 중지 시간이 예약 된 유지 관리 기간 동안 수행할 수 있습니다. Azure에서 시작 된 유지 관리 작업의 응용 프로그램 영향을 완화 하기 위해 응용 프로그램에 미치는 영향을 최소화 하는 요일 및 시간을 예약할 수 있습니다.</br>
**HA 사용 서버에 대 한 읽기 복제본을 사용할 수 있나요?**</br>
HA 서버에 대 한 읽기 복제본은 지원 되지 않습니다. 이 기능은 로드맵에 있으며 곧 사용할 수 있도록 노력 하 고 있습니다.</br>
**HA 서버에 입력 데이터 복제를 사용할 수 있나요?**</br>
입력 데이터 복제 HA 서버에 대해 지원 되지 않습니다. 그러나 HA 서버에 대 한 입력 데이터 복제은 로드맵에 있으며 곧 제공 될 예정입니다. 지금은 마이그레이션을 위해 입력 데이터 복제를 사용 하려는 경우 다음 단계를 수행할 수 있습니다.
1. 영역 중복 HA를 사용 하도록 설정 된 서버를 만듭니다.
1. HA를 사용 하지 않습니다.
1. [입력 데이터 복제을 설정](./concepts-data-in-replication.md)하는 단계를 완료 합니다.  `gtid_mode`원본 서버와 대상 서버에 동일한 설정이 있어야 합니다.
1. Post cutovers 입력 데이터 복제 구성을 제거 합니다.
1. HA를 사용 하도록 설정 합니다.

**가동 중지 시간을 줄이기 위해 서버를 다시 시작 하거나 규모를 확장 또는 축소 하는 동안 대기 서버로 장애 조치 (failover) 할 수 있나요?** </br>
현재, 수직 확장 또는 규모 축소 작업을 수행할 때 대기 및 주 복제본은 동시에 크기 조정 됩니다. 따라서 장애 조치 (failover)는 도움이 되지 않습니다. 먼저 대기 상태를 확장 하 고 장애 조치 (failover)를 수행한 다음 주 복제본을 확장 하는 것은 로드맵에 있지만 아직 지원 되지 않습니다.</br>

**서버에 대 한 가용성 모드 (영역 중복 HA/동일한 영역)를 변경할 수 있습니다.** </br>
영역 중복 HA 모드를 사용 하는 서버를 만드는 경우 영역 중복 HA에서 동일한 영역으로 또는 그 반대로 변경할 수 있습니다. 가용성 모드를 변경 하려면 **고가용성 창에서** 고가용성을 **사용 안 함으로** 설정한 다음 **영역 중복 또는 동일한 영역** 으로 다시 **설정 하 고** 고가용성 **모드** 를 선택 하면 됩니다.</br>  

## <a name="next-steps"></a>다음 단계

- [비즈니스 연속성](./concepts-business-continuity.md)에 대해 알아봅니다.
- [영역 중복 고가용성](./concepts-high-availability.md)에 대해 알아봅니다.
- [백업 및 복구](./concepts-backup-restore.md)에 대해 알아봅니다.
