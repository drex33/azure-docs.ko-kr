---
title: Azure 파일 동기화를 사용한 재해 복구 모범 사례
description: Azure 파일 동기화를 사용한 재해 복구 모범 사례에 관해 알아봅니다. 특히, 고가용성, 데이터 보호, 데이터 중복성을 알아봅니다.
author: roygara
ms.service: storage
ms.topic: how-to
ms.date: 08/18/2021
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: 87fd5de90896a1a5b97cf9fa07a880ebcea1f35b
ms.sourcegitcommit: 34aa13ead8299439af8b3fe4d1f0c89bde61a6db
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/18/2021
ms.locfileid: "122538998"
---
# <a name="best-practices-for-disaster-recovery-with-azure-file-sync"></a>Azure 파일 동기화를 사용한 재해 복구 모범 사례

Azure 파일 동기화의 경우 재해 복구를 위해 세 가지 주요 영역인 고가용성, 데이터 보호/백업, 데이터 중복성을 고려해야 합니다. 이 문서에서는 각 영역을 다루며 자체 재해 복구 솔루션에 사용할 구성을 결정할 수 있습니다.

Azure 파일 동기화 배포에서 클라우드 엔드포인트는 항상 데이터의 전체 복사본을 포함하지만 온-프레미스 서버는 데이터의 삭제 가능한 캐시로 볼 수 있습니다. 서버 쪽 재해가 발생하는 경우 새 서버를 프로비저닝하고, Azure 파일 동기화 에이전트를 설치하고, 새 서버 엔드포인트로 설정하여 복구할 수 있습니다.

하이브리드 특성으로 인해 일부 기존 서버 백업 및 재해 복구 전략은 Azure 파일 동기화를 사용하지 않습니다. 등록된 서버의 경우 Azure 파일 동기화는 다음을 지원하지 않습니다.

> [!WARNING]
> 이러한 작업을 수행하면 최종적으로 데이터가 손실되는 동기화 또는 계층화 손상 파일 관련 문제가 발생할 수 있습니다. 해당 작업 중 하나를 수행한 경우 Azure 지원에 문의하여 배포가 정상 상태인지 확인하세요.

- 서버 간에 디스크 드라이브 전송
- 운영 체제 백업에서 복원
- 서버 운영 체제를 다른 서버에 복제
- 이전 가상 머신 검사점으로 되돌리기
- 클라우드 계층화를 사용하는 경우 온-프레미스 백업에서 파일 복원


## <a name="high-availability"></a>고가용성

온-프레미스 서버의 고가용성을 획득하는 데 사용할 수 있는 두 가지 전략이 있습니다. 장애 조치(failover) 클러스터를 구성하거나 대기 서버를 구성할 수 있습니다. 구성을 결정하는 요인은 시스템에 투자할 의지가 어느 정도인지와 재해가 발생하는 경우 시스템이 다운되는 시간을 최소화하는 것에 추가 비용의 가치가 있는지 여부입니다.

장애 조치 클러스터의 경우 Azure 파일 동기화를 사용하기 위해 특별한 단계를 수행하지 않아도 됩니다. 대기 서버의 경우 다음과 같이 구성해야 합니다.

주 서버와 동일한 동기화 그룹에 동기화되는 여러 서버 엔드포인트가 있는 보조 서버를 포함하지만 최종 사용자가 서버에 액세스하도록 설정하지 않습니다. 이렇게 하면 모든 파일이 주 서버에서 대기 서버로 동기화될 수 있습니다. 처음에 네임스페이스만 다운로드되도록 네임스페이스 전용 계층화 사용을 고려할 수 있습니다. 주 서버가 실패하면 DFS-N을 사용하여 대기 서버에 대한 최종 사용자 액세스를 빠르게 다시 구성할 수 있습니다.

## <a name="data-protectionbackup"></a>데이터 보호/백업

실제 데이터를 보호하는 것은 재해 복구 솔루션의 핵심 구성 요소입니다. Azure 파일 공유를 사용하여 이 작업을 수행하는 두 가지 주요 방법이 있습니다. 클라우드 또는 온-프레미스에서 데이터를 백업할 수 있습니다. 클라우드 엔드포인트는 데이터의 전체 복사본을 포함하지만 서버 엔드포인트는 데이터의 하위 집합만 포함할 수 있으므로 클라우드에서 데이터를 백업하는 것이 좋습니다.

### <a name="back-up-your-data-in-the-cloud"></a>클라우드에서 데이터 백업

클라우드 백업 솔루션으로 [Azure Backup](../../backup/azure-file-share-backup-overview.md?toc=%2fazure%2fstorage%2ffile-sync%2ftoc.json)을 사용해야 합니다. Azure Backup은 무엇보다 백업 일정 예약, 보존, 복원을 처리합니다. 원하는 경우 [공유 스냅샷](../files/storage-snapshots-files.md?toc=/azure/storage/file-sync/toc.json)을 생성하고 자체 일정 예약 및 보존 솔루션을 구성할 수 있지만 이는 적합하지 않습니다. 또는 타사 솔루션을 사용하여 Azure 파일 공유를 직접 백업할 수 있습니다.

재해가 발생하는 경우 파일 공유의 특정 시점 읽기 전용 복사본인 공유 스냅샷에서 복원할 수 있습니다. 이 스냅샷은 읽기 전용이므로 랜섬웨어의 영향을 받지 않습니다. 전체 공유 복원 작업에 오랜 시간이 걸리는 대규모 데이터 세트의 경우 복원이 완료되는 동안 사용자가 필요한 데이터를 로컬 드라이브에 복사할 수 있도록 스냅샷에 대한 직접 사용자 액세스를 사용하도록 설정할 수 있습니다.

스냅샷을 수동으로 생성하거나 Azure Backup이 스냅샷을 생성하는지 여부와 관계없이 스냅샷은 Azure 파일 공유에 직접 저장됩니다. 따라서 파일 공유를 실수로 삭제하지 않도록 스냅샷을 보호하려면 [일시 삭제를 사용](../files/storage-files-prevent-file-share-deletion.md?toc=/azure/storage/file-sync/toc.json)해야 합니다.

자세한 내용은 [Azure 파일 공유 백업 정보](../../backup/azure-file-share-backup-overview.md)를 참조하거나 백업 공급자에게 문의하여 Azure 파일 공유 백업을 지원하는지 확인하세요.

### <a name="back-up-your-data-on-premises"></a>온-프레미스에서 데이터 백업

클라우드 계층화를 사용하는 경우 온-프레미스 백업 솔루션을 구현하지 마세요. 클라우드 계층화를 사용하면 데이터의 하위 집합만 서버에 로컬로 저장되고 나머지 데이터는 클라우드 엔드포인트에 저장됩니다. 로컬 백업에 사용하는 백업 솔루션에 따라 계층화된 파일은 건너뛰고 백업되지 않아(FILE_ATTRIBUTE_RECALL_ONDATA_ACCESS 특성으로 인해) 계층화된 파일로만 백업되고 라이브 공유의 변경으로 인해 복원 시 액세스할 수 없거나, 디스크에 회수되어 송신 요금이 높아집니다.

온-프레미스 백업 솔루션을 사용하려는 경우에는 클라우드 계층화가 사용되지 않는 동기화 그룹의 서버에서 백업을 수행해야 합니다. 복원을 수행할 때 볼륨 수준 또는 파일 수준 복원 옵션을 사용합니다. 파일 수준 복원 옵션을 사용하여 복원된 파일은 동기화 그룹의 모든 엔드포인트에 동기화되고 기존 파일은 백업에서 복원된 버전으로 대체됩니다. 볼륨 수준 복원은 클라우드 엔드포인트나 다른 서버 엔드포인트의 최신 파일 버전을 대체하지 않습니다.

Azure 파일 동기화 버전 9 이상에서 [VSS(볼륨 섀도 복사본 서비스) 스냅샷](file-sync-deployment-guide.md#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service)(**이전 버전** 탭 포함)은 클라우드 계층화가 사용되는 볼륨에서 지원됩니다. 이 기능을 사용하여 관리자를 통해 복원을 수행하는 대신 셀프 서비스 복원을 수행할 수 있습니다. 그러나 PowerShell을 통해 이전 버전 호환성을 사용하도록 설정해야 하며 이로 인해 스냅샷 스토리지 비용이 증가합니다. VSS 스냅샷은 서버 엔드포인트 자체에서 재해로부터 보호되지 않으므로 클라우드 쪽 백업과 함께 사용해야 합니다. 자세한 내용은 [이전 버전 및 VSS를 통한 셀프 서비스 복원](file-sync-deployment-guide.md#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service)을 참조하세요.

## <a name="data-redundancy"></a>데이터 중복성

강력한 재해 복구 솔루션을 보장하려면 특정 형태의 데이터 중복성을 인프라에 추가합니다. Azure Files를 위한 네 가지 중복성 제품은 [LRS(로컬 중복 스토리지)](../common/storage-redundancy.md#locally-redundant-storage), [ZRS(영역 중복 스토리지)](../common/storage-redundancy.md#zone-redundant-storage), [GRS(지역 중복 스토리지)](../common/storage-redundancy.md#geo-redundant-storage), [GZRS(지역 영역 중복 스토리지)](../common/storage-redundancy.md#geo-zone-redundant-storage)입니다.

- [LRS(로컬 중복 스토리지)](../common/storage-redundancy.md#locally-redundant-storage): LRS를 사용하면 모든 파일이 Azure Storage 클러스터 내에서 세 번 저장됩니다. 이는 불량 디스크 드라이브와 같은 하드웨어 오류로 인한 데이터 손실을 방지합니다. 그러나 데이터 센터 내에서 화재나 홍수와 같은 재해가 발생하는 경우 LRS를 사용하는 저장소 계정의 모든 복제본이 손실되거나 복구할 수 없게 됩니다.
- ‘ZRS(영역 중복 스토리지)’: ZRS를 사용하면 각 파일의 복사본 세 개가 저장되지만 해당 복사본은 서로 다른 Azure [가용성 영역](../common/storage-redundancy.md#zone-redundant-storage)에 있는 개별 스토리지 클러스터 세 개에 물리적으로 격리됩니다. 가용성 영역은 Azure 지역 내의 고유한 물리적 위치입니다. 각 영역은 독립된 전원, 냉각 및 네트워킹을 갖춘 하나 이상의 데이터 센터로 구성됩니다. 스토리지에 대한 쓰기는 가용성 영역 3개 모두에 있는 스토리지 클러스터에 기록되어야만 허용됩니다. 
- [GRS(지역 중복 스토리지)](../common/storage-redundancy.md#geo-redundant-storage): GRS를 사용하면 주 지역과 보조 지역이라는 두 개의 지역이 있습니다. 파일은 주 지역의 Azure Storage 클러스터 내에 세 번 저장됩니다. 쓰기는 Microsoft에서 정의한 보조 지역에 비동기적으로 복제됩니다. GRS는 두 Azure 지역 간에 분산된 데이터의 복사본 6개를 제공합니다.
- [GZRS(지역 영역 중복 스토리지)](../common/storage-redundancy.md#geo-zone-redundant-storage): GZRS는 ZRS와 비슷하지만 지역 중복성이 있는 것처럼 생각할 수 있습니다. GZRS를 사용하면 파일은 주 지역에 있는 세 개의 고유 스토리지 클러스터에 세 번 저장됩니다. 이 경우 모든 쓰기는 Microsoft에서 정의한 보조 지역에 비동기식으로 복제됩니다.

강력한 재해 복구 솔루션의 경우 대부분 고객은 ZRS을 고려해야 합니다. ZRS는 추가된 데이터 중복성 혜택에 대한 최소한의 추가 비용을 추가하며 가동 중단 시에도 가장 원활합니다. 조직의 정책 또는 규정 요구 사항에 따라 데이터에 대한 지역 중복이 필요한 경우 GRS 또는 GZRS을 고려합니다.

### <a name="geo-redundancy"></a>지리적 중복

클라우드 엔드포인트가 포함된 스토리지 계정에서 GRS나 GZRS를 사용하는 경우 스토리지 동기화 서비스에서도 사용하도록 설정해야 합니다. 이렇게 하면 Azure 파일 동기화 토폴로지에 관한 모든 정보가 확인되며 클라우드 엔드포인트에 포함된 데이터가 재해 발생 시 쌍을 이루는 보조 지역에 비동기적으로 복사됩니다.

GRS 또는 GZRS를 사용하여 구성된 리소스의 경우 Microsoft는 주 지역이 영구적으로 복구할 수 없거나 장기간 사용할 수 없는 것으로 판단되는 경우 서비스에 대한 장애 조치를 시작합니다. 스토리지 동기화 서비스에서 GRS 또는 GZRS를 사용하는 경우 Azure 파일 동기화 서비스는 지역 재해 발생 시 자동으로 쌍을 이루는 지역으로 장애 조치됩니다. GRS 또는 GZRS를 사용하여 구성된 Azure 파일 동기화를 사용하는 경우 재해 발생 시 사용자가 수행해야 하는 작업이 없습니다.

스토리지 동기화 서비스를 GRS 또는 GZRS 쌍을 이루는 지역으로 장애 조치하도록 수동으로 요청할 수 있지만 프로세스가 원활하지 않으며 추가 비용이 발생할 수 있으므로 대규모 지역 가동 중단 외에는 이 작업을 수행하지 않는 것이 좋습니다. 프로세스를 시작하려면 지원 티켓을 열고 Azure 파일 공유와 스토리지 동기화 서비스를 포함하는 Azure Storage 계정이 둘 다 장애 조치되도록 요청합니다.

> [!WARNING]
> 이 프로세스를 수동으로 시작하는 경우 고객 지원팀에 문의하여 스토리지 동기화 서비스를 장애 조치하도록 요청해야 합니다. 보조 지역에서 동일한 서버 엔드포인트를 사용하여 새 스토리지 동기화 서비스를 만들려고 하면 이전에 설치된 Azure 파일 동기화가 정리되지 않으므로 스토리지 계정에서 추가 데이터가 유지될 수 있습니다.

장애 조치가 발생하면 서버 엔드포인트는 보조 지역의 클라우드 엔드포인트와 자동으로 동기화되도록 전환됩니다. 그러나 서버 엔드포인트는 클라우드 엔드포인트로 조정해야 합니다. 이로 인해 보조 지역의 데이터가 주 지역을 따라잡지 못할 수 있으므로 파일 충돌이 발생할 수 있습니다.

## <a name="next-steps"></a>다음 단계

[Azure 파일 공유 백업에 관한 자세한 정보](../../backup/azure-file-share-backup-overview.md?toc=%2fazure%2fstorage%2ffile-sync%2ftoc.json)