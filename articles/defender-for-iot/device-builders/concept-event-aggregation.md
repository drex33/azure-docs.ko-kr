---
title: 마이크로 에이전트 이벤트 수집(미리 보기)
description: Defender for IoT 보안 에이전트는 로컬 디바이스에서 데이터 및 시스템 이벤트를 수집하고 처리 및 분석을 위해 데이터를 Azure 클라우드에 보냅니다.
ms.date: 10/11/2021
ms.topic: conceptual
ms.openlocfilehash: 1868df35c05560fd80f6fa619b2d612ba6325d3c
ms.sourcegitcommit: ee5d9cdaf691f578f2e390101bf5350859d85c67
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/11/2021
ms.locfileid: "129740439"
---
# <a name="micro-agent-event-collection-preview"></a>마이크로 에이전트 이벤트 수집(미리 보기)

IoT 용 Defender 보안 에이전트는 로컬 장치에서 데이터 및 시스템 이벤트를 수집 하 고 처리 및 분석을 위해 데이터를 Azure 클라우드에 보냅니다. Defender for IoT 마이크로 에이전트는 새 프로세스 및 모든 새 연결 이벤트를 포함하여 다양한 유형의 디바이스 이벤트를 수집합니다. 새 프로세스와 새 연결 이벤트는 장치에서 자주 발생할 수 있습니다. 이 기능은 포괄적인 보안을 위해 중요 하지만, 보안 에이전트가 전송 하는 메시지 수를 신속 하 게 충족 하거나 IoT Hub 할당량 및 비용 제한을 초과할 수 있습니다. 이러한 메시지 및 이벤트에는 장치를 보호 하는 데 매우 중요 한 보안 정보가 포함 되어 있습니다.

장치 보안을 유지 하는 동안 메시지 수와 비용을 줄이기 위해 Defender for IoT 에이전트는 다음과 같은 유형의 이벤트를 집계 합니다.

- ProcessCreate(Linux만 해당)

- 로그인 활동 (Linux에만 해당)

- Network ConnectionCreate

- 시스템 정보

- 기초

이벤트 기반 수집기는 장치 내에서 해당 활동을 기반으로 트리거되는 수집기입니다. 예: ``a process was started in the device``.  

트리거 기반 수집기는 고객의 구성에 따라 예약된 방식으로 트리거되는 수집기입니다.

## <a name="how-does-event-aggregation-work"></a>이벤트 집계는 어떻게 작동하나요?

Defender for IoT 에이전트는 간격 또는 기간에 대한 이벤트를 집계합니다. 간격 지나면 에이전트는 추가 분석을 위해 집계된 이벤트를 Azure 클라우드로 보냅니다. 집계된 이벤트는 Azure 클라우드로 전송될 때까지 메모리에 저장됩니다.

에이전트는 이미 메모리에 저장된 이벤트와 동일한 이벤트를 수집합니다. 이 컬렉션을 사용 하면 에이전트가이 특정 이벤트의 적중 횟수를 늘려 에이전트의 메모리 사용 공간을 줄입니다. 집계 기간이 지나면 에이전트는 발생한 이벤트 유형 각각에 대한 적중 횟수를 보냅니다. 이벤트 집계는 수집된 각 이벤트 유형의 적중 횟수에 대한 집계일 뿐입니다.

## <a name="process-events-event-based"></a>프로세스 이벤트(이벤트 기반)

프로세스 이벤트는 Linux 운영 체제에서 지원됩니다.

‘명령줄’과  *userid* 가 동일할 때 프로세스 이벤트는 동일하다고 간주됩니다.

프로세스 이벤트의 기본 버퍼는 256개 프로세스입니다. 이 한도에 도달 하면 버퍼가 순환 되 고 가장 오래 된 프로세스 이벤트가 삭제 되어 가장 최근에 처리 된 이벤트를 위한 공간을 확보 합니다. 캐시 크기를 늘리라는 경고가 기록됩니다.

각 이벤트에 대해 수집 되는 데이터는 다음과 같습니다.

| 매개 변수 | 설명|
|--|--|
| **Timestamp** | 처음으로 프로세스가 관찰 된 시간입니다. |
| **process_id** | Linux PID입니다. |
| **parent_process_id** | Linux 부모 PID (있는 경우)입니다. |
| **Ds** | 명령줄입니다. |
| **형식** | 또는 중 하나일 수 있습니다 `fork` `exec` . |
| **hit_count** | 집계 개수입니다. 이벤트가 클라우드로 전송될 때까지 동일한 시간 프레임 동안 동일한 프로세스의 실행 수입니다. |

## <a name="network-connection-events-event-based-collector"></a>네트워크 연결 이벤트 (이벤트 기반 수집기)

네트워크 연결 이벤트는 로컬 포트, 원격 포트, 전송 프로토콜, 로컬 주소, 원격 주소가 동일할 때 동일한 것으로 간주됩니다.

네트워크 연결 이벤트의 기본 버퍼는 256입니다. 캐시가 꽉 찬 경우에는 다음을 수행 합니다.

- **Azure RTOS 장치**: 다음 컬렉션 주기가 시작 될 때까지 새 네트워크 이벤트가 캐시 되지 않습니다.  

- **Linux 디바이스**: 가장 오래된 이벤트가 모든 새 이벤트로 대체됩니다. 캐시 크기를 늘리라는 경고가 기록됩니다.

Linux 장치의 경우에는 i p v 4만 지원 됩니다.

각 이벤트에 대해 수집 되는 데이터는 다음과 같습니다.

| 매개 변수 | Description|
|--|--|
| **로컬 주소** | 연결의 원본 주소입니다. |
| **원격 주소** | 연결의 대상 주소입니다. |
| **로컬 포트** | 연결의 원본 포트입니다. |
| **원격 포트** | 연결의 대상 포트입니다. |
| **Bytes_in** | 연결의 총 집계 된 RX 바이트 수입니다. |
| **Bytes_out** | 연결의 총 집계 된 TX 바이트입니다. |
| **Transport_protocol** | TCP, UDP 또는 ICMP가 될 수 있습니다. |
| **응용 프로그램 프로토콜** | 연결과 관련 된 응용 프로그램 프로토콜입니다. |
| **확장 속성** | 연결에 대 한 추가 세부 정보입니다. 예: `host name`. |

## <a name="login-collector-event-based-collector"></a>로그인 수집기 (이벤트 기반 수집기)

로그인 수집기는 사용자 로그인, 로그 아웃 및 실패 한 로그인 시도를 수집 합니다.

현재 SSH 및 텔넷은 완전히 지원 됩니다.  

수집 되는 데이터는 다음과 같습니다.

| 매개 변수 | Description|
|--|--|
| **operation** | 로그인, 로그 아웃 또는 LoginFailed입니다. |
| **process_id** | Linux PID입니다. |
| **user_name** | Linux 사용자입니다. |
| **executable** | 터미널 장치입니다. 예를 들면 tty1입니다. 6 또는 포인트/n |
| **remote_address** | 연결 원본, IPv6 또는 IPv4 형식의 원격 IP 또는 로컬 연결을 나타내는 127.0.0.1/0.0.0.0입니다. |

> [!Note]
> 로그인 이벤트는 사용자가 실제로 로그인 하기 전에 장치에서 터미널을 열 때 캡처됩니다. 이 이벤트에는 TTY 프로세스, 로그인 이벤트 유형 및 사용자 이름이 있습니다. 예: `LOGIN`.

## <a name="system-information-trigger-based-collector"></a>시스템 정보 (트리거 기반 수집기))

각 이벤트에 대해 수집 되는 데이터는 다음과 같습니다.

| 매개 변수 | Description|
|--|--|
| **hardware_vendor** | 장치 공급 업체의 이름입니다. |
| **hardware_model** | 장치의 모델 번호 |
| **os_dist** | 운영 체제의 배포입니다. 예: `Linux`. |
| **os_version** | 운영 체제의 버전입니다. 예를 들어 `Windows 10` 또는 `Ubuntu 20.04.1`입니다. |
| **os_platform** | 디바이스의 OS입니다. |
| **os_arch** | OS의 아키텍처입니다. 예: `x86_64`. |
| **nic** | 네트워크 인터페이스 컨트롤러입니다. 속성의 전체 목록은 다음과 같습니다. |

**Nic** 속성은 다음과 같이 구성 됩니다.

| 매개 변수 | Description|
|--|--|
|**type** | `UNKNOWN`,, `ETH` `WIFI` , `MOBILE` 또는 `SATELLITE` 값 중 하나입니다. |
| **vlan** | 네트워크 인터페이스와 연결 된 가상 lan입니다. |
| **공급업체** | 네트워크 컨트롤러의 공급 업체입니다. |
| **나타납니다** | 네트워크 컨트롤러와 연결 된 IP 및 Mac 여기에는 다음 필드가 포함 됩니다. <br> - **ipv4_address**: ipv4 주소입니다. <br> - **ipv6_address**: ipv6 주소입니다. <br> - **mac**: mac 주소입니다.|

## <a name="baseline-trigger-based"></a>기준선(트리거 기반)

기준 수집기는 주기적으로 CIS 검사를 수행합니다. 실패한 결과만 클라우드로 전송됩니다. 클라우드는 결과를 집계하고 권장 사항을 제공합니다.

### <a name="data-collection"></a>데이터 수집

각 이벤트에 대해 수집 되는 데이터는 다음과 같습니다.

| 매개 변수 | Description|
|--|--|
| **ID 확인** | CI 형식입니다. 예: `CIS-debian-9-Filesystem-1.1.2`. |
| **결과 확인** | 는, 또는 일 수 있습니다 `Error` `Fail` . 예를 들어, 검사를 실행할 수 없는 상황에서는 `Error`입니다. |
| **오류** | 오류 정보 및 설명입니다. |
| **설명** | CIS의 확인에 대 한 설명입니다. |
| **수정** | CI의 재구성에 대 한 권장 사항입니다. |
| **심각도** | 심각도 수준입니다. |

## <a name="next-steps"></a>다음 단계

[Defender for IoT 보안 경고](concept-security-alerts.md)를 확인합니다.
