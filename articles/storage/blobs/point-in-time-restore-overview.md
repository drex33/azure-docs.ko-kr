---
title: 블록 BLOB에 대한 특정 시점 복원
titleSuffix: Azure Storage
description: 블록 BLOB에 대한 특정 시점 복원을 사용하면 스토리지 계정을 지정된 시점의 이전 상태로 복원하여 실수로 인한 삭제 또는 손상을 방지할 수 있습니다.
services: storage
author: tamram
ms.service: storage
ms.topic: conceptual
ms.date: 11/15/2021
ms.author: tamram
ms.subservice: blobs
ms.custom: devx-track-azurepowershell
ms.openlocfilehash: 9714c83af2f62cb12ddb31b5290edeef6a2663bf
ms.sourcegitcommit: 66b6e640e2a294a7fbbdb3309b4829df526d863d
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/01/2021
ms.locfileid: "133358371"
---
# <a name="point-in-time-restore-for-block-blobs"></a>블록 BLOB에 대한 특정 시점 복원

특정 시점 복원을 사용하면 블록 BLOB 데이터를 이전 상태로 복원하여 실수로 인한 삭제 또는 손상을 방지할 수 있습니다. 특정 시점 복원은 사용자 또는 애플리케이션이 실수로 데이터를 삭제하거나 애플리케이션 오류로 인해 데이터가 손상되는 경우에 유용합니다. 또한, 특정 시점 복원은 추가 테스트를 실행하기 전에 데이터 세트를 알려진 상태로 되돌려야 하는 테스트 시나리오를 가능하게 해 줍니다.

특정 시점 복원은 표준 성능 계층의 범용 v2 스토리지 계정에만 지원됩니다. 핫 및 쿨 액세스 계층의 데이터만 특정 시점 복원을 사용하여 복원할 수 있습니다.

스토리지 계정에 특정 시점 복원을 사용 설정하는 방법에 대한 자세한 내용은 [블록 BLOB 데이터에 특정 시점 복원 수행](point-in-time-restore-manage.md)을 참조하세요.

## <a name="how-point-in-time-restore-works"></a>특정 시점 복원 사용 방법

특정 시점 복원을 사용 설정하려면 스토리지 계정에 대한 관리 정책을 만들고 보존 기간을 지정합니다. 보존 기간 동안 블록 BLOB을 현재 상태에서 이전의 특정 시점 상태로 복원할 수 있습니다.

특정 시점 복원을 시작하려면 [BLOB 범위 복원](/rest/api/storagerp/storageaccounts/restoreblobranges) 작업을 호출하고 UTC 시간으로 복원 지점을 지정합니다. 복원할 컨테이너 및 BLOB 이름의 범위를 사전 순으로 지정하거나 범위를 생략하여 스토리지 계정의 모든 컨테이너를 복원할 수 있습니다. 복원 작업당 최대 10개의 사전순 범위가 지원됩니다.

Azure Storage는 요청된 복원 지점(UTC 시간)과 현재 시점 사이의 지정된 BLOB에 대한 모든 변경 내용을 분석합니다. 복원 작업은 원자성 작업이므로 모든 변경 내용을 복원하는 데 완전히 성공하거나 실패합니다. 복원할 수 없는 BLOB이 있는 경우 작업이 실패하고 관련 컨테이너에 대한 읽기 및 쓰기 작업이 계속됩니다.

다음 다이어그램은 특정 시점 복원 수행 방법을 보여 줍니다. 하나 이상의 컨테이너 또는 BLOB 범위는 *n* 일 전의 상태로 복원됩니다. 여기서 *n* 은 특정 시점 복원에 정의된 보존 기간 이하입니다. 보존 기간 중에 발생한 쓰기 및 삭제 작업을 되돌리는 효과가 있습니다.

:::image type="content" source="media/point-in-time-restore-overview/point-in-time-restore-diagram.png" alt-text="특정 시점에서 컨테이너를 이전 상태로 복원하는 방법을 보여 주는 다이어그램":::

한 번에 하나의 스토리지 계정에 하나의 복원 작업만 실행할 수 있습니다. 복원 작업은 진행 중인 동안에는 취소할 수 없지만 두 번째 복원 작업을 수행하여 첫 번째 작업을 실행 취소할 수 있습니다.

**BLOB 범위 복원** 작업은 작업을 고유하게 식별하는 복원 ID를 반환합니다. 특정 시점 복원 상태를 확인하려면 **BLOB 범위 복원** 작업에서 반환된 복원 ID를 사용하여 **복원 상태 가져오기** 작업을 호출합니다.

> [!IMPORTANT]
> 복원 작업 수행 시 Azure Storage는 작업 중 복원되는 범위의 BLOB에 대한 데이터 작업을 차단합니다. 읽기, 쓰기, 삭제 작업은 기본 위치에서 차단됩니다. 따라서 복원 작업이 진행되는 동안에는 Azure Portal의 컨테이너 나열 등의 작업이 정상적으로 수행되지 않을 수 있습니다.
>
> 스토리지 계정이 지역에서 복제되는 경우 보조 위치에서의 읽기 작업은 복원 작업 중에 진행될 수 있습니다.

> [!CAUTION]
> 특정 시점 복원은 블록 BLOB에 대해 적용된 작업만 복원하도록 지원합니다. 컨테이너에 적용된 작업은 복원할 수 없습니다. 예를 들어 [컨테이너 삭제](/rest/api/storageservices/delete-container) 작업을 호출하여 스토리지 계정에서 컨테이너를 삭제하면 해당 컨테이너는 특정 시점 복원 작업을 통해 복원할 수 없습니다. 전체 컨테이너를 삭제하는 대신 개별 BLOB을 삭제해야 나중에 복원할 수 있습니다.

### <a name="prerequisites-for-point-in-time-restore"></a>특정 시점 복원을 사용하기 위한 필수 조건

특정 시점 복원을 사용하려면 다음과 같은 Azure Storage 기능을 사용 설정해야 특정 시점 복원을 사용 설정할 수 있습니다.

- [일시 삭제](soft-delete-blob-overview.md)
- [변경 피드](storage-blob-change-feed.md)
- [BLOB 버전 관리](versioning-overview.md)

이와 같은 기능을 사용 설정하면 추가 요금이 발생할 수 있습니다. 특정 시점 복원 및 필수 기능을 사용 설정하기 전에 부과되는 요금에 대해 알고 있어야 합니다.

### <a name="retention-period-for-point-in-time-restore"></a>특정 시점 복원에 대한 보존 기간

스토리지 계정에 특정 시점 복원을 사용 설정 시 보존 기간을 지정합니다. 스토리지 계정의 블록 BLOB은 보존 기간 동안 복원될 수 있습니다.

특정 시점 복원을 사용 설정하고 몇 분 후에 보존 기간이 시작됩니다. 보존 기간이 시작되기 전에는 BLOB을 특정 상태로 복원할 수 없습니다. 예를 들어 5월 1일에 보존 기간을 30일로 하여 특정 시점 복원을 사용 설정한 경우 5월 15일에는 최대 15일까지 복원할 수 있습니다. 6월 1일에는 1일부터 30일까지의 데이터를 복원할 수 있습니다.

특정 시점 복원에 대한 보존 기간은 일시 삭제에 지정된 보존 기간보다 하루 이상 짧아야 합니다. 예를 들어 일시 삭제 보존 기간이 7일로 설정된 경우 특정 시점 복원 보존 기간은 1일~6일이 될 수 있습니다.

> [!IMPORTANT]
> 일련의 데이터를 복원하는 데 걸리는 시간은 복원 기간 중에 수행된 쓰기 및 삭제 작업의 건수에 따라 달라집니다. 예를 들어 100만 개의 개체에 하루에 3천 개의 개체가 추가되고 1천 개의 개체가 삭제되는 계정의 경우 30일 전의 시점으로 복원하는 데 약 2시간이 소요됩니다. 변동률이 이와 같은 계정에는 보존 기간과 복원 범위를 90일 전을 초과하지 않도록 설정하는 것이 좋습니다.

### <a name="permissions-for-point-in-time-restore"></a>특정 시점 복원에 대한 권한

복원 작업을 시작하려면 클라이언트에 스토리지 계정의 모든 컨테이너에 대한 쓰기 권한이 있어야 합니다. Azure Active Directory(Azure AD)를 사용하여 복원 작업을 승인하는 권한을 부여하려면 스토리지 계정, 리소스 그룹 또는 구독 수준에서 보안 주체에 **스토리지 계정 contributor** 역할을 할당합니다.

## <a name="limitations-and-known-issues"></a>제한 사항 및 알려진 문제

블록 BLOB에 대한 특정 시점 복원에는 다음과 같은 제한 사항 및 알려진 문제가 있습니다.

- 표준 범용 v2 스토리지 계정의 블록 BLOB만 특정 시점 복원 작업의 일부로 복원할 수 있습니다. 추가 BLOB, 페이지 BLOB, 프리미엄 블록 BLOB은 복원되지 않습니다.
- 보존 기간 중 컨테이너를 삭제한 경우 해당 컨테이너는 특정 시점 복원 작업으로 복원되지 않습니다. 삭제된 컨테이너에 포함된 BLOB이 있는 BLOB 범위의 복원을 시도하면 특정 시점 복원 작업이 실패합니다. 컨테이너 삭제를 방지하는 방법에 대한 자세한 내용은 [컨테이너의 일시 삭제](soft-delete-container-overview.md)를 참조하세요.
- BLOB이 현재 시점과 복원 지점 사이에 핫과 쿨 계층 사이를 이동한 경우 BLOB은 이전 계층으로 복원됩니다. 보관 계층에서는 블록 BLOB 복원이 지원되지 않습니다. 예를 들어 핫 계층의 Blob을 2일 전에 보관 계층으로 이동하고 복원 작업이 3일 전 지점으로 복원하면 Blob이 핫 계층으로 복원되지 않습니다. 보관된 BLOB을 복원하려면 먼저 보관 계층 외부로 이동합니다. 자세한 내용은 [보관 계층의 Blob 리하위드레이션 개요](archive-rehydrate-overview.md)를 참조하세요.
- 불변성 정책을 구성한 경우 복원 작업을 시작할 수 있지만, 불변성 정책에 따라 보호되는 모든 Blob은 수정되지 않습니다. 이 경우 복원 작업 시 지정된 날짜 및 시간에 일관된 상태로 복원되지 않습니다.
- [블록 배치](/rest/api/storageservices/put-block) 또는 [URL의 블록 배치](/rest/api/storageservices/put-block-from-url)를 통해 업로드되었지만 [블록 목록 배치](/rest/api/storageservices/put-block-list)를 통해 커밋되지는 않은 블록은 BLOB의 일부가 아니므로 복원 작업의 일부로 복원되지 않습니다.
- 활성 임대가 있는 BLOB은 복원할 수 없습니다. 활성 임대가 있는 BLOB이 복원할 BLOB 범위에 포함된 경우 복원 작업이 원자 방식으로 실패합니다. 복원 작업을 시작하기 전에 활성 임대를 중단합니다.
- 스토리지 계정에서 고객 관리 장애 조치(failover)를 수행하면 해당 스토리지 계정에 대해 가능한 가장 빠른 복원 지점이 다시 설정됩니다. 예를 들어 보존 기간을 30일로 설정했다고 가정합니다. 장애 조치(failover) 이후 30일이 경과한 경우 해당 30일 내의 모든 지점으로 복원할 수 있습니다. 그러나 장애 조치(failover) 이후 30일 미만이 경과한 경우 보존 기간에 관계없이 장애 조치(failover) 이전 시점으로 복원할 수 없습니다. 예를 들어 장애 조치(failover) 후 10일이 지난 경우 가능한 가장 빠른 복원 지점은 과거의 30일이 아닌 10일입니다.  
- 스냅샷은 복원 작업의 일부로 생성되거나 삭제되지 않습니다. 기본 BLOB만 이전 상태로 복원됩니다.
- Azure Data Lake Storage Gen2 플랫 및 계층 구조 네임스페이스 복원은 지원되지 않습니다.

> [!IMPORTANT]
> 블록 BLOB을 2020년 9월 22일 이전 시점으로 복원하는 경우 특정 시점 복원에 대한 미리 보기 제한이 적용됩니다. 일반적으로 사용 가능한 특정 시점 복원 기능을 활용하려면 2020년 9월 22일 또는 그 이후의 복원 지점을 선택하는 것이 좋습니다.

## <a name="feature-support"></a>기능 지원

이 표에서는 사용자 계정에서 이 기능이 지원되는 방법과 특정 기능을 활성화할 때 지원에 미치는 영향을 보여 줍니다.

| Storage 계정 유형 | Blob Storage(기본 지원) | Data Lake Storage Gen2 <sup>1</sup> | NFS 3.0 <sup>1</sup> | SFTP <sup>1</sup> |
|--|--|--|--|--|
| 표준 범용 v2 | ![예](../media/icons/yes-icon.png) |![아니요](../media/icons/no-icon.png)              | ![아니요](../media/icons/no-icon.png) | ![아니요](../media/icons/no-icon.png) |
| Premium 블록 Blob          | ![아니요](../media/icons/no-icon.png)|![아니요](../media/icons/no-icon.png) | ![아니요](../media/icons/no-icon.png) | ![아니요](../media/icons/no-icon.png) |

<sup>1</sup> Data Lake Storage Gen2, NFS(네트워크 파일 시스템) 3.0 프로토콜 및 SFTP(SSH 파일 전송 프로토콜) 지원은 모두 계층 구조 네임스페이스를 사용하도록 설정된 스토리지 계정이 필요합니다.

## <a name="pricing-and-billing"></a>가격 책정 및 대금 청구

특정 시점 복원을 사용 설정하는 것은 무료입니다. 그러나 특정 시점 복원을 사용하도록 설정하면 Blob 버전 관리, 일시 삭제, 변경 피드도 사용하도록 설정되며, 이에 따라 추가 요금이 부과될 수 있습니다.

특정 시점 복원에 대한 요금은 복원 작업을 수행하기 위해 처리된 데이터의 양에 따라 달라집니다. 처리된 데이터의 양은 복원 지점 및 현재 시점 사이에 발생한 변경 사항의 개수에 따라 달라집니다. 예를 들어 스토리지 계정에서 비교적 일정한 변동률로 BLOB 데이터를 차단하는 경우 1일 전으로 복원하는 작업의 비용은 10일 전으로 복원하는 작업의 1/10입니다.

복원 작업의 비용을 예측하려면 변경 피드 로그를 검토하여 복원 기간 중 수정된 데이터의 양을 추정합니다. 예를 들어 변경 피드의 보존 기간이 30일이고 변경 피드의 크기가 10MB인 경우 10일 이전의 시점으로 복원하는 작업의 비용은 해당 지역의 LRS 계정에 대해 나열된 가격의 약 1/3입니다. 27일 전의 시점으로 복원하는 작업의 비용은 나열된 가격의 약 9/10입니다.

특정 시점 복원 가격 책정에 대한 자세한 내용은 [블록 BLOB 가격 책정](https://azure.microsoft.com/pricing/details/storage/blobs/)을 참조하세요.

## <a name="next-steps"></a>다음 단계

- [블록 BLOB 데이터에 특정 시점 복원 수행](point-in-time-restore-manage.md)
- [Azure Blob Storage의 변경 피드 지원](storage-blob-change-feed.md)
- [Blob에 일시 삭제를 사용하도록 설정](soft-delete-blob-enable.md)
- [Blob 버전 관리 설정 및 관리](versioning-enable.md)
