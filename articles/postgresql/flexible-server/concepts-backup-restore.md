---
title: Azure Database for PostgreSQL - 유연한 서버의 백업 및 복원
description: Azure Database for PostgreSQL - 유연한 서버를 사용한 백업 및 복원의 개념에 대해 알아봅니다.
author: sr-msft
ms.author: srranga
ms.service: postgresql
ms.topic: conceptual
ms.date: 09/22/2020
ms.openlocfilehash: f5c0e8ae52d2af25c41550df1c59680d47360477
ms.sourcegitcommit: aba63ab15a1a10f6456c16cd382952df4fd7c3ff
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/25/2021
ms.locfileid: "107987851"
---
# <a name="backup-and-restore-in-azure-database-for-postgresql---flexible-server"></a>Azure Database for PostgreSQL - 유연한 서버의 백업 및 복원

> [!IMPORTANT]
> Azure Database for PostgreSQL - 유연한 서버는 미리 보기로 제공됨

백업은 비즈니스 연속성 전략의 필수적인 부분을 형성하고, 실수로 손상 또는 삭제되지 않도록 데이터를 보호합니다. Azure Database for PostgreSQL - 유연한 서버는 자동으로 서버를 백업하고 최대 35일 동안 백업을 유지합니다. 복원하는 동안 보존 기간 내에 복원하려는 날짜 및 시간을 지정할 수 있습니다. 복원 및 복구에 걸리는 전체 시간은 데이터베이스 파일의 크기 및 수행할 복구의 양에 따라 달라집니다. 

### <a name="backup-process-in-flexible-server"></a>유연한 서버에서의 백업 프로세스
첫 번째 스냅샷 백업은 유동 서버를 만든 후 즉시 예약됩니다. 그런 다음 데이터 파일의 일별 스냅샷 백업이 수행됩니다. 백업은 지역 내의 영역 중복 스토리지에 저장됩니다. 트랜잭션 로그(미리 쓰기 로그 - WAL)도 지속적으로 보관되므로 마지막으로 커밋된 트랜잭션으로 복원할 수 있습니다. 이러한 데이터 및 로그 백업을 사용하면 서버를 구성된 백업 보존 기간 내의 특정 시점으로 복원할 수 있습니다. 모든 백업은 AES 256비트 암호화를 사용하여 암호화됩니다.

데이터베이스가 고가용성으로 구성된 경우 일별 스냅샷은 기본에서 수행되고 연속 로그 백업은 대기 상태에서 수행됩니다.

> [!IMPORTANT]
>중지된 서버에서는 백업이 수행되지 않습니다. 그러나 데이터베이스가 7일 후에 자동으로 시작되거나 사용자가 데이터베이스를 시작하면 백업이 다시 시작됩니다.

백업은 유연한 서버 내의 복원 작업에만 사용할 수 있습니다. 데이터를 유연한 서버로 내보내거나 유연한 서버에서 가져오려면 [덤프 및 복원](../howto-migrate-using-dump-and-restore.md) 방법을 사용합니다.


### <a name="backup-retention"></a>백업 보존

백업은 서버의 백업 보존 기간 설정에 따라 보존됩니다. 7~35일 사이의 보존 기간을 선택할 수 있습니다. 기본 보존 기간은 7일입니다. 보존 기간은 서버 생성 중 설정하거나 이후에 업데이트할 수 있습니다. 백업은 중지된 서버의 경우에도 보존됩니다.

백업 보존 기간은 사용 가능한 백업을 기반으로 하기 때문에 특정 시점 복원을 검색할 수 있는 과거의 시점을 제어합니다. 백업 보존 기간은 복원 관점에서 복구 기간으로 취급될 수도 있습니다. 백업 보존 기간 내에 특정 시점 복원을 하기 위해 필요한 모든 백업이 백업 스토리지에 보존됩니다. 예를 들어 백업 보존 기간이 7일로 설정되었으면 복구 기간이 최근 7일로 간주됩니다. 이 시나리오에서는 지난 7일 동안 서버를 복원 및 복구하는 데 필요한 모든 데이터 및 로그가 보존됩니다. 


### <a name="backup-storage-cost"></a>백업 스토리지 비용

유연한 서버는 추가 비용 없이 최대 100%의 프로비저닝된 서버 스토리지를 백업 스토리지로 제공합니다. 사용되는 모든 추가 백업 스토리지는 매월 GB 단위로 청구됩니다. 예를 들어 250GiB의 스토리지를 제공하는 서버를 프로비저닝한 경우 추가 비용 없이 250GiB의 백업 스토리지 용량을 사용할 수 있습니다. 매일 백업 사용량이 25GiB이면 최대 10일 동안 체험용 백업 스토리지를 사용할 수 있습니다. 250GiB을 초과하는 백업 스토리지 사용에는 [가격 책정 모델](https://azure.microsoft.com/pricing/details/postgresql/)에 따라 요금이 청구됩니다.

Azure Portal에서 [사용되는 백업 스토리지](../concepts-monitoring.md) 메트릭을 사용하여 서버에서 사용하는 백업 스토리지를 모니터링할 수 있습니다. 사용된 백업 스토리지 메트릭은 서버에 대해 설정된 백업 보존 기간에 따라 유지되는 모든 데이터베이스 백업 및 로그 백업에서 사용하는 스토리지의 합계를 나타냅니다.  서버에서 과도한 트랜잭션 작업을 수행하면 전체 데이터베이스 크기에 관계없이 백업 스토리지 사용량이 증가할 수 있습니다.

백업 스토리지 비용을 제어하기 위한 기본 방법은 적합한 백업 보존 기간을 설정하고 원하는 복구 목표에 맞게 올바른 백업 중복성 옵션을 선택하는 것입니다.

> [!IMPORTANT]
> 현재 유연한 서버에서는 지역 중복 백업이 지원되지 않습니다.

## <a name="point-in-time-restore-overview"></a>특정 시점 복원 개요

유연한 서버에서 특정 시점 복원을 수행하면 원본 서버와 동일한 지역에 있는 유연한 서버의 백업에서 새 서버가 만들어집니다. 이 경우 가격 책정 계층, 컴퓨팅 세대, vCore 수, 스토리지 크기, 백업 보존 기간 및 백업 중복 옵션에 대한 원본 서버의 구성으로 만들어집니다. 또한 VNET 및 방화벽 설정과 같은 태그와 설정은 원본 서버에서 상속됩니다. 

 > [!IMPORTANT]
> 영역 중복 고가용성으로 구성된 유연한 서버를 복원하는 경우 복원된 서버는 고가용성을 사용하지 않고 주 서버와 동일한 지역에 구성됩니다. 

 ### <a name="restore-process"></a>복원 프로세스

물리적 데이터베이스 파일은 먼저 스냅샷 백업에서 서버의 데이터 위치로 복원됩니다. 원하는 시점보다 이전에 수행된 적절한 백업이 자동으로 선택되고 복원됩니다. 그런 다음 데이터베이스를 일관된 상태로 만들기 위해 WAL 파일을 사용하여 복구 프로세스가 시작됩니다. 

 예를 들어 매일 밤 오후 11시에 백업이 수행된다고 가정해 보겠습니다. 복원 지점이 2020년 8월 15일 오전 10시인 경우 2020년 8월 14일 매일 백업이 복원됩니다. 데이터베이스는 8월 24일 오후 11시부터 8월 25일 오전 10시까지 트랜잭션 로그 백업을 사용하여 2020년 8월 25일 오전 10시까지 복구됩니다. 

 데이터베이스 서버를 복원하려면 [다음 단계](./how-to-restore-server-portal.md)를 참조하세요.

> [!IMPORTANT]
> 유동 서버에서 복원 작업을 수행하면 새 데이터베이스 서버가 만들어지고 기존 데이터베이스 서버를 덮어쓰지 않습니다.

특정 시점 복원은 여러 시나리오에서 유용합니다. 예를 들어 사용자가 실수로 데이터를 삭제하거나 중요한 테이블 또는 데이터베이스를 삭제하는 경우, 또는 애플리케이션의 결함으로 인해 우연히 적절한 데이터를 잘못된 데이터로 덮어쓰는 경우가 있습니다. 트랜잭션 로그의 연속 백업으로 인해 마지막 트랜잭션으로 복원할 수 있습니다.

최신 복원 지점과 사용자 지정 복원 지점 중에서 선택할 수 있습니다.

-   **최신 복원 지점(현재)** : 서버를 최신 시점으로 복원할 수 있도록 하는 기본 옵션입니다. 

-   **사용자 지정 복원 지점**:이 옵션을 사용하면 유연한 서버에 대해 정의된 보존 기간 내의 시점을 선택할 수 있습니다. 기본적으로 UTC의 최근 시간이 자동으로 선택되며, 이는 테스트 목적으로 마지막으로 커밋된 트랜잭션으로 복원하려는 경우에 유용합니다. 필요에 따라 다른 날짜와 시간을 선택할 수 있습니다. 

예상 복구 시간은 데이터베이스 크기, 처리할 트랜잭션 로그 볼륨, 네트워크 대역폭, 동일한 지역에서 동시에 복구되는 총 데이터베이스 수 등 여러 요소에 따라 달라집니다. 일반적으로 전체 복구 시간은 몇 분에서 몇 시간까지 소요됩니다.


> [!IMPORTANT]
> 삭제된 서버는 복원할 수 **없습니다**. 서버를 삭제하면 해당 서버에 속한 모든 데이터베이스도 삭제되고 복구할 수 없습니다. 배포 후에 실수로 인한 삭제 또는 예기치 않은 변경에서 서버 리소스를 보호하려면 관리자는 [관리 잠금](../../azure-resource-manager/management/lock-resources.md)을 활용할 수 있습니다.

## <a name="perform-post-restore-tasks"></a>복원 후 작업 수행

데이터베이스가 복원된 후 다음 작업을 수행하여 사용자와 애플리케이션 백업을 다시 실행되도록 해야 합니다.

-   새 서버가 원래 서버를 교체하기 위한 것이라면 클라이언트와 클라이언트 애플리케이션을 새 서버로 리디렉션합니다.

-   사용자가 연결할 수 있도록 적절한 서버 수준 방화벽 및 VNet 규칙이 있는지 확인합니다. 이러한 규칙은 원래 서버에서 복사되지 않습니다.
  
-   복원된 서버의 컴퓨팅을 필요에 따라 스케일 업/다운할 수 있습니다.

-   적절한 로그인 및 데이터베이스 수준 권한이 있는지 확인합니다.

-   필요에 따라 경고를 구성합니다.
  
-  고가용성으로 구성된 데이터베이스를 복원한 경우 및 복원된 서버를 고가용성으로 구성하려는 경우 다음 [단계](./how-to-manage-high-availability-portal.md)를 수행할 수 있습니다.


## <a name="next-steps"></a>다음 단계

-   [비즈니스 연속성](./concepts-business-continuity.md)에 대한 자세한 정보
-   [영역 중복 고가용성](./concepts-high-availability.md)에 대한 자세한 정보
-   [복원 방법](./how-to-restore-server-portal.md)에 대한 자세한 정보