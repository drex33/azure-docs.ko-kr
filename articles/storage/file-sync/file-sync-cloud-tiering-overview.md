---
title: Azure 파일 동기화 클라우드 계층화 해석 | Microsoft Docs
description: 선택적 Azure 파일 동기화 기능인 클라우드 계층화에 대해 살펴봅니다. 자주 액세스하는 파일은 서버에서 로컬로 캐시되고, 다른 파일은 Azure Files에 계층화됩니다.
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 04/13/2021
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: 1f0ae8b5a4ac2572719340020695a5bcd6b0d8a2
ms.sourcegitcommit: f6e2ea5571e35b9ed3a79a22485eba4d20ae36cc
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/24/2021
ms.locfileid: "128601352"
---
# <a name="cloud-tiering-overview"></a>클라우드 계층화 개요

Azure 파일 동기화의 선택적 기능인 클라우드 계층화는 온-프레미스 파일 서버의 성능을 유지하면서 필요한 로컬 스토리지의 양을 줄입니다.

이 기능을 사용하도록 설정하면 자주 액세스하는(핫) 파일만 로컬 서버에 저장됩니다. 자주 액세스하지 않는(쿨) 파일은 네임스페이스(파일 및 폴더 구조)와 파일 콘텐츠로 분할됩니다. 네임스페이스는 로컬로 저장되고, 파일 콘텐츠는 클라우드의 Azure 파일 공유에 저장됩니다.

사용자가 계층화된 파일을 열면 Azure 파일 동기화에서 Azure 파일 공유의 파일 데이터를 원활하게 회수합니다.

## <a name="how-cloud-tiering-works"></a>클라우드 계층화 작동 방법

### <a name="cloud-tiering-policies"></a>클라우드 계층화 정책

클라우드 계층화를 사용하도록 설정할 때 쿨 파일을 계층화하는 시기를 Azure 파일 동기화에 알리기 위해 **사용 가능한 볼륨 공간 정책** 과 **날짜 정책** 이라는 두 가지 정책을 설정할 수 있습니다.

#### <a name="volume-free-space-policy"></a>사용 가능한 볼륨 공간 정책

**사용 가능한 볼륨 공간 정책** 은 로컬 디스크에서 일정 공간을 차지하는 경우 쿨 파일을 클라우드에 계층화하도록 Azure 파일 동기화에 지시합니다.

예를 들어 로컬 디스크 용량이 200GiB이고 40GiB 이상의 로컬 디스크 용량을 항상 사용 가능한 상태로 유지하려면 사용 가능한 볼륨 공간 정책을 20%로 설정해야 합니다. 사용 가능한 볼륨 공간은 개별 디렉터리 또는 서버 엔드포인트 수준이 아니라 볼륨 수준에서 적용됩니다.

#### <a name="date-policy"></a>날짜 정책

**날짜 정책** 을 사용하는 경우 쿨 파일은 x일 동안 액세스(즉, 읽기 또는 쓰기)되지 않은 경우 클라우드에 계층화됩니다. 예를 들어 15일 넘게 액세스하지 않은 파일이 일반적으로 보관 파일인 경우 날짜 정책을 15일로 설정해야 합니다.

날짜 정책과 사용 가능한 볼륨 공간 정책이 함께 작동하는 방법에 대한 자세한 예는 [Azure 파일 동기화 클라우드 계층화 정책 선택](file-sync-choose-cloud-tiering-policies.md)을 참조하세요.

### <a name="windows-server-data-deduplication"></a>Windows Server 데이터 중복 제거

데이터 중복 제거는 Windows Server 2016부터 클라우드 계층화가 사용하도록 설정된 볼륨에서 지원됩니다. 자세한 내용은 [Azure 파일 동기화 배포 계획](file-sync-planning.md#data-deduplication)을 참조하세요.

### <a name="cloud-tiering-heatmap"></a>클라우드 계층화 열 지도

Azure 파일 동기화는 시간별 액세스(읽기 및 쓰기 작업)를 모니터링하고 최근 액세스 빈도에 따라 모든 파일에 열 점수를 할당합니다. 이러한 점수를 사용하여 각 서버 엔드포인트에서 네임스페이스의 "열 지도"를 빌드합니다. 이 열 지도는 클라우드 계층화가 사용하도록 설정된 위치에서 열 점수를 기준으로 정렬된 모든 동기화 파일의 목록입니다. 최근에 열고 자주 액세스한 파일은 핫 파일로 간주하고, 거의 건드리지 않은 채 한동안 액세스하지 않은 파일은 쿨 파일로 간주합니다.

해당 열 지도에서 개별 파일의 상대 위치를 결정하기 위해 시스템에서 최대 타임스탬프를 MAX(마지막 액세스 시간, 마지막 수정한 시간, 만든 시간) 순서로 사용합니다.

일반적으로 마지막 액세스 시간을 추적하여 사용할 수 있습니다. 그러나 클라우드 계층화가 사용하도록 설정된 새 서버 엔드포인트가 만들어지면 파일 액세스를 관찰할 시간이 충분히 제공되지 않습니다. 유효한 마지막 액세스 시간이 없는 경우 마지막 수정 시간을 대신 사용하여 열 지도의 상대 위치를 평가합니다.

날짜 정책은 동일한 방식으로 작동합니다. 마지막 액세스 시간이 없는 경우 날짜 정책이 마지막 수정 시간에 적용됩니다. 이를 사용할 수 없는 경우 파일을 만든 시간으로 대체됩니다. 시간이 지남에 따라 시스템은 더 많은 파일 액세스 요청을 관찰하고 자체적으로 추적되는 마지막 액세스 시간을 자동으로 사용하기 시작합니다.

> [!NOTE]
> 클라우드 계층화는 마지막 액세스 시간을 추적하는 NTFS 기능을 사용하지 않습니다. 이 NTFS 기능은 기본적으로 해제되어 있으며, 성능 고려 사항으로 인해 이 기능을 수동으로 사용하도록 설정하지 않는 것이 좋습니다. 클라우드 계층화는 마지막 액세스 시간을 별도로 추적합니다.

### <a name="proactive-recalling"></a>자동 관리 회수

파일이 만들어지거나 수정되면 파일을 지정한 서버로 자동으로 회수할 수 있습니다. 자동 관리 회수를 통해 지정된 각 서버에서 새 파일 또는 수정된 파일을 쉽게 사용할 수 있습니다.

미국과 인도에 지사를 두고 있는 다국적 기업을 예로 들어 보겠습니다. 정보 근로자는 새 프로젝트를 위해 오전(미국 시간 기준)에 새 폴더와 새 파일을 만들고 하루 종일 작업합니다. Azure 파일 동기화는 폴더 및 파일을 Azure 파일 공유(클라우드 엔드포인트)와 동기화합니다. 인도의 정보 근로자는 자신의 시간대에 따라 프로젝트 작업을 계속합니다. 아침에 도착하면 인도 팀이 로컬 캐시에서 효율적으로 작업할 수 있도록 로컬 Azure 파일 동기화가 사용하도록 설정된 인도의 서버가 이러한 새 파일을 로컬에서 사용할 수 있어야 합니다. 이 모드를 사용하도록 설정하면 요청 시 회수로 인해 초기 파일 액세스 속도가 느려지는 것을 방지하고 Azure 파일 공유에서 파일이 변경되거나 생성되는 즉시 서버가 파일을 사전에 회수할 수 있습니다.

서버로 회수된 파일이 로컬에서 필요하지 않은 경우 불필요한 회수로 인해 송신 트래픽과 비용이 늘어날 수 있습니다. 따라서 클라우드의 최근 변경 내용을 사용하여 서버의 캐시를 미리 채우면 해당 서버의 파일을 사용하는 사용자 또는 애플리케이션에 긍정적인 영향을 준다고 알고 있는 경우에만 자동 관리 회수를 사용하도록 설정합니다.

자동 관리 회수를 사용하도록 설정하면 서버에서 대역폭 사용량이 증가할 수 있으며, 회수되는 파일의 증가로 인해 로컬 서버의 다른 비교적 새로운 콘텐츠가 적극적으로 계층화될 수 있습니다. 따라서 계층화되는 파일이 서버에서 핫 파일로 간주할 경우 너무 빨리 계층화되면 더 많은 회수가 발생할 수 있습니다.

:::image type="content" source="media/storage-sync-files-deployment-guide/proactive-download.png" alt-text="현재 유효한 서버 엔드포인트에 대한 Azure 파일 공유 다운로드 동작과 이를 변경할 수 있는 메뉴를 여는 버튼이 표시된 이미지":::

자동 관리 회수에 대한 자세한 내용은 [Azure 파일 동기화 배포](file-sync-deployment-guide.md#proactively-recall-new-and-changed-files-from-an-azure-file-share)를 참조하세요.

## <a name="tiered-vs-locally-cached-file-behavior"></a>계층화된 파일 및 로컬에 캐시된 파일의 동작

클라우드 계층화는 네임스페이스(파일/폴더 계층 구조 및 파일 속성)와 파일 콘텐츠를 분리하는 것입니다.

#### <a name="tiered-file"></a>계층화된 파일

계층화된 파일의 경우 파일 콘텐츠 자체가 로컬로 저장되지 않으므로 디스크의 크기는 0입니다. 파일이 계층화되는 경우 Azure 파일 동기화 파일 시스템 필터(StorageSync.sys)에서 로컬로 파일을 포인터(재분석 지점)로 바꿉니다. 재분석 지점은 Azure 파일 공유의 파일에 대한 URL을 나타냅니다. 계층화된 파일의 경우 NTFS에서 FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS 특성과 “offline” 특성이 모두 설정되므로 타사 애플리케이션이 계층화된 파일을 안전하게 식별할 수 있습니다.

![계층화된 파일의 속성에 대한 스크린샷 - 네임스페이스만](media/storage-sync-cloud-tiering-overview/cloud-tiering-overview-2.png)

#### <a name="locally-cached-file"></a>로컬에 캐시된 파일

반면에 온-프레미스 파일 서버에 저장된 파일의 경우 전체 파일(파일 속성 + 파일 콘텐츠)이 로컬에 저장되므로 디스크의 크기는 파일의 논리적 크기와 거의 같습니다.

![계층화되지 않은 파일의 속성에 대한 스크린샷 - 네임스페이스 + 파일 콘텐츠](media/storage-sync-cloud-tiering-overview/cloud-tiering-overview-1.png)

파일을 부분적으로 계층화할 수 있습니다(또는 부분적으로 회수). 부분적으로 계층화된 파일에서는 파일 일부만 디스크에 저장됩니다. 파일에 대한 스트리밍 액세스를 지원하는 애플리케이션에서 파일을 부분적으로 읽는 경우 볼륨에서 파일을 부분적으로 회수했을 수 있습니다. 멀티미디어 플레이어 및 zip 유틸리티를 예로 들 수 있습니다. Azure 파일 동기화는 효율적하며 연결된 Azure 파일 공유에서 요청된 정보만 회수합니다.

> [!NOTE]
> 크기는 파일의 논리적 크기를 나타냅니다. 디스크의 크기는 디스크에 저장된 파일 스트림의 물리적 크기를 나타냅니다.

## <a name="next-steps"></a>다음 단계

- [Azure 파일 동기화 클라우드 계층화 정책 선택](file-sync-choose-cloud-tiering-policies.md)
- [Azure 파일 동기화 배포에 대한 계획](file-sync-planning.md)
